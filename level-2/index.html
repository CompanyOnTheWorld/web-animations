<!doctype html>
<html lang="en">
 <head>
  
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  
  
  <title>Web Animations Level 2</title>
  
  
  <link href="../default.css" rel="stylesheet" type="text/css">
  
  
  <link href="../csslogo.ico" rel="shortcut icon" type="image/x-icon">
  
  
  <link href="https://www.w3.org/StyleSheets/TR/W3C-UD" rel="stylesheet" type="text/css">
  

  <meta content="1.0.0" name="bikeshed-semver">
  <link href="http://dev.w3.org/fxtf/default.css" rel="stylesheet" test="text/css">
  

  <link href="web-animations.css" rel="stylesheet" type="text/css">
  

  <script src="MathJax/MathJax.js?config=MML_SVGorMML,local/local" type="text/javascript"></script>
  


  <script>self = (typeof window !== 'undefined')
	? window   // if in browser
	: (
		(typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)
		? self // if in worker
		: {}   // if in node js
	);

/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 * MIT license http://www.opensource.org/licenses/mit-license.php/
 * @author Lea Verou http://lea.verou.me
 */

var Prism = (function(){

// Private helper vars
var lang = /\blang(?:uage)?-(?!\*)(\w+)\b/i;

var _ = self.Prism = {
	util: {
		encode: function (tokens) {
			if (tokens instanceof Token) {
				return new Token(tokens.type, _.util.encode(tokens.content), tokens.alias);
			} else if (_.util.type(tokens) === 'Array') {
				return tokens.map(_.util.encode);
			} else {
				return tokens.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\u00a0/g, ' ');
			}
		},

		type: function (o) {
			return Object.prototype.toString.call(o).match(/\[object (\w+)\]/)[1];
		},

		// Deep clone a language definition (e.g. to extend it)
		clone: function (o) {
			var type = _.util.type(o);

			switch (type) {
				case 'Object':
					var clone = {};

					for (var key in o) {
						if (o.hasOwnProperty(key)) {
							clone[key] = _.util.clone(o[key]);
						}
					}

					return clone;

				case 'Array':
					return o.slice();
			}

			return o;
		}
	},

	languages: {
		extend: function (id, redef) {
			var lang = _.util.clone(_.languages[id]);

			for (var key in redef) {
				lang[key] = redef[key];
			}

			return lang;
		},

		// Insert a token before another token in a language literal
		insertBefore: function (inside, before, insert, root) {
			root = root || _.languages;
			var grammar = root[inside];
			var ret = {};

			for (var token in grammar) {

				if (grammar.hasOwnProperty(token)) {

					if (token == before) {

						for (var newToken in insert) {

							if (insert.hasOwnProperty(newToken)) {
								ret[newToken] = insert[newToken];
							}
						}
					}

					ret[token] = grammar[token];
				}
			}

			return root[inside] = ret;
		},

		// Traverse a language definition with Depth First Search
		DFS: function(o, callback, type) {
			for (var i in o) {
				if (o.hasOwnProperty(i)) {
					callback.call(o, i, o[i], type || i);

					if (_.util.type(o[i]) === 'Object') {
						_.languages.DFS(o[i], callback);
					} else if (_.util.type(o[i]) === 'Array') {
						_.languages.DFS(o[i], callback, i);
					}
				}
			}
		}
	},

	highlightAll: function(async, callback) {
		var elements = document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code');
		for (var i=0, element; element = elements[i++];) {
			if (element.classList.contains("idl")) {
				// Bikeshed handles IDL blocks already.
				continue;
			}
			_.highlightElement(element, async === true, callback);
		}

		var elements = document.querySelectorAll('pre[class*="language-"], [class*="language-"] pre, pre[class*="lang-"], [class*="lang-"] pre');
		for (var i=0, element; element = elements[i++];) {
			if (element.firstElementChild && element.firstElementChild.tagName.toLowerCase() == "code") {
				// Already handled by the previous loop
				continue;
			}
			if (element.classList.contains("idl")) {
				// Bikeshed handles IDL blocks already.
				continue;
			}
			_.highlightElement(element, async === true, callback);
		}
	},

	highlightElement: function(element, async, callback) {
		// Find language
		var language, grammar, parent = element;

		while (parent && !lang.test(parent.className)) {
			parent = parent.parentNode;
		}

		if (parent) {
			language = (parent.className.match(lang) || [,''])[1];
			grammar = _.languages[language];
		}

		if (!grammar) {
			return;
		}

		// Set language on the element, if not present
		element.className = element.className.replace(lang, '').replace(/\s+/g, ' ') + ' language-' + language;

		// Set language on the parent, for styling
		parent = element.parentNode;

		if (/pre/i.test(parent.nodeName)) {
			parent.className = parent.className.replace(lang, '').replace(/\s+/g, ' ') + ' language-' + language;
		}

		var code = element.textContent;

		if(!code) {
			return;
		}

		var env = {
			element: element,
			language: language,
			grammar: grammar,
			code: code
		};

		_.hooks.run('before-highlight', env);

		if (async && self.Worker) {
			var worker = new Worker(_.filename);

			worker.onmessage = function(evt) {
				env.highlightedCode = Token.stringify(JSON.parse(evt.data), language);

				_.hooks.run('before-insert', env);

				env.element.innerHTML = env.highlightedCode;

				callback && callback.call(env.element);
				_.hooks.run('after-highlight', env);
			};

			worker.postMessage(JSON.stringify({
				language: env.language,
				code: env.code
			}));
		}
		else {
			env.highlightedCode = _.highlight(env.code, env.grammar, env.language)

			_.hooks.run('before-insert', env);

			env.element.innerHTML = env.highlightedCode;

			callback && callback.call(element);

			_.hooks.run('after-highlight', env);
		}
	},

	highlight: function (text, grammar, language) {
		var tokens = _.tokenize(text, grammar);
		return Token.stringify(_.util.encode(tokens), language);
	},

	tokenize: function(text, grammar, language) {
		var Token = _.Token;

		var strarr = [text];

		var rest = grammar.rest;

		if (rest) {
			for (var token in rest) {
				grammar[token] = rest[token];
			}

			delete grammar.rest;
		}

		tokenloop: for (var token in grammar) {
			if(!grammar.hasOwnProperty(token) || !grammar[token]) {
				continue;
			}

			var patterns = grammar[token];
			patterns = (_.util.type(patterns) === "Array") ? patterns : [patterns];

			for (var j = 0; j < patterns.length; ++j) {
				var pattern = patterns[j],
					inside = pattern.inside,
					lookbehind = !!pattern.lookbehind,
					lookbehindLength = 0,
					alias = pattern.alias;

				pattern = pattern.pattern || pattern;

				for (var i=0; i<strarr.length; i++) { // Don’t cache length as it changes during the loop

					var str = strarr[i];

					if (strarr.length > text.length) {
						// Something went terribly wrong, ABORT, ABORT!
						break tokenloop;
					}

					if (str instanceof Token) {
						continue;
					}

					pattern.lastIndex = 0;

					var match = pattern.exec(str);

					if (match) {
						if(lookbehind) {
							lookbehindLength = match[1].length;
						}

						var from = match.index - 1 + lookbehindLength,
							match = match[0].slice(lookbehindLength),
							len = match.length,
							to = from + len,
							before = str.slice(0, from + 1),
							after = str.slice(to + 1);

						var args = [i, 1];

						if (before) {
							args.push(before);
						}

						var wrapped = new Token(token, inside? _.tokenize(match, inside) : match, alias);

						args.push(wrapped);

						if (after) {
							args.push(after);
						}

						Array.prototype.splice.apply(strarr, args);
					}
				}
			}
		}

		return strarr;
	},

	hooks: {
		all: {},

		add: function (name, callback) {
			var hooks = _.hooks.all;

			hooks[name] = hooks[name] || [];

			hooks[name].push(callback);
		},

		run: function (name, env) {
			var callbacks = _.hooks.all[name];

			if (!callbacks || !callbacks.length) {
				return;
			}

			for (var i=0, callback; callback = callbacks[i++];) {
				callback(env);
			}
		}
	}
};

var Token = _.Token = function(type, content, alias) {
	this.type = type;
	this.content = content;
	this.alias = alias;
};

Token.stringify = function(o, language, parent) {
	if (typeof o == 'string') {
		return o;
	}

	if (Object.prototype.toString.call(o) == '[object Array]') {
		return o.map(function(element) {
			return Token.stringify(element, language, o);
		}).join('');
	}

	var env = {
		type: o.type,
		content: Token.stringify(o.content, language, parent),
		tag: 'span',
		classes: ['token', o.type],
		attributes: {},
		language: language,
		parent: parent
	};

	if (env.type == 'comment') {
		env.attributes['spellcheck'] = 'true';
	}

	if (o.alias) {
		var aliases = _.util.type(o.alias) === 'Array' ? o.alias : [o.alias];
		Array.prototype.push.apply(env.classes, aliases);
	}

	_.hooks.run('wrap', env);

	var attributes = '';

	for (var name in env.attributes) {
		attributes += name + '="' + (env.attributes[name] || '') + '"';
	}

	return '<' + env.tag + ' class="' + env.classes.join(' ') + '" ' + attributes + '>' + env.content + '</' + env.tag + '>';

};

if (!self.document) {
	if (!self.addEventListener) {
		// in Node.js
		return self.Prism;
	}
 	// In worker
	self.addEventListener('message', function(evt) {
		var message = JSON.parse(evt.data),
		    lang = message.language,
		    code = message.code;

		self.postMessage(JSON.stringify(_.util.encode(_.tokenize(code, _.languages[lang]))));
		self.close();
	}, false);

	return self.Prism;
}

// Get current script and highlight
var script = document.getElementsByTagName('script');

script = script[script.length - 1];

if (script) {
	_.filename = script.src;

	if (document.addEventListener && !script.hasAttribute('data-manual')) {
		document.addEventListener('DOMContentLoaded', _.highlightAll);
	}
}

return self.Prism;

})();

if (typeof module !== 'undefined' && module.exports) {
	module.exports = Prism;
}
;
Prism.languages.clike = {
	'comment': [
		{
			pattern: /(^|[^\\])\/\*[\w\W]*?\*\//g,
			lookbehind: true
		},
		{
			pattern: /(^|[^\\:])\/\/.*?(\r?\n|$)/g,
			lookbehind: true
		}
	],
	'string': /("|')(\\?.)*?\1/g,
	'class-name': {
		pattern: /((?:(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/ig,
		lookbehind: true,
		inside: {
			punctuation: /(\.|\\)/
		}
	},
	'keyword': /\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/g,
	'boolean': /\b(true|false)\b/g,
	'function': {
		pattern: /[a-z0-9_]+\(/ig,
		inside: {
			punctuation: /\(/
		}
	},
	'number': /\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?)\b/g,
	'operator': /[-+]{1,2}|!|<=?|>=?|={1,3}|&{1,2}|\|?\||\?|\*|\/|\~|\^|\%/g,
	'ignore': /&(lt|gt|amp);/gi,
	'punctuation': /[{}[\];(),.:]/g
};
;
Prism.languages.javascript = Prism.languages.extend('clike', {
	'keyword': /\b(break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|false|finally|for|function|get|if|implements|import|in|instanceof|interface|let|new|null|package|private|protected|public|return|set|static|super|switch|this|throw|true|try|typeof|var|void|while|with|yield)\b/g,
	'number': /\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?|NaN|-?Infinity)\b/g
});

Prism.languages.insertBefore('javascript', 'keyword', {
	'regex': {
		pattern: /(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,
		lookbehind: true
	}
});

if (Prism.languages.markup) {
	Prism.languages.insertBefore('markup', 'tag', {
		'script': {
			pattern: /<script[\w\W]*?>[\w\W]*?<\/script>/ig,
			inside: {
				'tag': {
					pattern: /<script[\w\W]*?>|<\/script>/ig,
					inside: Prism.languages.markup.tag.inside
				},
				rest: Prism.languages.javascript
			}
		}
	});
}
;
</script>
  <style>/* http://prismjs.com/download.html?themes=prism&languages=clike */
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', monospace;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #a67f59;
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important {
	font-weight: bold;
}

.token.entity {
	cursor: help;
}
</style>
 </head>
 

 <body class="h-entry">

  <div class="head">
  
   <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72">
</a>
</p>
  
   <h1 class="p-name no-ref" id="title">Web Animations Level 2</h1>
  
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Unofficial Proposal Draft,
    <time class="dt-updated" datetime="2015-02-02">2 February 2015</time></span></h2>
  
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="http://w3c.github.io/web-animations/level-2/">http://w3c.github.io/web-animations/level-2/</a>
     <dt>Latest version:
     <dd><a href="http://www.w3.org/TR/web-animations/">http://www.w3.org/TR/web-animations/</a>
     <dt>Version History:
     <dd><a href="https://github.com/w3c/web-animations/commits/master">https://github.com/w3c/web-animations/commits/master</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-fx@w3.org?subject=%5Bweb-animations%5D%20feedback">public-fx@w3.org</a> with subject line “<kbd>[web-animations] <var>… message topic …</var></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-fx/" rel="discussion">archives</a>)</span>
     <dt>Issue Tracking:
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editors:
     <dd class="editor">
      <div class="p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:bbirtles@mozilla.com">Brian Birtles</a> (<span class="p-org org">Mozilla Japan</span>)</div>
     <dd class="editor">
      <div class="p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:shans@google.com">Shane Stephens</a> (<span class="p-org org">Google Inc</span>)</div>
     <dd class="editor">
      <div class="p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:adanilo@google.com">Alex Danilo</a> (<span class="p-org org">Google Inc</span>)</div>
     <dd class="editor">
      <div class="p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:jackalmage@gmail.com">Tab Atkins</a> (<span class="p-org org">Google Inc</span>)</div>
    </dl>
   </div>
  
   <div data-fill-with="warning">
    <details class="annoying-warning" open="">
	
     <summary>Not Ready For Implementation</summary>
     
	
     <p>
		This spec is not yet ready for implementation.
		It exists in this repository to record the ideas and promote discussion.

	</p>
     <p>
		Before attempting to implement this spec,
		please contact the editors.
</p>
    </details>
    

   </div>
  
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2015 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved. W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.
</p>
  
   <hr title="Separator for header">
</div>


  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>

  <div class="p-summary" data-fill-with="abstract">
   <p>This specification defines a model for synchronization and

timing of changes to the presentation of a Web page.
This specification also defines an application programming interface
for interacting with this model and it is expected that further
specifications will define declarative means for exposing these
features.</p>

</div>


  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>

  <div data-fill-with="status"></div>

  <div data-fill-with="at-risk"></div>


  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>

  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ul class="toc">
      <li><a href="#use-cases"><span class="secno">1.1</span> <span class="content">Use cases</span></a>
      <li><a href="#changes-since-level-1"><span class="secno">1.2</span> <span class="content">Changes since level 1</span></a>
      <li><a href="#relationship-to-other-specifications"><span class="secno">1.3</span> <span class="content">Relationship to other specifications</span></a>
      <li><a href="#overview-of this-specification"><span class="secno">1.4</span> <span class="content">Overview of this specification</span></a>
     </ul>
    <li><a href="#web-animations-model-overview"><span class="secno">2</span> <span class="content">Web Animations model overview</span></a>
    <li><a href="#timing-model"><span class="secno">3</span> <span class="content">Timing model</span></a>
     <ul class="toc">
      <li><a href="#the-timing-model-at-a-glance"><span class="secno">3.1</span> <span class="content">The timing model at a glance</span></a>
       <ul class="toc">
        <li><a href="#stateless"><span class="secno">3.1.1</span> <span class="content">Stateless</span></a>
        <li><a href="#hierarchical"><span class="secno">3.1.2</span> <span class="content">Hierarchical</span></a>
       </ul>
      <li><a href="#timing-model-concepts"><span class="secno">3.2</span> <span class="content">Timing model concepts</span></a>
      <li><a href="#the-global-clock"><span class="secno">3.3</span> <span class="content">The global clock</span></a>
      <li><a href="#timelines"><span class="secno">3.4</span> <span class="content">Timelines</span></a>
       <ul class="toc">
        <li><a href="#the-document-timeline"><span class="secno">3.4.1</span> <span class="content">The document timeline</span></a>
       </ul>
      <li><a href="#players"><span class="secno">3.5</span> <span class="content">Players</span></a>
       <ul class="toc">
        <li><a href="#setting-the-timeline"><span class="secno">3.5.1</span> <span class="content">Setting the timeline of a player</span></a>
        <li><a href="#setting-the-source-content"><span class="secno">3.5.2</span> <span class="content">Setting the source content of a
  player</span></a>
        <li><a href="#the-current-time-of-a-player"><span class="secno">3.5.3</span> <span class="content">The current time of a player</span></a>
        <li><a href="#setting-the-current-time-of-a-player"><span class="secno">3.5.4</span> <span class="content">Setting the current time of a player</span></a>
        <li><a href="#setting-the-start-time-of-a-player"><span class="secno">3.5.5</span> <span class="content">Setting the start time of a player</span></a>
        <li><a href="#waiting-for-source-content"><span class="secno">3.5.6</span> <span class="content">Waiting for source content</span></a>
        <li><a href="#promise-objects"><span class="secno">3.5.7</span> <span class="content">Promise objects</span></a>
        <li><a href="#the-current-ready-promise"><span class="secno">3.5.8</span> <span class="content">The current ready promise</span></a>
        <li><a href="#playing-a-player-section"><span class="secno">3.5.9</span> <span class="content">Playing a player</span></a>
        <li><a href="#pausing-a-player-section"><span class="secno">3.5.10</span> <span class="content">Pausing a player</span></a>
        <li><a href="#reaching-the-end"><span class="secno">3.5.11</span> <span class="content">Reaching the end</span></a>
        <li><a href="#the-current-finished-promise"><span class="secno">3.5.12</span> <span class="content">The current finished promise</span></a>
        <li><a href="#updating-the-finished-state"><span class="secno">3.5.13</span> <span class="content">Updating the finished state</span></a>
        <li><a href="#finishing-a-player-section"><span class="secno">3.5.14</span> <span class="content">Finishing a player</span></a>
        <li><a href="#cancelling-a-player-section"><span class="secno">3.5.15</span> <span class="content">Cancelling a player</span></a>
        <li><a href="#speed-control"><span class="secno">3.5.16</span> <span class="content">Speed control</span></a>
         <ul class="toc">
          <li><a href="#updating-the-playback-rate-of-a-player"><span class="secno">3.5.16.1</span> <span class="content">
Updating the playback rate of a player</span></a>
         </ul>
        <li><a href="#reversing-a-player-section"><span class="secno">3.5.17</span> <span class="content">Reversing a player</span></a>
        <li><a href="#player-state"><span class="secno">3.5.18</span> <span class="content">Player state</span></a>
       </ul>
      <li><a href="#animation-nodes"><span class="secno">3.6</span> <span class="content">Animation nodes</span></a>
       <ul class="toc">
        <li><a href="#animation-nodes-and-players"><span class="secno">3.6.1</span> <span class="content">Relationship between animation nodes and players</span></a>
        <li><a href="#types-of-animation-nodes"><span class="secno">3.6.2</span> <span class="content">Types of animation nodes</span></a>
        <li><a href="#the-active-interval"><span class="secno">3.6.3</span> <span class="content">The active interval</span></a>
        <li><a href="#local-time-and-inherited-time"><span class="secno">3.6.4</span> <span class="content">Local time and inherited time</span></a>
        <li><a href="#animation-node-phases-and-states"><span class="secno">3.6.5</span> <span class="content">Animation node phases and states</span></a>
       </ul>
      <li><a href="#fill-behavior"><span class="secno">3.7</span> <span class="content">Fill behavior</span></a>
       <ul class="toc">
        <li><a href="#fill-modes"><span class="secno">3.7.1</span> <span class="content">Fill modes</span></a>
       </ul>
      <li><a href="#repeating"><span class="secno">3.8</span> <span class="content">Repeating</span></a>
       <ul class="toc">
        <li><a href="#iteration-intervals"><span class="secno">3.8.1</span> <span class="content">Iteration intervals</span></a>
        <li><a href="#controlling-iteration"><span class="secno">3.8.2</span> <span class="content">Controlling iteration</span></a>
        <li><a href="#iteration-time-space"><span class="secno">3.8.3</span> <span class="content">Iteration time space</span></a>
        <li><a href="#interval-timing"><span class="secno">3.8.4</span> <span class="content">Interval timing</span></a>
       </ul>
      <li><a href="#animation-node-speed-control"><span class="secno">3.9</span> <span class="content">Animation node speed control</span></a>
      <li><a href="#core-animation-node-calculations"><span class="secno">3.10</span> <span class="content">Core animation node calculations</span></a>
       <ul class="toc">
        <li><a href="#overview"><span class="secno">3.10.1</span> <span class="content">Overview</span></a>
        <li><a href="#calculating-the-active-duration"><span class="secno">3.10.2</span> <span class="content">Calculating the active duration</span></a>
        <li><a href="#transforming-the-local-time"><span class="secno">3.10.3</span> <span class="content">Transforming the local time</span></a>
         <ul class="toc">
          <li><a href="#calculating-the-active-time"><span class="secno">3.10.3.1</span> <span class="content">Calculating the active time</span></a>
          <li><a href="#calculating-the-scaled-active-time"><span class="secno">3.10.3.2</span> <span class="content">Calculating the scaled active time</span></a>
          <li><a href="#calculating-the-iteration-time"><span class="secno">3.10.3.3</span> <span class="content">Calculating the iteration time</span></a>
         </ul>
        <li><a href="#calculating-the-current-iteration"><span class="secno">3.10.4</span> <span class="content">Calculating the current iteration</span></a>
       </ul>
      <li><a href="#direction-control"><span class="secno">3.11</span> <span class="content">Direction control</span></a>
       <ul class="toc">
        <li><a href="#calculating-the-directed-time"><span class="secno">3.11.1</span> <span class="content">Calculating the directed time</span></a>
       </ul>
      <li><a href="#time-transformations"><span class="secno">3.12</span> <span class="content">Time transformations</span></a>
       <ul class="toc">
        <li><a href="#scaling-the-time"><span class="secno">3.12.1</span> <span class="content">Scaling the time</span></a>
        <li><a href="#timing-functions"><span class="secno">3.12.2</span> <span class="content">Timing functions</span></a>
        <li><a href="#scaling-using-a-cubic-bezier-curve"><span class="secno">3.12.3</span> <span class="content">Scaling using a cubic Bézier curve</span></a>
        <li><a href="#timing-in-discrete-steps"><span class="secno">3.12.4</span> <span class="content">Timing in discrete steps</span></a>
        <li><a href="#calculating-the-transformed-time"><span class="secno">3.12.5</span> <span class="content">Calculating the transformed time</span></a>
       </ul>
      <li><a href="#grouping-and-synchronization"><span class="secno">3.13</span> <span class="content">Grouping and synchronization</span></a>
       <ul class="toc">
        <li><a href="#relationship-of-group-time-to-child-time"><span class="secno">3.13.1</span> <span class="content">Relationship of group time to child time</span></a>
        <li><a href="#the-start-time-of-children-of-an-animation-group"><span class="secno">3.13.2</span> <span class="content">The start time of children of an animation group</span></a>
        <li><a href="#the-intrinsic-iteration-duration-of-an-animation-group"><span class="secno">3.13.3</span> <span class="content">The intrinsic iteration duration of an animation group</span></a>
        <li><a href="#animation-sequences"><span class="secno">3.13.4</span> <span class="content">Animation sequences</span></a>
         <ul class="toc">
          <li><a href="#the-start-time-of-children-of-an-animation-sequence"><span class="secno">3.13.4.1</span> <span class="content">The start time of children of an animation sequence</span></a>
          <li><a href="#the-intrinsic-iteration-duration-of-an-animation-sequence"><span class="secno">3.13.4.2</span> <span class="content">The intrinsic iteration duration of an animation sequence</span></a>
         </ul>
       </ul>
      <li><a href="#animations"><span class="secno">3.14</span> <span class="content">Animations</span></a>
       <ul class="toc">
        <li><a href="#calculating-the-time-fraction"><span class="secno">3.14.1</span> <span class="content">Calculating the time fraction</span></a>
       </ul>
     </ul>
    <li><a href="#animation-model"><span class="secno">4</span> <span class="content">Animation Model</span></a>
     <ul class="toc">
      <li><a href="#animation-effects"><span class="secno">4.1</span> <span class="content">Animation effects</span></a>
       <ul class="toc">
        <li><a href="#target-properties"><span class="secno">4.1.1</span> <span class="content">Target properties</span></a>
        <li><a href="#procedures-for-animating-properties"><span class="secno">4.1.2</span> <span class="content">Procedures for animating properties</span></a>
        <li><a href="#specific-animation-behaviors"><span class="secno">4.1.3</span> <span class="content">Specific animation behaviors</span></a>
         <ul class="toc">
          <li><a href="#not-animatable-section"><span class="secno">4.1.3.1</span> <span class="content">Not animatable</span></a>
          <li><a href="#animatable-as-string-section"><span class="secno">4.1.3.2</span> <span class="content">Animatable as string</span></a>
          <li><a href="#animatable-as-real-number-section"><span class="secno">4.1.3.3</span> <span class="content">Animatable as real number</span></a>
          <li><a href="#animatable-as-length-percentage-or-calc-section"><span class="secno">4.1.3.4</span> <span class="content">Animatable as length, percentage, or calc</span></a>
          <li><a href="#animatable-as-color-section"><span class="secno">4.1.3.5</span> <span class="content">Animatable as color</span></a>
          <li><a href="#animatable-as-transform-list-section"><span class="secno">4.1.3.6</span> <span class="content">Animatable as transform list</span></a>
          <li><a href="#other-animation-behaviors"><span class="secno">4.1.3.7</span> <span class="content">Other animation behaviors</span></a>
         </ul>
        <li><a href="#intermediate-animation-values"><span class="secno">4.1.4</span> <span class="content">Intermediate animation values</span></a>
       </ul>
      <li><a href="#combining-animations"><span class="secno">4.2</span> <span class="content">Combining animations</span></a>
       <ul class="toc">
        <li><a href="#the-animation-stack"><span class="secno">4.2.1</span> <span class="content">The animation stack</span></a>
         <ul class="toc">
          <li><a href="#the-custom-player-priority"><span class="secno">4.2.1.1</span> <span class="content">The custom player priority</span></a>
         </ul>
        <li><a href="#calculating-the-result-of-an-animation-stack"><span class="secno">4.2.2</span> <span class="content">Calculating the result of an animation stack</span></a>
        <li><a href="#animation-composition"><span class="secno">4.2.3</span> <span class="content">Animation composition</span></a>
        <li><a href="#applying-the-composited-result"><span class="secno">4.2.4</span> <span class="content">Applying the composited result</span></a>
         <ul class="toc">
          <li><a href="#applying-the-result-to-a-css-property"><span class="secno">4.2.4.1</span> <span class="content">Applying the result to a CSS property</span></a>
          <li><a href="#applying-the-composited-result-to-a-dom-attribute"><span class="secno">4.2.4.2</span> <span class="content">Applying the composited result to a DOM attribute</span></a>
         </ul>
        <li><a href="#animation-accumulation-section"><span class="secno">4.2.5</span> <span class="content">Animation accumulation</span></a>
       </ul>
      <li><a href="#keyframe-animation-effects"><span class="secno">4.3</span> <span class="content">Keyframe animation effects</span></a>
       <ul class="toc">
        <li><a href="#spacing-keyframes"><span class="secno">4.3.1</span> <span class="content">Spacing keyframes</span></a>
         <ul class="toc">
          <li><a href="#applying-spacing-to-keyframes"><span class="secno">4.3.1.1</span> <span class="content">Applying spacing to keyframes</span></a>
         </ul>
        <li><a href="#the-intermediate-animation-value-of-a-keyframe-animation-effect"><span class="secno">4.3.2</span> <span class="content">The intermediate animation value of a keyframe animation effect</span></a>
       </ul>
      <li><a href="#custom-effects"><span class="secno">4.4</span> <span class="content">Custom effects</span></a>
       <ul class="toc">
        <li><a href="#sampling-custom-effects"><span class="secno">4.4.1</span> <span class="content">Sampling custom effects</span></a>
        <li><a href="#execution-order-of-custom-effects"><span class="secno">4.4.2</span> <span class="content">Execution order of custom effects</span></a>
       </ul>
     </ul>
    <li><a href="#programming-interface"><span class="secno">5</span> <span class="content">Programming interface</span></a>
     <ul class="toc">
      <li><a href="#time-values-in-the-programming-interface"><span class="secno">5.1</span> <span class="content">
Time values in the programming interface</span></a>
      <li><a href="#the-animationtimeline-interface"><span class="secno">5.2</span> <span class="content">The <code>AnimationTimeline</code> interface</span></a>
      <li><a href="#the-animationplayer-interface"><span class="secno">5.3</span> <span class="content">The <code>AnimationPlayer</code> interface</span></a>
       <ul class="toc">
        <li><a href="#the-animationplaystate-enumeration"><span class="secno">5.3.1</span> <span class="content">The <code>AnimationPlayState</code> enumeration</span></a>
       </ul>
      <li><a href="#the-animationnode-interface"><span class="secno">5.4</span> <span class="content">The <code>AnimationNodeReadonly</code> interface</span></a>
      <li><a href="#the-animationtimingreadonly-interface"><span class="secno">5.5</span> <span class="content">The <code>AnimationTimingReadonly</code> interface</span></a>
      <li><a href="#the-animationtiming-interface"><span class="secno">5.6</span> <span class="content">The <code>AnimationTiming</code> interface</span></a>
      <li><a href="#the-animationtiminginput-dictionary"><span class="secno">5.7</span> <span class="content">The <code>AnimationTimingProperties</code> dictionary</span></a>
      <li><a href="#the-computedanimationtiming-interface"><span class="secno">5.8</span> <span class="content">The
  <code>ComputedTimingProperties</code> dictionary</span></a>
       <ul class="toc">
        <li><a href="#the-fillmode-enumeration"><span class="secno">5.8.1</span> <span class="content">The <code>FillMode</code> enumeration</span></a>
        <li><a href="#the-playbackdirection-enumeration"><span class="secno">5.8.2</span> <span class="content">The <code>PlaybackDirection</code> enumeration</span></a>
       </ul>
      <li><a href="#the-animationgroup-interfaces"><span class="secno">5.9</span> <span class="content">The <code>AnimationGroupReadonly</code>
  and <code>AnimationGroup</code> interfaces</span></a>
       <ul class="toc">
        <li><a href="#processing-a-timing-argument"><span class="secno">5.9.1</span> <span class="content">Processing a <var>timing</var> argument</span></a>
        <li><a href="#definitions-for-manipulating-hierarchies"><span class="secno">5.9.2</span> <span class="content">Definitions for manipulating hierarchies</span></a>
       </ul>
      <li><a href="#the-animationnodelist-interface"><span class="secno">5.10</span> <span class="content">The <code>AnimationNodeList</code> interface</span></a>
      <li><a href="#the-animationsequence-interfaces"><span class="secno">5.11</span> <span class="content">The
<code>AnimationSequenceReadonly</code> and <code>AnimationSequence</code>
interfaces</span></a>
      <li><a href="#the-animation-interfaces"><span class="secno">5.12</span> <span class="content">The <code>AnimationReadonly</code> and
<code>Animation</code> interfaces</span></a>
       <ul class="toc">
        <li><a href="#processing-the-effect-parameter"><span class="secno">5.12.1</span> <span class="content">Processing the <var>effect</var> parameter</span></a>
        <li><a href="#creating-a-new-animation-object"><span class="secno">5.12.2</span> <span class="content">Creating a new <code>Animation</code> object</span></a>
       </ul>
      <li><a href="#the-animatable-interface"><span class="secno">5.13</span> <span class="content">The <code>Animatable</code> interface</span></a>
      <li><a href="#the-animationeffectreadonly-interface"><span class="secno">5.14</span> <span class="content">The <code>AnimationEffectReadonly</code> interface</span></a>
      <li><a href="#the-iterationcompositeoperation-enumeration"><span class="secno">5.15</span> <span class="content">The <code>IterationCompositeOperation</code> enumeration</span></a>
      <li><a href="#the-compositeoperation-enumeration"><span class="secno">5.16</span> <span class="content">The <code>CompositeOperation</code> enumeration</span></a>
      <li><a href="#the-keyframeeffect-interfaces"><span class="secno">5.17</span> <span class="content">The <code>KeyframeEffectReadonly</code>
  and <code>KeyframeEffect</code> interfaces</span></a>
       <ul class="toc">
        <li><a href="#processing-a-sequence-of-keyframe-objects-or-a-single-item"><span class="secno">5.17.1</span> <span class="content">Processing a sequence of <code>Keyframe</code> objects or a single item</span></a>
        <li><a href="#the-keyframeeffectoptions-dictionary"><span class="secno">5.17.2</span> <span class="content">The <code>KeyframeEffectOptions</code> dictionary</span></a>
        <li><a href="#normalizing-a-sequence-of-keyframes"><span class="secno">5.17.3</span> <span class="content">Normalizing a sequence of keyframes</span></a>
       </ul>
      <li><a href="#the-keyframe-dictionary"><span class="secno">5.18</span> <span class="content">The <code>Keyframe</code> dictionary</span></a>
       <ul class="toc">
        <li><a href="#processing-a-keyframe-object"><span class="secno">5.18.1</span> <span class="content">Processing a <code>Keyframe</code> object</span></a>
       </ul>
      <li><a href="#the-computedkeyframe-dictionary"><span class="secno">5.19</span> <span class="content">The <code>ComputedKeyframe</code> dictionary</span></a>
      <li><a href="#the-effectcallback-callback-function"><span class="secno">5.20</span> <span class="content">The <code>EffectCallback</code> callback function</span></a>
      <li><a href="#extensions-to-the-document-interface"><span class="secno">5.21</span> <span class="content">Extensions to the <code>Document</code> interface</span></a>
      <li><a href="#extensions-to-the-element-interface"><span class="secno">5.22</span> <span class="content">Extensions to the <code>Element</code> interface</span></a>
      <li><a href="#extensions-to-the-pseudoelement-interface"><span class="secno">5.23</span> <span class="content">Extensions to the <code>PseudoElement</code> interface</span></a>
      <li><a href="#script-execution-and-live-updates-to-the-model"><span class="secno">5.24</span> <span class="content">Script execution and live updates to the model</span></a>
     </ul>
    <li><a href="#integration-with-media-fragments"><span class="secno">6</span> <span class="content">Integration with Media Fragments</span></a>
    <li><a href="#interaction-with-page-display"><span class="secno">7</span> <span class="content">Interaction with page display</span></a>
    <li><a href="#implementation-requirements"><span class="secno">8</span> <span class="content">Implementation requirements</span></a>
     <ul class="toc">
      <li><a href="#precision-of-time-values"><span class="secno">8.1</span> <span class="content">Precision of time values</span></a>
      <li><a href="#conformance-criteria"><span class="secno">8.2</span> <span class="content">Conformance criteria</span></a>
     </ul>
    <li><a href="#interface-summary"><span class="secno">9</span> <span class="content">Interface summary</span></a>
    <li><a href="#acknowledgements"><span class="secno">10</span> <span class="content">Acknowledgements</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content">
Conformance</span></a>
     <ul class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">
Document conventions</span></a>
     </ul>
    <li><a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ul>
    <li><a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ul></div>

  <main>




   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>

   <div class="informative-bg"><em>This section is non-normative</em>


    <p>Web Animations defines a model for supporting animation and
synchronization on the Web platform.
It is intended that other specifications will build on this model and
expose its features through declarative means.
In addition, this specification also defines a programming interface to
the model that may be implemented by user agents that provide support
for scripting.</p>


    <h3 class="heading settled" data-level="1.1" id="use-cases"><span class="secno">1.1. </span><span class="content">Use cases</span><a class="self-link" href="#use-cases"></a></h3>


    <p>The Web Animations model aims at two broad areas of application:</p>


    <dl>
     <dt data-md="">
      <p>User interface effects</p>
      

     <dd data-md="">
      <p>Animation can be used to give visual clues and feedback to make
a user interface more readily comprehensible.</p>
      


      <p>For example, a user action results in a table row being
removed to represent an item being removed from a shopping cart.cd -
In such a case, fading the row to transparent and then shifting
the subsequent rows up to fill the space over a few hundred
milliseconds provides the user with clear feedback as to the
results of their action as opposed to instantly removing the row
from the DOM.</p>
      


      <p>To support this scenario not only are the animated effects of
fading and shifting required, but so is synchronization, both
between the animations, and between animations and scripted
actions (removing the table row from the DOM after the animations
have completed).</p>
      


     <dt data-md="">
      <p>Storytelling and visualization</p>
      

     <dd data-md="">
      <p>Another type of animation uses the animated effect to convey
a story or represent some information.
Unlike user interface effects which are largely a presentational
adjunct to the content, these animations form an essential part of
the content presented to the user.</p>
      


      <p>For example, in an animated cartoon two cats fly through space
to another planet leaving a rainbow trail behind them.
After arriving at the planet a change of scene occurs and the user
should decide whether or not the cats enter a magic mountain by
selecting one of two preset destinations in the scene.</p>
      


      <p>This scenario requires the following features:</p>
      


      <ul>
       <li data-md="">
        <p>animated effects for moving characters along a path as well as
warping a path (the rainbow trail),</p>
        

       <li data-md="">
        <p>synchronization that allows some actions to happen
simultaneously (the two cats moving) and others in sequence
(the change of scene),</p>
        

       <li data-md="">
        <p>play control to allow rewinding the cartoon, or changing its
playback rate to accommodate particular learning or
accessibility needs,</p>
        

       <li data-md="">
        <p>the ability to trigger animations in response to user input</p>
        
</ul>
      

      <p>Similar use cases in this category include visualising physical
phenomena such as spring motion for educational purposes,
or visualising data such as the prevalence of a disease over
a geographical space over a year whereby animation is used to
present the time-based component of the data.</p>
      
</dl>

    <h3 class="heading settled" data-level="1.2" id="changes-since-level-1"><span class="secno">1.2. </span><span class="content">Changes since level 1</span><a class="self-link" href="#changes-since-level-1"></a></h3>


    <p>This specification introduces the following changes since compard to the
previous leve of this specification:</p>


    <ul>
     <li data-md="">
      <p><a data-link-type="dfn" href="#animation-group">animation groups</a> and <a data-link-type="dfn" href="#animation-sequence">animation sequences</a>,</p>
      

     <li data-md="">
      <p>an <a data-link-type="dfn" href="#animation-node">animation node</a>-specific
<a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a>.</p>
      
</ul>

    <h3 class="heading settled" data-level="1.3" id="relationship-to-other-specifications"><span class="secno">1.3. </span><span class="content">Relationship to other specifications</span><a class="self-link" href="#relationship-to-other-specifications"></a></h3>


    <p>CSS Transitions <a data-link-type="biblio" href="#biblio-css3-transitions">[CSS3-TRANSITIONS]</a>, CSS Animations <a data-link-type="biblio" href="#biblio-css3-animations">[CSS3-ANIMATIONS]</a>, and
SVG <a data-link-type="biblio" href="#biblio-svg11">[SVG11]</a> all provide mechanisms that
generate animated content on a Web page.
Although the three specifications provide many similar features,
they are described in different terms.
This specification proposes an abstract animation model that
encompasses the common features of all three specifications.
This model is backwards-compatible with the current behavior of these
specifications such that they can be defined in terms of this model
without any observable change.</p>


    <p>The animation features in SVG 1.1 are defined in terms of SMIL
Animation <a data-link-type="biblio" href="#biblio-smil-animation">[SMIL-ANIMATION]</a>.
It is intended that by defining SVG’s animation features in terms of
the Web Animations model, the dependency between SVG and SMIL
Animation can be removed.</p>


    <p>As with Timing control for script-based animations (commonly referred
to as “requestAnimationFrame”) <a data-link-type="biblio" href="#biblio-animation-timing">[ANIMATION-TIMING]</a>,
the programming interface component of this specification allows
animations to be created from script.
The animations created using the interface defined in this
specification, however, once created, are executed entirely by the
user agent meaning they share the same performance characteristics as
animations defined by markup.
Using this interface it is possible to create animations
from script in a simpler and more performant manner.</p>


    <p>The time values used within the programming interface
correspond with those used in Timing control for script-based
animations <a data-link-type="biblio" href="#biblio-animation-timing">[ANIMATION-TIMING]</a> and their execution order is defined
such that the two interfaces can be used simultaneously without conflict.</p>


    <p>The programming interface component of this specification makes
some additions to interfaces defined in HTML5 <a data-link-type="biblio" href="#biblio-html5">[HTML5]</a>.</p>


    <h3 class="heading settled" data-level="1.4" id="overview-of this-specification"><span class="secno">1.4. </span><span class="content">Overview of this specification</span><a class="self-link" href="#overview-of%20this-specification"></a></h3>


    <p>This specification begins by defining an abstract model for animation.
This is followed by a programming interface defined in terms of the
abstract model.
The programming interface is defined in terms of the abstract model
and is only relevant to user agents that provide scripting support.</p>

</div>


   <h2 class="heading settled" data-level="2" id="web-animations-model-overview"><span class="secno">2. </span><span class="content">Web Animations model overview</span><a class="self-link" href="#web-animations-model-overview"></a></h2>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>At a glance, the Web Animations model consists of two largely
independent pieces, a <em>timing model</em> and an <em>animation
model</em>.  The role of these pieces is as follows:</p>


    <dl>
     <dt data-md="">
      <p>Timing model</p>
      

     <dd data-md="">
      <p>Takes a moment in time and converts it to a proportional distance
within a single iteration of an animation called the <em>time
fraction</em>.
An <em>iteration index</em> is also generated for animations
that vary as they repeat.</p>
      

     <dt data-md="">
      <p>Animation model</p>
      

     <dd data-md="">
      <p>Takes the <em>time fractions</em> and <em>iteration indices</em>
produced by the timing model and converts them into a series of values
to apply to the target properties and attributes.</p>
      
</dl>

    <p>Graphically, this flow can be represented as follows:</p>

    <div class="figure">
<img alt="Overview of the operation of the Web Animations model." src="img/timing-and-animation-models.svg" width="600">
</div>

    <p class="caption">
Overview of the operation of the Web Animations model.<br>
The current time is input to the timing model which produces a time
fraction and an iteration index.<br>
These parameters are used as input to the animation model which produces
the values to apply.<br>
</p>


    <p>For example, consider an animation that:</p>


    <ul>
     <li data-md="">
      <p>starts after 3 seconds</p>
      

     <li data-md="">
      <p>runs twice,</p>
      

     <li data-md="">
      <p>takes 2 seconds every time, and</p>
      

     <li data-md="">
      <p>changes the width of a rectangle from 50 pixels to 100 pixels.</p>
      
</ul>

    <p>The first three points apply to the timing model.
At a time of 6 seconds, it will calculate that the animation should be
half-way through its second iteration and produces the result 0.5.
The animation model then uses that information to calculate a width</p>


    <p>This specification begins with the timing model and then proceeds to
the animation model.</p>

</div>


   <h2 class="heading settled" data-level="3" id="timing-model"><span class="secno">3. </span><span class="content">Timing model</span><a class="self-link" href="#timing-model"></a></h2>


   <p>This section describes and defines the behavior of the Web Animations
timing model.</p>


   <h3 class="heading settled" data-level="3.1" id="the-timing-model-at-a-glance"><span class="secno">3.1. </span><span class="content">The timing model at a glance</span><a class="self-link" href="#the-timing-model-at-a-glance"></a></h3>


   <div class="informative-bg">


    <p><em>This section is non-normative</em></p>


    <p>Two features characterise the Web Animations timing model: it is
<em>stateless</em> and it is <em>hierarchical</em>.</p>


    <h4 class="heading settled" data-level="3.1.1" id="stateless"><span class="secno">3.1.1. </span><span class="content">Stateless</span><a class="self-link" href="#stateless"></a></h4>


    <p>The Web Animations timing model operates by taking an input time and
producing an output time fraction.
Since the output is based solely on the input time and is independent
of previous inputs, the model may be described as stateless.
This gives the model the following properties:</p>



    <dl>
     <dt data-md="">
      <p>Frame-rate independent</p>
      

     <dd data-md="">
      <p>Since the output is independent of previous inputs, the rate at
which the model is sampled will not affect its progress.
Provided the input times are proportional to the progress of
real-world time, animations will progress at an identical rate
regardless of the capabilities of the device running them.</p>
      

     <dt data-md="">
      <p>Direction-agnostic</p>
      

     <dd data-md="">
      <p>Since the sequence of inputs is insignificant, the model is
directionless.
This means that the model can be sampled in reverse or even in
a backwards and forwards pattern without requiring any specialized
handling.</p>
      

     <dt data-md="">
      <p>Constant-time seeking</p>
      

     <dd data-md="">
      <p>Since each input is independent of the previous input, the
processing required to perform a seek operation, even far into the
future, is at least potentially constant.</p>
      
</dl>

    <p>There are a few exceptions to the stateless behavior of the timing
model.</p>


    <p>Firstly, a number of methods defined in the <a href="#programming-interface">programming interface</a> to the model
provide play control such as pausing an animation.
These methods are defined in terms of the time at which they are
called and are therefore stative.
These methods are provided primarily for convenience and are not part
of the core timing model but are layered on top.</p>


    <p>Similarly, the <a href="#reaching-the-end">finishing behavior</a> of
players means that dynamic changes to the end time of
the media (source content) of a player may produce a different result
depending on when the change occurs.
This behavior is somewhat unfortunate but has been deemed intuitive
and consistent with HTML.
As a result, the model can only truly be described as stateless
<em>in the absence of dynamic changes to its timing properties</em>.</p>


    <p>Finally, each time the model is sampled, it can be considered to
establish a temporary state.
While this temporary state affects the values returned from the <a href="#programming-interface">programming interface</a>, it has no
influence on the subsequent samples and hence does not conflict with
the stateless qualities described above.</p>


    <h4 class="heading settled" data-level="3.1.2" id="hierarchical"><span class="secno">3.1.2. </span><span class="content">Hierarchical</span><a class="self-link" href="#hierarchical"></a></h4>


    <p>The other characteristic feature of the Web Animations timing model is
that time is inherited.
Time begins with a monotonically increasing time source and cascades
down a number of steps to each animation.
At each step, time may be shifted backwards and forwards, scaled,
reversed, paused, and repeated.</p>


    <div class="figure">
  <img alt="A hierarchy of timing nodes" src="img/time-hierarchy.svg" width="600">
</div>

    <p class="caption">
  A hierarchy of timing nodes.
  Each node in the tree derives its time from its parent node.
  At the root of the tree is the global clock.
</p>


    <p>A consequence of this hierarchical arrangement is that complex
animation arrangements can be reversed, scheduled, accelerated and so
on as a whole unit since the manipulations applied to the parent,
cascade down to its <a data-link-type="dfn" href="#descendant">descendants</a>.
Furthermore, since time has a common source, it is easy to synchronize
animations.</p>
</div>


   <h3 class="heading settled" data-level="3.2" id="timing-model-concepts"><span class="secno">3.2. </span><span class="content">Timing model concepts</span><a class="self-link" href="#timing-model-concepts"></a></h3>


   <p>In Web Animations, timing is based on a hierarchy of time relationships
between timing nodes.
Parent nodes provide timing information to their child nodes in the form
of <a data-link-type="dfn" href="#time-value">time values</a>.
A <dfn data-dfn-type="dfn" data-noexport="" id="time-value">time value<a class="self-link" href="#time-value"></a></dfn> is a real number which nominally represents
a number of milliseconds from some moment.
The connection between <a data-link-type="dfn" href="#time-value">time values</a> and wall-clock milliseconds
may be obscured by any number of transformations applied to the value as
it passes through the time hierarchy.</p>


   <p class="annotation">
In the future we may have timelines that are based on UI gestures in
which case the connection between time values and milliseconds will be
weakened even further.
</p>


   <p>A <a data-link-type="dfn" href="#time-value">time value</a> may also be <dfn data-dfn-type="dfn" data-noexport="" id="unresolved">unresolved<a class="self-link" href="#unresolved"></a></dfn> if, for example,
a timing node is not in a state to produce a <a data-link-type="dfn" href="#time-value">time value</a>.</p>


   <p>Periodically, the user agent will queue a task to update the timing
model in a process called <dfn data-dfn-type="dfn" data-noexport="" id="sampling">sampling<a class="self-link" href="#sampling"></a></dfn>.
On each <dfn data-dfn-type="dfn" data-lt="single-sample" data-noexport="" id="single_sample">sample<a class="self-link" href="#single_sample"></a></dfn> the 
<a data-link-type="dfn" href="#time-value">time values</a> of each timing node are updated.</p>


   <p class="note" role="note">Note: A more precise definition of when the model is updated when scripting is
    involved is provided in <a href="#script-execution-and-live-updates-to-the-model">§5.24 Script execution and live updates to the model</a>.</p>


   <h3 class="heading settled" data-level="3.3" id="the-global-clock"><span class="secno">3.3. </span><span class="content">The global clock</span><a class="self-link" href="#the-global-clock"></a></h3>


   <p>At the root of the Web Animations timing hierarchy is the <a data-link-type="dfn" href="#global-clock">global
clock</a>.</p>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="global-clock">global clock<a class="self-link" href="#global-clock"></a></dfn> is a source of monotonically increasing
<a data-link-type="dfn" href="#time-value">time values</a> unaffected by adjustments to the system clock.
The <a data-link-type="dfn" href="#time-value">time values</a> produced by the <a data-link-type="dfn" href="#global-clock">global clock</a> represent
wall-clock milliseconds from an unspecified historical moment.
Because the zero time of the <a data-link-type="dfn" href="#global-clock">global clock</a> is not specified,
the absolute values of the <a data-link-type="dfn" href="#time-value">time values</a> produced by the <a data-link-type="dfn" href="#global-clock">global
clock</a> are not significant, only their rate of change.</p>


   <p class="note" role="note">Note: The <a data-link-type="dfn" href="#global-clock">global clock</a> is not exposed in the <a href="#programming-interface">programming interface</a> and nor is it
    expected to be exposed by markup.
    As a result the moment from which <a data-link-type="dfn" href="#global-clock">global clock</a> <a data-link-type="dfn" href="#time-value">time values</a>
    are measured, that is, the zero time of the clock, is
    implementation-dependent.
    One user agent may measure the number of milliseconds since the the user
    agent was loaded whilst another may use the time when the device was
    started.
    Both approaches are acceptable and produce no observable difference
    in the output of the model.</p>



   <h3 class="heading settled" data-level="3.4" id="timelines"><span class="secno">3.4. </span><span class="content">Timelines</span><a class="self-link" href="#timelines"></a></h3>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="timeline">timeline<a class="self-link" href="#timeline"></a></dfn> provides a source of <a data-link-type="dfn" href="#time-value">time values</a> for the
purpose of synchronization.</p>


   <p>Typically, a <a data-link-type="dfn" href="#timeline">timeline</a> is tied to the <a data-link-type="dfn" href="#global-clock">global clock</a> such
that its absolute time is calculated as a fixed offset from the time of
the <a data-link-type="dfn" href="#global-clock">global clock</a>.
This offset is established by designating some moment as the timeline’s
<dfn data-dfn-type="dfn" data-noexport="" id="zero-time">zero time<a class="self-link" href="#zero-time"></a></dfn> and recording the <a data-link-type="dfn" href="#time-value">time value</a> of the
<a data-link-type="dfn" href="#global-clock">global clock</a> at that moment.
At subsequent moments, the <a data-link-type="dfn" href="#time-value">time value</a> of the timeline is
calculated as the difference between the current <a data-link-type="dfn" href="#time-value">time value</a> of
the <a data-link-type="dfn" href="#global-clock">global clock</a> and the value recorded at the <a data-link-type="dfn" href="#zero-time">zero time</a>.</p>


   <p class="annotation">
  Note that we anticipate that other types of timelines may be introduced
  in the future that are not tied to the global clock.
  For example, a timeline whose time values are related to the progress of
  a UI gesture.
</p>


   <p>Since a <a data-link-type="dfn" href="#timeline">timeline</a> may be defined relative to a moment that has yet
to occur, it may not always be able to return a meaningful <a data-link-type="dfn" href="#time-value">time
value</a>, but only an <a data-link-type="dfn" href="#unresolved">unresolved</a> time value.
A <a data-link-type="dfn" href="#timeline">timeline</a> is considered to be
<dfn data-dfn-type="dfn" data-lt="inactive timeline" data-noexport="" id="inactive-timeline">inactive<a class="self-link" href="#inactive-timeline"></a></dfn>
when its <a data-link-type="dfn" href="#time-value">time value</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>


   <h4 class="heading settled" data-level="3.4.1" id="the-document-timeline"><span class="secno">3.4.1. </span><span class="content">The document timeline</span><a class="self-link" href="#the-document-timeline"></a></h4>


   <p>Each document has a <a data-link-type="dfn" href="#timeline">timeline</a> called the <dfn data-dfn-type="dfn" data-noexport="" id="document-timeline">document
timeline<a class="self-link" href="#document-timeline"></a></dfn>.
The <a data-link-type="dfn" href="#time-value">time values</a> of the <a data-link-type="dfn" href="#document-timeline">document timeline</a> are calculated
as a fixed offset from the <a data-link-type="dfn" href="#global-clock">global clock</a> such that the <a data-link-type="dfn" href="#zero-time">zero
time</a> corresponds to the <a href="http://www.w3.org/TR/navigation-timing/#dom-performancetiming-navigationstart">
<code>navigationStart</code></a> moment <a data-link-type="biblio" href="#biblio-navigation-timing">[NAVIGATION-TIMING]</a>.
Prior to this moment, the <a data-link-type="dfn" href="#document-timeline">document timeline</a> is
<a data-link-type="dfn" href="#inactive-timeline">inactive</a>.</p>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>Since the <a data-link-type="dfn" href="#document-timeline">document timeline</a> is tied to the <a data-link-type="dfn" href="#global-clock">global
clock</a> by a fixed offset, <a data-link-type="dfn" href="#time-value">time values</a> reported by the
<a data-link-type="dfn" href="#document-timeline">document timeline</a> increase monotonically.
Furthermore, since no scaling is applied, these <a data-link-type="dfn" href="#time-value">time values</a>
are proportional to wall-clock milliseconds.</p>


    <p>Since the <a data-link-type="dfn" href="#time-value">time values</a> of the <a data-link-type="dfn" href="#document-timeline">document timeline</a> are
relative to the <code>navigationStart</code> time,
<code>document.timeline.currentTime</code> will roughly correspond to
<a href="http://www.w3.org/TR/hr-time/#dom-performance-now">
<code>Performance.now()</code></a>
<a data-link-type="biblio" href="#biblio-hr-time">[HR-TIME]</a> with the exception that
<code>document.timeline.currentTime</code> does not change within
a script execution block as defined in <a href="#script-execution-and-live-updates-to-the-model">§5.24 Script execution and live updates to the model</a>.</p>

</div>


   <h3 class="heading settled" data-level="3.5" id="players"><span class="secno">3.5. </span><span class="content">Players</span><a class="self-link" href="#players"></a></h3>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>The children of a <a data-link-type="dfn" href="#timeline">timeline</a> are called <em>players</em>.
A player takes an <a data-link-type="dfn" href="#animation-node">animation node</a> which is a static
description of some timed behavior and binds it to a <a data-link-type="dfn" href="#timeline">timeline</a>
so that it runs.
A player also allows run-time control of the connection between the
<a data-link-type="dfn" href="#animation-node">animation node</a> and its <a data-link-type="dfn" href="#timeline">timeline</a> by providing pausing,
seeking, and speed control.
The relationship between a player and an <a data-link-type="dfn" href="#animation-node">animation node</a> is
analogous to that of a DVD player and a DVD.</p>
</div>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="player">player<a class="self-link" href="#player"></a></dfn> connects a single <a data-link-type="dfn" href="#animation-node">animation node</a>, called
its <dfn data-dfn-type="dfn" data-noexport="" id="source-content">source content<a class="self-link" href="#source-content"></a></dfn>, to a <a data-link-type="dfn" href="#timeline">timeline</a> and provides
playback control.
Both of these associations are optional and configurable such that
a <a data-link-type="dfn" href="#player">player</a> may have no associated <a data-link-type="dfn" href="#source-content">source content</a> or
<a data-link-type="dfn" href="#timeline">timeline</a> at a given moment.</p>


   <p>A <a data-link-type="dfn" href="#player">player</a>’s <dfn data-dfn-type="dfn" data-lt="player start time" data-noexport="" id="player-start-time">start time<a class="self-link" href="#player-start-time"></a></dfn> is the
<a data-link-type="dfn" href="#time-value">time value</a> of its <a data-link-type="dfn" href="#timeline">timeline</a> when its <a data-link-type="dfn" href="#source-content">source content</a>
is scheduled to begin playback. A player’s <a data-link-type="dfn" href="#player-start-time">start time</a> is initially
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>


   <p>A <a data-link-type="dfn" href="#player">player</a> also maintains a <dfn data-dfn-type="dfn" data-noexport="" id="hold-time">hold time<a class="self-link" href="#hold-time"></a></dfn> <a data-link-type="dfn" href="#time-value">time value</a>
which is used to fix the player’s output <a data-link-type="dfn" href="#time-value">time value</a>, called its
<a data-link-type="dfn" href="#current-time">current time</a>, in circumstances such as pausing.
The <a data-link-type="dfn" href="#hold-time">hold time</a> is initially <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>


   <p>When a <a data-link-type="dfn" href="#player">player</a> is created, it is assigned a globally unique
sequence number called the <dfn data-dfn-type="dfn" data-noexport="" id="player-sequence-number">player sequence number<a class="self-link" href="#player-sequence-number"></a></dfn>.
This number is used to resolve the sort order of players for a variety
of situations such as combining animations and returning the list of
current players.</p>


   <p class="issue" id="issue-f3507204"><a class="self-link" href="#issue-f3507204"></a>Should this actually be based on when the player is attached to
    a timeline? Or when it leaves the idle state?</p>


   <h4 class="heading settled" data-level="3.5.1" id="setting-the-timeline"><span class="secno">3.5.1. </span><span class="content">Setting the timeline of a player</span><a class="self-link" href="#setting-the-timeline"></a></h4>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="set-the-timeline-of-a-player">set the timeline of a player<a class="self-link" href="#set-the-timeline-of-a-player"></a></dfn>, <var>player</var>,
to <var>new timeline</var> which may be null, is as follows:</p>


   <ol>
    <li data-md="">
     <p>Let <var>old timeline</var> be the current <a data-link-type="dfn" href="#timeline">timeline</a> of
<var>player</var>, if any.</p>
     

    <li data-md="">
     <p>If <var>new timeline</var> is the same object as <var>old timeline</var>,
abort this procedure.</p>
     

    <li data-md="">
     <p>If <var>new timeline</var> is null and <var>old timeline</var> is not null,
run the procedure to <a data-link-type="dfn" href="#reset-a-players-pending-tasks">reset a player’s pending tasks</a> on
<var>player</var>.</p>
     

     <p class="note" role="note">
  Note that if <var>new timeline</var> is not null and <var>player</var> has
  a <a data-link-type="dfn" href="#pending-play-task">pending play task</a> or a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a> no special
  handling is required: the pending task will run as soon as the
  <a data-link-type="dfn" href="#player">player</a> is <a data-link-type="dfn" href="#ready">ready</a> even though this may occur at a different
  moment than it might have done with the old timeline.
</p>
     

    <li data-md="">
     <p>Let the <a data-link-type="dfn" href="#timeline">timeline</a> of <var>player</var> be <var>new timeline</var>.</p>
     

    <li data-md="">
     <p class="todo">
  If <var>new timeline</var> is null, ensure that <a data-link-type="dfn" href="#custom-effect">custom effects</a> get
  called with an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-fraction">time fraction</a> (unless a subsequent
  change in the same script execution context makes this redundant).
</p>
     

    <li data-md="">
     <p>Run the procedure to <a data-link-type="dfn" href="#update-a-players-finished-state">update a player’s finished state</a> for
<var>player</var>.</p>
     
</ol>

   <p class="todo">
  Update this to preserve the player’s <a data-link-type="dfn" href="#current-time">current time</a>.
</p>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="reset-a-players-pending-tasks">reset a player’s pending tasks<a class="self-link" href="#reset-a-players-pending-tasks"></a></dfn> for <var>player</var>
is as follows:</p>


   <ol>
    <li data-md="">
     <p>If <var>player</var> has a <a data-link-type="dfn" href="#pending-play-task">pending play task</a>, cancel that task.</p>
     

    <li data-md="">
     <p>If <var>player</var> has a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a>, cancel that task.</p>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#reject-a-promise">Reject</a> <var>player</var>’s <a data-link-type="dfn" href="#current-ready-promise">current ready
promise</a> with a DOMException named "AbortError".</p>
     

    <li data-md="">
     <p>Let <var>player</var>’s <a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> be the result of
<a data-link-type="dfn" href="#create-a-new-resolved-promise">creating a new resolved Promise
object</a>.</p>
     
</ol>

   <h4 class="heading settled" data-level="3.5.2" id="setting-the-source-content"><span class="secno">3.5.2. </span><span class="content">Setting the source content of a
  player</span><a class="self-link" href="#setting-the-source-content"></a></h4>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="set-the-source-content-of-a-player">set the source content of a player<a class="self-link" href="#set-the-source-content-of-a-player"></a></dfn>,
<var>player</var>, to <var>new content</var> which may be null, is as follows:</p>



   <ol>
    <li data-md="">
     <p>Let <var>old content</var> be the current <a data-link-type="dfn" href="#source-content">source content</a> of
<var>player</var>, if any.</p>
     

    <li data-md="">
     <p>If <var>new content</var> is the same object as <var>old content</var>,
abort this procedure.</p>
     

    <li data-md="">
     <p>If <var>new content</var> is null and <var>old content</var> is not null,
run the procedure to <a data-link-type="dfn" href="#reset-a-players-pending-tasks">reset a player’s pending tasks</a> on
<var>player</var>.</p>
     

    <li data-md="">
     <p>If <var>player</var> has a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a>, reschedule that task
to run as soon as <var>player</var> is <a data-link-type="dfn" href="#ready">ready</a>.</p>
     

    <li data-md="">
     <p>If <var>player</var> has a <a data-link-type="dfn" href="#pending-play-task">pending play task</a>, reschedule that task
to run as soon as <var>player</var> is <a data-link-type="dfn" href="#ready">ready</a> to play <var>new
content</var>.</p>
     

    <li data-md="">
     <p>If <var>new content</var> is not <code>null</code> and
if <var>new content</var> has a <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>,
<a data-link-type="dfn" href="#remove-an-animation-node">remove</a> <var>new content</var> from
its <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>.</p>
     

    <li data-md="">
     <p>If <var>new content</var> is not <code>null</code> and
if <var>new content</var> is the <a data-link-type="dfn" href="#source-content">source content</a> of another
<a data-link-type="dfn" href="#player">player</a>, <var>previous player</var>, run the procedure to <a data-link-type="dfn" href="#set-the-source-content-of-a-player">set the
source content of a player</a> (this procedure) on <var>previous
player</var> passing null as <var>new content</var>.</p>
     

    <li data-md="">
     <p>Let the <a data-link-type="dfn" href="#source-content">source content</a> of <var>player</var> be <var>new
content</var>.</p>
     

    <li data-md="">
     <p>If <var>old content</var> is not <code>null</code>, queue a task to call any    <a data-link-type="dfn" href="#custom-effect">custom effects</a> associated with <a data-link-type="dfn" href="#inclusive-descendant">inclusive descendants</a> of
<var>old content</var>    with an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-fraction">time fraction</a>.</p>
     

     <div class="issue" id="issue-0bdffc92"><a class="self-link" href="#issue-0bdffc92"></a>
  This is not quite right. If <var>old content</var> is attached to another
  player in the same task then we should probably not do an extra
  callback with <a data-link-type="dfn" href="#unresolved">unresolved</a>.


      <p>The definition of when <a data-link-type="dfn" href="#custom-effect">custom effects</a> gets called needs to be
  audited and probably rewritten.</p>
</div>
     

    <li data-md="">
     <p>Run the procedure to <a data-link-type="dfn" href="#update-a-players-finished-state">update a player’s finished state</a> for
<var>player</var>.</p>
     
</ol>

   <h4 class="heading settled" data-level="3.5.3" id="the-current-time-of-a-player"><span class="secno">3.5.3. </span><span class="content">The current time of a player</span><a class="self-link" href="#the-current-time-of-a-player"></a></h4>


   <p><a data-link-type="dfn" href="#player">Players</a> provide a <a data-link-type="dfn" href="#time-value">time value</a> to their <a data-link-type="dfn" href="#source-content">source
content</a> called the player’s <dfn data-dfn-type="dfn" data-noexport="" id="current-time">current time<a class="self-link" href="#current-time"></a></dfn>.</p>


   <p>The <a data-link-type="dfn" href="#current-time">current time</a> is calculated from the first
matching condition from below:</p>


   <div class="switch">


    <dl>
     <dt data-md="">
      <p>If the player’s <a data-link-type="dfn" href="#hold-time">hold time</a> is <a data-link-type="dfn" href="#unresolved">resolved</a>,</p>
      

     <dd data-md="">
      <p>The <a data-link-type="dfn" href="#current-time">current time</a> is the player’s <a data-link-type="dfn" href="#hold-time">hold time</a>.</p>
      


     <dt data-md="">
      <p>If <em>any</em> of the following are true:</p>
      


      <ol>
       <li data-md="">
        <p>the player has no associated <a data-link-type="dfn" href="#timeline">timeline</a>, or</p>
        

       <li data-md="">
        <p>the associated <a data-link-type="dfn" href="#timeline">timeline</a> is
<a data-link-type="dfn" href="#inactive-timeline">inactive</a>, or</p>
        

       <li data-md="">
        <p>the player’s <a data-link-type="dfn" href="#player-start-time">start time</a> is
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
        
</ol>
      

     <dd data-md="">
      <p>The <a data-link-type="dfn" href="#current-time">current time</a> is an <a data-link-type="dfn" href="#unresolved">unresolved</a> time value.</p>
      


     <dt data-md="">
      <p>Otherwise,</p>
      

     <dd data-md="">


      <blockquote>
  <code><a data-link-type="dfn" href="#current-time">current time</a> =
  (<var>timeline time</var> - <a data-link-type="dfn" href="#player-start-time">start time</a>)
  × <a data-link-type="dfn" href="#player-playback-rate">playback rate</a></code>
</blockquote>
      


      <p>Where <var>timeline time</var> is the current <a data-link-type="dfn" href="#time-value">time value</a> of
the associated <a data-link-type="dfn" href="#timeline">timeline</a>.
The <a data-link-type="dfn" href="#player-playback-rate">playback rate</a> value is
defined in <a href="#speed-control">§3.5.16 Speed control</a>.</p>
      
</dl>
</div>


   <h4 class="heading settled" data-level="3.5.4" id="setting-the-current-time-of-a-player"><span class="secno">3.5.4. </span><span class="content">Setting the current time of a player</span><a class="self-link" href="#setting-the-current-time-of-a-player"></a></h4>


   <p>The <a data-link-type="dfn" href="#current-time">current time</a> of a player can be set to a new value to
<em>seek</em> the player.
The procedure for setting the current time is split into two parts.</p>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="silently-set-the-current-time">silently set the current time<a class="self-link" href="#silently-set-the-current-time"></a></dfn> of
a player, <var>player</var>, to <var>seek time</var> is as follows:</p>


   <ol>
    <li data-md="">
     <p>If <var>seek time</var> is an <a data-link-type="dfn" href="#unresolved">unresolved</a> time value,
<a href="http://heycam.github.io/webidl/#dfn-throw">throw</a> a
NotSupportedError.</p>
     

    <li data-md="">
     <p>Update either <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> or <a data-link-type="dfn" href="#player-start-time">start time</a> as follows:</p>
     


     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If <em>any</em> of the following conditions are true:</p>
        


        <ul>
         <li data-md="">
          <p><var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> is
<a data-link-type="dfn" href="#unresolved">resolved</a>, or</p>
          

         <li data-md="">
          <p><var>player</var> has no associated <a data-link-type="dfn" href="#timeline">timeline</a> or the
associated <a data-link-type="dfn" href="#timeline">timeline</a> is
<a data-link-type="dfn" href="#inactive-timeline">inactive</a>, or</p>
          

         <li data-md="">
          <p><var>player</var>’s
<a data-link-type="dfn" href="#player-playback-rate">playback rate</a> is 0, or</p>
          

         <li data-md="">
          <p><var>player</var> has a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a></p>
          
</ul>
        

       <dd data-md="">
        <p>Set <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> to <var>seek time</var>.</p>
        


       <dt data-md="">
        <p>Otherwise,</p>
        

       <dd data-md="">
        <p>Set <var>player</var>’s <a data-link-type="dfn" href="#player-start-time">start time</a> to
the result of evaluating
<code><var>timeline time</var> - (<var>seek time</var> / <a data-link-type="dfn" href="#player-playback-rate">playback rate</a>)</code>
where <var>timeline time</var> is the current <a data-link-type="dfn" href="#time-value">time value</a>
of <a data-link-type="dfn" href="#timeline">timeline</a> associated with <var>player</var>.</p>
        
</dl>
</div>
     


    <li data-md="">
     <p>If <var>player</var> has no associated <a data-link-type="dfn" href="#timeline">timeline</a> or the associated
<a data-link-type="dfn" href="#timeline">timeline</a> is <a data-link-type="dfn" href="#inactive-timeline">inactive</a>,
make <var>player</var>’s <a data-link-type="dfn" href="#player-start-time">start time</a>
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     


     <p class="annotation">
  This preserves the invariant that when we don’t have an active timeline it
  is only possible to set <em>either</em> the <a data-link-type="dfn" href="#player-start-time">player start time</a>
  <em>or</em> the player’s <a data-link-type="dfn" href="#current-time">current time</a>.
</p>
     


    <li data-md="">
     <p>Make <var>player</var>’s <a data-link-type="dfn" href="#previous-current-time">previous current time</a> <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     
</ol>

   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="set-the-current-time">set the current time<a class="self-link" href="#set-the-current-time"></a></dfn> of a player,
<var>player</var>, to <var>seek time</var> is as follows:</p>


   <ol>
    <li data-md="">
     <p>Run the steps to <a data-link-type="dfn" href="#silently-set-the-current-time">silently set the current time</a> of
<var>player</var> to <var>seek time</var>.</p>
     

    <li data-md="">
     <p>If <var>player</var> has a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a>, cancel the
task and <a data-link-type="dfn" href="#resolve-a-promise">resolve</a> <var>player</var>’s
<a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> with <var>player</var>.</p>
     

    <li data-md="">
     <p>Run the procedure to <a data-link-type="dfn" href="#update-a-players-finished-state">update a player’s finished state</a>
for <var>player</var>.</p>
     
</ol>

   <h4 class="heading settled" data-level="3.5.5" id="setting-the-start-time-of-a-player"><span class="secno">3.5.5. </span><span class="content">Setting the start time of a player</span><a class="self-link" href="#setting-the-start-time-of-a-player"></a></h4>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="update-the-player-start-time">update the player start time<a class="self-link" href="#update-the-player-start-time"></a></dfn>
of <a data-link-type="dfn" href="#player">player</a>, <var>player</var>, to
<a data-link-type="dfn" href="#player-start-time">start time</a>, <var>new start time</var>,
is as follows:</p>


   <ol>
    <li data-md="">
     <p>Let <var>timeline time</var> be the current <a data-link-type="dfn" href="#time-value">time value</a> of the
<a data-link-type="dfn" href="#timeline">timeline</a> that <var>player</var> is associated with.
If there is no <a data-link-type="dfn" href="#timeline">timeline</a> associated with <var>player</var> or the
associated timeline is <a data-link-type="dfn" href="#inactive-timeline">inactive</a>,
let the <var>timeline time</var> be <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     


    <li data-md="">
     <p>If <var>timeline time</var> is <a data-link-type="dfn" href="#unresolved">unresolved</a> and <var>new start
time</var> is <a data-link-type="dfn" href="#unresolved">resolved</a>, make <var>player</var>’s
<a data-link-type="dfn" href="#hold-time">hold time</a> <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     


     <p class="annotation">
  This preserves the invariant that when we don’t have an active timeline it
  is only possible to set <em>either</em> the <a data-link-type="dfn" href="#player-start-time">player start time</a>
  <em>or</em> the player’s <a data-link-type="dfn" href="#current-time">current time</a>.
</p>
     


    <li data-md="">
     <p>Let <var>previous current time</var> be <var>player</var>’s <a data-link-type="dfn" href="#current-time">current
time</a>.</p>
     


     <p class="note" role="note">Note: This is the <a data-link-type="dfn" href="#current-time">current time</a> after applying the changes from the
previous step which may cause the <a data-link-type="dfn" href="#current-time">current time</a> to become
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     


    <li data-md="">
     <p>Set <var>player</var>’s <a data-link-type="dfn" href="#player-start-time">start time</a> to
<var>new start time</var>.</p>
     


    <li data-md="">
     <p>Update <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> based on the first matching
condition from the following,</p>
     


     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If <var>new start time</var> is <a data-link-type="dfn" href="#unresolved">resolved</a>,</p>
        

       <dd data-md="">
        <p>If <var>player</var>’s <a data-link-type="dfn" href="#player-playback-rate">playback rate</a>
is not zero, make <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a>
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
        


       <dt data-md="">
        <p>Otherwise (<var>new start time</var> is <a data-link-type="dfn" href="#unresolved">unresolved</a>),</p>
        

       <dd data-md="">
        <p>Set <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> to <var>previous current
time</var> even if <var>previous current time</var> is
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
        
</dl>
</div>
     


    <li data-md="">
     <p>If <var>player</var> has a <a data-link-type="dfn" href="#pending-play-task">pending play task</a> or
a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a>, cancel that task and
<a data-link-type="dfn" href="#resolve-a-promise">resolve</a> <var>player</var>’s
<a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> with <var>player</var>.</p>
     


    <li data-md="">
     <p>Run the procedure to <a data-link-type="dfn" href="#update-a-players-finished-state">update a player’s finished state</a>
for <var>player</var>.</p>
     
</ol>

   <h4 class="heading settled" data-level="3.5.6" id="waiting-for-source-content"><span class="secno">3.5.6. </span><span class="content">Waiting for source content</span><a class="self-link" href="#waiting-for-source-content"></a></h4>


   <div class="informative-bg">


    <p><em>This section is non-normative</em></p>


    <p>Some operations performed by a <a data-link-type="dfn" href="#player">player</a> may not occur
instantaneously.
For example, some user agents may delegate the playback of an
animation to a separate process or to specialized graphics hardware
each of which may incur some setup overhead.</p>


    <p>If such an animation is timed from the moment when the animation was
triggered there may be a significant jump between the first and second
frames of the animation corresponding to the setup time involved.</p>


    <p>To avoid this problem, Web Animations typically begins timing
animations from the moment when the first frame of the animation is
complete.
This is represented by an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#player-start-time">start time</a> on the <a data-link-type="dfn" href="#player">player</a> which becomes
resolved when the player is <a data-link-type="dfn" href="#ready">ready</a>.
Content may opt out of this behavior by setting the <a data-link-type="dfn" href="#player-start-time">start time</a>
to a <a data-link-type="dfn" href="#unresolved">resolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>

</div>


   <p>A player is <dfn data-dfn-type="dfn" data-noexport="" id="ready">ready<a class="self-link" href="#ready"></a></dfn> at the first moment where <em>both</em> of the
following conditions are true:</p>


   <ul>
    <li data-md="">
     <p>the user agent has completed any setup required to begin the playback of
each <a data-link-type="dfn" href="#inclusive-descendant">inclusive descendant</a> of
the player’s <a data-link-type="dfn" href="#source-content">source content</a>
including rendering the first frame of any <a data-link-type="dfn" href="#concept-animation">animation</a> with an
associated <a data-link-type="dfn" href="#animation-effect">animation effect</a> or executing any <a data-link-type="dfn" href="#custom-effect">custom effects</a>
associated with such an <a data-link-type="dfn" href="#concept-animation">animation</a>.</p>
     


    <li data-md="">
     <p>the player is associated with a <a data-link-type="dfn" href="#timeline">timeline</a> that is not
<a data-link-type="dfn" href="#inactive-timeline">inactive</a>.</p>
     
</ul>

   <h4 class="heading settled" data-level="3.5.7" id="promise-objects"><span class="secno">3.5.7. </span><span class="content">Promise objects</span><a class="self-link" href="#promise-objects"></a></h4>


   <p><dfn data-dfn-type="dfn" data-noexport="" id="promise">Promise<a class="self-link" href="#promise"></a></dfn> objects are defined by <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a>, <a href="http://people.mozilla.org/~jorendorff/es6-draft.html#sec-promise-objects">section
  25.4</a>.</p>


   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="resolve-a-promise">resolve a Promise<a class="self-link" href="#resolve-a-promise"></a></dfn> with <var>value</var>,
call the [[Call]] internal method of [[Resolve]] on the <a href="http://people.mozilla.org/~jorendorff/es6-draft.html#sec-promisecapability-records">Promise
capability</a> record for the promise, passing <code>undefined</code> as
<var>thisArgument</var> and (<var>value</var>) as <var>argumentsList</var>.</p>


   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="reject-a-promise">reject a Promise<a class="self-link" href="#reject-a-promise"></a></dfn> with <var>reason</var>,
call the [[Call]] internal method of [[Reject]] on the <a href="http://people.mozilla.org/~jorendorff/es6-draft.html#sec-promisecapability-records">Promise
capability</a> record for the promise, passing <code>undefined</code> as
<var>thisArgument</var> and (<var>reason</var>) as <var>argumentsList</var>.</p>


   <p>To <dfn data-dfn-type="dfn" data-noexport="" id="create-a-new-resolved-promise">create a new resolved Promise<a class="self-link" href="#create-a-new-resolved-promise"></a></dfn> with <var>value</var>, call <a href="http://people.mozilla.org/~jorendorff/es6-draft.html#sec-promise.resolve">Promise.resolve</a>,
passing <var>value</var> as <var>x</var>.</p>


   <h4 class="heading settled" data-level="3.5.8" id="the-current-ready-promise"><span class="secno">3.5.8. </span><span class="content">The current ready promise</span><a class="self-link" href="#the-current-ready-promise"></a></h4>


   <p>Each <a data-link-type="dfn" href="#player">player</a> has a <dfn data-dfn-type="dfn" data-noexport="" id="current-ready-promise">current ready promise<a class="self-link" href="#current-ready-promise"></a></dfn>.
The <a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> is initially a resolved <a data-link-type="dfn" href="#promise">Promise</a> created
using the procedure to <a data-link-type="dfn" href="#create-a-new-resolved-promise">create a new resolved Promise</a>.</p>


   <p>The object is replaced with a new <a data-link-type="dfn" href="#promise">Promise</a> object every time the player
enters the <a data-link-type="dfn" href="#pending-play-state">pending play state</a> as well as when the player is
cancelled (see <a href="#cancelling-a-player-section">§3.5.15 Cancelling a player</a>).</p>


   <div class="note" role="note">


    <p>Note that since the same object is used for both pending play and
    pending pause requests, authors are advised to check the state of the
    player when the <a data-link-type="dfn" href="#promise">Promise</a> is resolved.</p>


    <p>For example, in the following code fragment, the state of the player
    will be <a data-link-type="dfn" href="#running-play-state">running</a> when the
    <a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> is resolved.
    This is because the player does not leave the <a data-link-type="dfn" href="#pending-play-state">pending play state</a>
    in between the calls to <code>pause</code> and
    <code>play</code> and hence the <a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> does
    not change.</p>

    
    <pre class="example lang-javascript">player.pause();
player.ready.then(function() {
  // Displays 'running'
  alert(player.playState);
});
player.play();</pre>

</div>


   <h4 class="heading settled" data-level="3.5.9" id="playing-a-player-section"><span class="secno">3.5.9. </span><span class="content">Playing a player</span><a class="self-link" href="#playing-a-player-section"></a></h4>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="play-a-player">play a player<a class="self-link" href="#play-a-player"></a></dfn>, <var>player</var>, is as follows:</p>


   <ol>
    <li data-md="">
     <p>Let <var>has pending ready promise</var> be a boolean flag that is
initially false.</p>
     

    <li data-md="">
     <p>If <var>player</var> has a <a data-link-type="dfn" href="#pending-play-task">pending play task</a>,</p>
     


     <ol>
      <li data-md="">
       <p>Cancel that task.</p>
       

      <li data-md="">
       <p>Set <var>has pending ready promise</var> to true.</p>
       
</ol>
     

    <li data-md="">
     <p>If <var>player</var> has a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a>,</p>
     


     <ol>
      <li data-md="">
       <p>Cancel that task.</p>
       

      <li data-md="">
       <p>If <var>player</var> has an associated <a data-link-type="dfn" href="#timeline">timeline</a> that is not
<a data-link-type="dfn" href="#inactive-timeline">inactive</a>, perform the following steps:</p>
       


       <ol>
        <li data-md="">
         <p>Set <var>player</var>’s <a data-link-type="dfn" href="#player-start-time">start time</a>
to the result of evaluating <code><var>timeline time</var> -
<a data-link-type="dfn" href="#hold-time">hold time</a> / <a data-link-type="dfn" href="#player-playback-rate">playback
rate</a></code>
where <var>timeline time</var> is the current <a data-link-type="dfn" href="#time-value">time value</a> of
the <a data-link-type="dfn" href="#timeline">timeline</a> associated with <var>player</var>.</p>
         

        <li data-md="">
         <p>Let <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> be <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
         
</ol>
       

      <li data-md="">
       <p>Set <var>has pending ready promise</var> to true.</p>
       
</ol>
     

    <li data-md="">
     <p>Perform the steps corresponding to the <em>first</em> matching
condition from the following, if any:</p>
     


     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> > 0 and <em>either</em>
<var>player</var>’s:</p>
        


        <ul>
         <li data-md="">
          <p><a data-link-type="dfn" href="#current-time">current time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>, or</p>
          

         <li data-md="">
          <p><a data-link-type="dfn" href="#current-time">current time</a> &lt; zero, or</p>
          

         <li data-md="">
          <p><a data-link-type="dfn" href="#current-time">current time</a> ≥ <a data-link-type="dfn" href="#source-content-end">source content end</a>,</p>
          
</ul>
        

       <dd data-md="">
        <p>Set <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> to zero.</p>
        

       <dt data-md="">
        <p>If <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> &lt; 0 and <em>either</em>
<var>player</var>’s:</p>
        


        <ul>
         <li data-md="">
          <p><a data-link-type="dfn" href="#current-time">current time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>, or</p>
          

         <li data-md="">
          <p><a data-link-type="dfn" href="#current-time">current time</a> ≤ zero, or</p>
          

         <li data-md="">
          <p><a data-link-type="dfn" href="#current-time">current time</a> > <a data-link-type="dfn" href="#source-content-end">source content end</a>,</p>
          
</ul>
        

       <dd data-md="">
        <p>set <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> to <a data-link-type="dfn" href="#source-content-end">source content end</a>.</p>
        

       <dt data-md="">
        <p>If <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> = 0 and <var>player</var>’s
<a data-link-type="dfn" href="#current-time">current time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>,</p>
        

       <dd data-md="">
        <p>Set <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> to zero.</p>
        
</dl>
</div>
     


    <li data-md="">
     <p>If <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>, perform the
following steps:</p>
     


     <ol>
      <li data-md="">
       <p>If <var>has pending ready promise</var> is true,
<a data-link-type="dfn" href="#resolve-a-promise">resolve</a> <var>player</var>’s <a data-link-type="dfn" href="#current-ready-promise">current
ready promise</a> with <var>player</var>.</p>
       


      <li data-md="">
       <p>Abort this procedure.</p>
       
</ol>
     

    <li data-md="">
     <p>Let <var>player</var>’s <a data-link-type="dfn" href="#player-start-time">start time</a> be
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     


    <li data-md="">
     <p>If <var>has pending ready promise</var> is false,
let <var>player</var>’s <a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> be a new
(pending) <a data-link-type="dfn" href="#promise">Promise</a> object.</p>
     


    <li data-md="">
     <p>Schedule a task to run as soon as <var>player</var> is <a data-link-type="dfn" href="#ready">ready</a>.
The task shall perform the following steps:</p>
     


     <ol>
      <li data-md="">
       <p><a data-link-type="dfn" href="#assert">Assert</a> that <a data-link-type="dfn" href="#hold-time">hold time</a> is <a data-link-type="dfn" href="#unresolved">resolved</a>. (This is because we don’t queue this
task if <a data-link-type="dfn" href="#hold-time">hold time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a> and anything that causes
it to become <a data-link-type="dfn" href="#unresolved">unresolved</a> while this task is queued, should cancel
this task.)</p>
       

      <li data-md="">
       <p>Let <var>ready time</var> be the <a data-link-type="dfn" href="#time-value">time value</a> of
the <a data-link-type="dfn" href="#timeline">timeline</a> associated with <var>player</var> at the moment
when <var>player</var> became <a data-link-type="dfn" href="#ready">ready</a>.</p>
       

      <li data-md="">
       <p>Let <var>new start time</var> be the result of evaluating
<code><var>ready time</var> - <a data-link-type="dfn" href="#hold-time">hold time</a> / <a data-link-type="dfn" href="#player-playback-rate">player
playback rate</a></code> for <var>player</var>.
If the <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> is zero, let <var>new start
time</var> be simply <var>ready time</var>.</p>
       

      <li data-md="">
       <p>If <var>player</var>’s <a data-link-type="dfn" href="#player-playback-rate">playback rate</a>
is not 0, make <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
       

      <li data-md="">
       <p>Set the <a data-link-type="dfn" href="#player-start-time">player start time</a> of <var>player</var>
to <var>new start time</var>.</p>
       

      <li data-md="">


       <div class="todo">Queue a task here for sampling custom effects.
(This should happen before we resolve the ready promise.)
</div>
       


      <li data-md="">
       <p><a data-link-type="dfn" href="#resolve-a-promise">Resolve</a> <var>player</var>’s <a data-link-type="dfn" href="#current-ready-promise">current
ready promise</a> with <var>player</var>.</p>
       

      <li data-md="">
       <p>Run the procedure to <a data-link-type="dfn" href="#update-a-players-finished-state">update a player’s finished state</a>
for <var>player</var>.</p>
       


       <div class="annotation">
    Note that the order of the above two steps is important
    since it means that a player with zero-length <a data-link-type="dfn" href="#source-content">source
    content</a> will resolve its <a data-link-type="dfn" href="#current-ready-promise">current ready promise</a>
    before its <a data-link-type="dfn" href="#current-finished-promise">current finished promise</a>.
</div>
       


       <p>So long as the above task is scheduled but has yet to run,
<var>player</var> is described as having a
<dfn data-dfn-type="dfn" data-noexport="" id="pending-play-task">pending play task<a class="self-link" href="#pending-play-task"></a></dfn>.</p>
       


       <p>A user agent MAY execute the above task immediately (if it
determines <var>player</var> is immediately <a data-link-type="dfn" href="#ready">ready</a>) thereby
bypassing the <a data-link-type="dfn" href="#pending-play-state">pending play state</a> altogether.</p>
       
</ol>
     

    <li data-md="">
     <p>Run the procedure to <a data-link-type="dfn" href="#update-a-players-finished-state">update a player’s finished state</a>
for <var>player</var>.</p>
     
</ol>

   <h4 class="heading settled" data-level="3.5.10" id="pausing-a-player-section"><span class="secno">3.5.10. </span><span class="content">Pausing a player</span><a class="self-link" href="#pausing-a-player-section"></a></h4>


   <p>Whenever a <a data-link-type="dfn" href="#player">player</a> has an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#player-start-time">start time</a>, its <a data-link-type="dfn" href="#current-time">current time</a> will be suspended.</p>


   <p>As with <a data-link-type="dfn" href="#play-a-player">playing a player</a>, pausing may not happen
instantaneously (see <a href="#waiting-for-source-content">§3.5.6 Waiting for source content</a>).
For example, if animation is performed by a separate process, it may
be necessary to synchronize the <a data-link-type="dfn" href="#current-time">current time</a> to ensure that it
reflects the state drawn by the animation process.</p>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="pause-a-player">pause a player<a class="self-link" href="#pause-a-player"></a></dfn>, <var>player</var> is as follows:</p>


   <ol>
    <li data-md="">
     <p>If <var>player</var> has a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a>, abort these steps.</p>
     

    <li data-md="">
     <p>Let <var>has pending ready promise</var> be a boolean flag that is
initially false.</p>
     

    <li data-md="">
     <p>If <var>player</var> has a <a data-link-type="dfn" href="#pending-play-task">pending play task</a>, cancel that task
and let <var>has pending ready promise</var> be true.</p>
     

    <li data-md="">
     <p>Set <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> to <a data-link-type="dfn" href="#current-time">current time</a>.</p>
     

    <li data-md="">
     <p>If <var>has pending ready promise</var> is false,
set <var>player</var>’s <a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> to a new
(pending) <a data-link-type="dfn" href="#promise">Promise</a> object.</p>
     

    <li data-md="">
     <p>Schedule a task to be executed at the first possible moment after
the user agent has performed any processing necessary to suspend
the playback of
any animations that are <a data-link-type="dfn" href="#inclusive-descendant">inclusive descendants</a> of
<var>player</var>’s <a data-link-type="dfn" href="#source-content">source content</a>, if any.
The task shall perform the following steps:</p>
     


     <ol>
      <li data-md="">
       <p>Set <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> to its <a data-link-type="dfn" href="#current-time">current time</a>
(even if the current time is <a data-link-type="dfn" href="#unresolved">unresolved</a>).</p>
       

      <li data-md="">
       <p>Make <var>player</var>’s <a data-link-type="dfn" href="#player-start-time">start time</a>
unresolved.</p>
       


      <li data-md="">


       <div class="todo">Queue a task here for sampling custom effects
    with the final current time.  (This should happen before we
    resolve the ready promise).
</div>
       


      <li data-md="">
       <p><a data-link-type="dfn" href="#resolve-a-promise">Resolve</a> <var>player</var>’s <a data-link-type="dfn" href="#current-ready-promise">current
ready promise</a> with <var>player</var>.</p>
       

      <li data-md="">
       <p>Run the procedure to <a data-link-type="dfn" href="#update-a-players-finished-state">update a player’s finished state</a>
for <var>player</var>.</p>
       
</ol>
     

     <p>So long as the above task is scheduled but has yet to run,
<var>player</var> is described as having a <dfn data-dfn-type="dfn" data-noexport="" id="pending-pause-task">pending pause task<a class="self-link" href="#pending-pause-task"></a></dfn>.
While the task is running, however, <var>player</var> does
<em>not</em> have a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a>.</p>
     


    <li data-md="">
     <p>Run the procedure to <a data-link-type="dfn" href="#update-a-players-finished-state">update a player’s finished state</a>
for <var>player</var>.</p>
     
</ol>

   <h4 class="heading settled" data-level="3.5.11" id="reaching-the-end"><span class="secno">3.5.11. </span><span class="content">Reaching the end</span><a class="self-link" href="#reaching-the-end"></a></h4>


   <div class="informative-bg">


    <p><em>This section is non-normative</em></p>


    <p>Players in the real world such as DVD players or cassette players
typically continue playing until they reach the end of their media
at which point they stop.
If such players are able to play in reverse, they typically stop
playing when they reach the beginning of their media.
In order to emulate this behavior and to provide consistency
with HTML’s <a href="http://www.w3.org/TR/html5/embedded-content-0.html#media-elements">media
elements</a> <a data-link-type="biblio" href="#biblio-html5">[HTML5]</a>, the <a data-link-type="dfn" href="#current-time">current time</a> of Web Animations'
players do not play forwards beyond the <a data-link-type="dfn" href="#end-time">end time</a> of their
<a data-link-type="dfn" href="#source-content">source content</a> or play backwards past time zero.</p>


    <p>A player that has reached the natural boundary of its playback range
is said to have <em>finished</em>.</p>


    <p>Graphically, the effect of limiting the current time is shown below.</p>


    <div class="figure">
  <img alt="The effect of limiting the current time of a player." src="img/limiting.svg" width="500">
</div>

    <p class="caption">
The effect of limiting the <a data-link-type="dfn" href="#current-time">current time</a> of a <a data-link-type="dfn" href="#player">player</a>
with a start time of 1s, a source content of length 3s, and
a positive <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a>.
After the <a data-link-type="dfn" href="#current-time">current time</a> of the player reaches the end of the
source content, it is capped at 3s.
</p>


    <p>It is possible, however, to <em>seek</em> the <a data-link-type="dfn" href="#current-time">current time</a> of
a <a data-link-type="dfn" href="#player">player</a> to a time past the end of the <a data-link-type="dfn" href="#source-content">source content</a>.
When doing so, the <a data-link-type="dfn" href="#current-time">current time</a> will not progress but the
player will act as if it had been paused at the seeked time.</p>


    <p>This allows, for example, seeking the <a data-link-type="dfn" href="#current-time">current time</a> of
a player with <em>no</em> <a data-link-type="dfn" href="#source-content">source content</a> to 5s.
If <a data-link-type="dfn" href="#source-content">source content</a> with an <a data-link-type="dfn" href="#end-time">end time</a> later than 5s is
later associated with the player, playback will begin from the 5s
mark.</p>


    <p>Similar behavior to the above scenario may arise when the
length of a player’s <a data-link-type="dfn" href="#source-content">source content</a> changes.</p>


    <p>Similarly, when the <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> is negative, the
<a data-link-type="dfn" href="#current-time">current time</a> does not progress past time zero.</p>

</div>


   <h4 class="heading settled" data-level="3.5.12" id="the-current-finished-promise"><span class="secno">3.5.12. </span><span class="content">The current finished promise</span><a class="self-link" href="#the-current-finished-promise"></a></h4>


   <p>Each player has a <dfn data-dfn-type="dfn" data-noexport="" id="current-finished-promise">current finished promise<a class="self-link" href="#current-finished-promise"></a></dfn>.
The <a data-link-type="dfn" href="#current-finished-promise">current finished promise</a> is initially a pending <a data-link-type="dfn" href="#promise">Promise</a>
object.</p>


   <p>The object is replaced with a new (pending) <a data-link-type="dfn" href="#promise">Promise</a> object every time the
player leaves the <a data-link-type="dfn" href="#finished-play-state">finished play state</a>.</p>


   <h4 class="heading settled" data-level="3.5.13" id="updating-the-finished-state"><span class="secno">3.5.13. </span><span class="content">Updating the finished state</span><a class="self-link" href="#updating-the-finished-state"></a></h4>


   <p>For a player with a positive <a data-link-type="dfn" href="#player-playback-rate">playback
rate</a>, the <a data-link-type="dfn" href="#current-time">current time</a> continues to increase until it
reaches the <a data-link-type="dfn" href="#source-content-end">source content end</a>.</p>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="source-content-end">source content end<a class="self-link" href="#source-content-end"></a></dfn> of a player is equal to the <a data-link-type="dfn" href="#end-time">end
time</a> of the player’s <a data-link-type="dfn" href="#source-content">source content</a>.
If the player has no <a data-link-type="dfn" href="#source-content">source content</a>, the <a data-link-type="dfn" href="#source-content-end">source content
end</a> is zero.</p>


   <p>A player with a negative <a data-link-type="dfn" href="#player-playback-rate">playback
rate</a>, the <a data-link-type="dfn" href="#current-time">current time</a> continues to decrease until it
reaches zero.</p>


   <p>A player that has reached this boundary (or overshot it) and has a
<a data-link-type="dfn" href="#unresolved">resolved</a> <a data-link-type="dfn" href="#player-start-time">player start time</a>
is said to be <a data-link-type="dfn" href="#finished-play-state">finished</a>.
(If the player has an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#player-start-time">player start time</a> it is
considered to be <a data-link-type="dfn" href="#paused-play-state">paused</a> rather than
<a data-link-type="dfn" href="#finished-play-state">finished</a>.)</p>


   <p>The crossing of this boundary is checked on each modification to the
player object using the procedure for <a data-link-type="dfn" href="#update-a-players-finished-state">update a player’s finished
state</a> defined below.</p>


   <p>For each player, the user agent maintains a <dfn data-dfn-type="dfn" data-noexport="" id="previous-current-time">previous current
time<a class="self-link" href="#previous-current-time"></a></dfn> <a data-link-type="dfn" href="#time-value">time value</a> that is originally <a data-link-type="dfn" href="#unresolved">unresolved</a>,
and a <dfn data-dfn-type="dfn" data-noexport="" id="previous-finished-state">previous finished state<a class="self-link" href="#previous-finished-state"></a></dfn> boolean flag that is
initially false.</p>


   <div class="todo">
    Mention that this gets run at the end of each sample as well.
    And at the end of any update to the timing of the <a data-link-type="dfn" href="#source-content">source
    content</a>.
</div>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="update-a-players-finished-state">update a player’s finished state<a class="self-link" href="#update-a-players-finished-state"></a></dfn> for
<var>player</var> is as follows:</p>


   <ol>
    <li data-md="">
     <p>If both of the following conditions are true,</p>
     


     <ul>
      <li data-md="">
       <p><var>player</var>’s <a data-link-type="dfn" href="#player-start-time">start time</a> is
<a data-link-type="dfn" href="#unresolved">resolved</a>, and</p>
       

      <li data-md="">
       <p><var>player</var> does <em>not</em> have a <a data-link-type="dfn" href="#pending-play-task">pending play task</a> or
a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a>,</p>
       
</ul>
     

     <p>then update <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> based on the first
matching condition for <var>player</var> from below, if any:</p>
     


     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> > 0 and
<a data-link-type="dfn" href="#current-time">current time</a> is <a data-link-type="dfn" href="#unresolved">resolved</a> and
greater than or equal to <a data-link-type="dfn" href="#source-content-end">source content end</a>,</p>
        

       <dd data-md="">
        <p>let the <a data-link-type="dfn" href="#hold-time">hold time</a> be the maximum value of
<a data-link-type="dfn" href="#previous-current-time">previous current time</a> and <a data-link-type="dfn" href="#source-content-end">source content end</a>.
If the <a data-link-type="dfn" href="#previous-current-time">previous current time</a> is
<a data-link-type="dfn" href="#unresolved">unresolved</a>, let the <a data-link-type="dfn" href="#hold-time">hold time</a> be <a data-link-type="dfn" href="#source-content-end">source
content end</a>.</p>
        

       <dt data-md="">
        <p>If <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> &lt; 0 and
<a data-link-type="dfn" href="#current-time">current time</a> is <a data-link-type="dfn" href="#unresolved">resolved</a> and
less than or equal to 0,</p>
        

       <dd data-md="">
        <p>let the <a data-link-type="dfn" href="#hold-time">hold time</a> be zero.</p>
        

       <dt data-md="">
        <p>If <a data-link-type="dfn" href="#current-time">current time</a> is <a data-link-type="dfn" href="#unresolved">resolved</a>, and
<a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> ≠ 0,</p>
        

       <dd data-md="">
        <p>let the <a data-link-type="dfn" href="#hold-time">hold time</a> be <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
        
</dl>
</div>
     


    <li data-md="">
     <p>Let <var>current finished state</var> be true if the <a data-link-type="dfn" href="#play-state">play
state</a> of <var>player</var> is finished. Otherwise, let it be
false.</p>
     

    <li data-md="">
     <p>If <var>current finished state</var> is true and <a data-link-type="dfn" href="#previous-finished-state">previous
finished state</a> is false,
<a data-link-type="dfn" href="#resolve-a-promise">resolve</a> <var>player</var>’s <a data-link-type="dfn" href="#current-finished-promise">current
finished promise</a> object with <var>player</var>.</p>
     

    <li data-md="">
     <p>If <var>current finished state</var> is false and <a data-link-type="dfn" href="#previous-finished-state">previous
finished state</a> is true,
set <var>player</var>’s <a data-link-type="dfn" href="#current-finished-promise">current finished promise</a> to a new (pending)
Promise object.</p>
     

    <li data-md="">
     <p>Set <var>player</var>’s <a data-link-type="dfn" href="#previous-finished-state">previous finished state</a> to
<var>current finished state</var>.</p>
     

    <li data-md="">
     <p>Set the <a data-link-type="dfn" href="#previous-current-time">previous current time</a> of <var>player</var> be the
result of calculating its <a data-link-type="dfn" href="#current-time">current time</a>.</p>
     
</ol>

   <h4 class="heading settled" data-level="3.5.14" id="finishing-a-player-section"><span class="secno">3.5.14. </span><span class="content">Finishing a player</span><a class="self-link" href="#finishing-a-player-section"></a></h4>


   <p>A player can be advanced to the natural end of its current playback
direction by using the procedure to <dfn data-dfn-type="dfn" data-noexport="" id="finish-a-player">finish a player<a class="self-link" href="#finish-a-player"></a></dfn>
for <var>player</var> defined below:</p>



   <ol>
    <li data-md="">
     <p>If <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> is zero,
or if <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> > 0 and <a data-link-type="dfn" href="#source-content-end">source content end</a> is
infinity,
<a href="http://heycam.github.io/webidl/#dfn-throw">throw</a> an
InvalidStateError and abort these steps.</p>
     


    <li data-md="">
     <p>Set <var>limit</var> as follows:</p>
     


     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> > 0,</p>
       <p></p>

       <dd data-md="">
        <p>Let <var>limit</var> be <a data-link-type="dfn" href="#source-content-end">source content end</a>.</p>
       <p></p>


       <dt data-md="">
        <p>Otherwise,</p>

       <dd data-md="">
        <p>Let <var>limit</var> be zero.</p>
       <p></p>
</dl>
</div>
     


    <li data-md="">
     <p><a data-link-type="dfn" href="#set-the-current-time">Set the current time</a> to <var>limit</var>.</p>
     


     <div class="annotation">
    The procedure for setting the current time has the side effect of
    cancelling any <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a> so we don’t need to
    handle that here.
</div>
     


    <li data-md="">
     <p>If there is a <a data-link-type="dfn" href="#pending-play-task">pending play task</a>, cancel that task and
<a data-link-type="dfn" href="#resolve-a-promise">resolve</a> the <a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> of
<var>player</var> with <var>player</var>.</p>
     


    <li data-md="">
     <p>Run the procedure to <a data-link-type="dfn" href="#update-a-players-finished-state">update a player’s finished state</a>
for <var>player</var>.</p>
     
</ol>

   <p class="note" role="note">Note: Finishing a player does not necessarily cause that player
to enter the <a data-link-type="dfn" href="#finished-play-state">finished play state</a>. In particular, if a player was in the
<a data-link-type="dfn" href="#paused-play-state">paused play state</a> before finishing, it will remain in the
<a data-link-type="dfn" href="#paused-play-state">paused play state</a> afterwards.</p>


   <h4 class="heading settled" data-level="3.5.15" id="cancelling-a-player-section"><span class="secno">3.5.15. </span><span class="content">Cancelling a player</span><a class="self-link" href="#cancelling-a-player-section"></a></h4>


   <p>A player can be cancelled which causes the <a data-link-type="dfn" href="#current-time">current time</a> to
become <a data-link-type="dfn" href="#unresolved">unresolved</a> hence removing any effects caused by the
<a data-link-type="dfn" href="#source-content">source content</a>.</p>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="cancel-a-player">cancel a player<a class="self-link" href="#cancel-a-player"></a></dfn> for <var>player</var> is
as follows:</p>


   <ol>
    <li data-md="">
     <p>Run the procedure to <a data-link-type="dfn" href="#reset-a-players-pending-tasks">reset a player’s pending tasks</a> on
<var>player</var>.</p>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#reject-a-promise">Reject</a> the <a data-link-type="dfn" href="#current-finished-promise">current finished promise</a>
with a DOMException named "AbortError".</p>
     

    <li data-md="">
     <p>Let <a data-link-type="dfn" href="#current-finished-promise">current finished promise</a> be a new (pending) <a data-link-type="dfn" href="#promise">Promise</a>
object.</p>
     

    <li data-md="">
     <p>Make <var>player</var>’s <a data-link-type="dfn" href="#hold-time">hold time</a> <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     

    <li data-md="">
     <p>Make <var>player</var>’s <a data-link-type="dfn" href="#player-start-time">start time</a>
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     

    <li data-md="">
     <p>Queue a task to call any <a data-link-type="dfn" href="#custom-effect">custom effects</a> associated with
<a data-link-type="dfn" href="#inclusive-descendant">inclusive descendants</a> of
<var>player</var>’s <a data-link-type="dfn" href="#source-content">source content</a>
with an <a data-link-type="dfn" href="#unresolved">unresolved</a> time fraction.</p>
     

     <p class="issue" id="issue-8b479841"><a class="self-link" href="#issue-8b479841"></a>
  The procedures for calling custom effects needs to be reworked.
  Currently they probably involve calling too often for changes that could
  be coalesced.
</p>
     
</ol>

   <h4 class="heading settled" data-level="3.5.16" id="speed-control"><span class="secno">3.5.16. </span><span class="content">Speed control</span><a class="self-link" href="#speed-control"></a></h4>


   <div class="informative-bg">


    <p>The rate of play of a player can be controlled by setting its
<em>playback rate</em>.
For example, setting a playback rate of 2 will cause the player’s
<a data-link-type="dfn" href="#current-time">current time</a> to increase at twice the rate of its <a data-link-type="dfn" href="#timeline">timeline</a>.
Similarly, a playback rate of -1 will cause the player’s <a data-link-type="dfn" href="#current-time">current
time</a> to decrease at the same rate as the <a data-link-type="dfn" href="#time-value">time values</a> from
its <a data-link-type="dfn" href="#timeline">timeline</a> increase.</p>


    <p>Note that <a data-link-type="dfn" href="#animation-node">animation nodes</a> also have a <a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a> associated
with them that behaves differently to that defined here.</p>
</div>


   <p><a data-link-type="dfn" href="#player">Players</a> have a <dfn data-dfn-type="dfn" data-lt="player playback
rate" data-noexport="" id="player-playback-rate">playback rate<a class="self-link" href="#player-playback-rate"></a></dfn> that provides a scaling factor from the rate
of change of the associated <a data-link-type="dfn" href="#timeline">timeline</a>’s <a data-link-type="dfn" href="#time-value">time values</a> to
the player’s <a data-link-type="dfn" href="#current-time">current time</a>.
The <a data-link-type="dfn" href="#player-playback-rate">playback rate</a> is initially 1.</p>


   <p>Setting a player’s <a data-link-type="dfn" href="#player-playback-rate">playback rate</a>
to zero effectively pauses the player (however, the <a data-link-type="dfn" href="#play-state">play state</a>
does not necessarily become <a data-link-type="dfn" href="#paused-play-state">paused</a>).</p>


   <h5 class="heading settled" data-level="3.5.16.1" id="updating-the-playback-rate-of-a-player"><span class="secno">3.5.16.1. </span><span class="content">
Updating the playback rate of a player</span><a class="self-link" href="#updating-the-playback-rate-of-a-player"></a></h5>


   <p>Changes to the <a data-link-type="dfn" href="#player-playback-rate">playback rate</a>
trigger a compensatory seek so that that the player’s
<a data-link-type="dfn" href="#current-time">current time</a> is unaffected by the change to the playback
rate.</p>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="update-the-player-playback-rate">update the player playback rate<a class="self-link" href="#update-the-player-playback-rate"></a></dfn> of
a <a data-link-type="dfn" href="#player">player</a>, <var>player</var> to <var>new playback rate</var>
is as follows:</p>


   <ol>
    <li data-md="">
     <p>Let <var>previous time</var> be the value of the
<a data-link-type="dfn" href="#current-time">current time</a> of <var>player</var> before changing the
<a data-link-type="dfn" href="#player-playback-rate">playback rate</a>.</p>
     

    <li data-md="">
     <p>Set the <a data-link-type="dfn" href="#player-playback-rate">playback rate</a> to
<var>new playback rate</var>.</p>
     

    <li data-md="">
     <p>If <var>previous time</var> is <a data-link-type="dfn" href="#unresolved">resolved</a>,
<a data-link-type="dfn" href="#set-the-current-time">set the current time</a> of <var>player</var> to
<var>previous time</var>.</p>
     
</ol>

   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="silently-update-the-player-playback-rate">silently update the player playback rate<a class="self-link" href="#silently-update-the-player-playback-rate"></a></dfn>
of <a data-link-type="dfn" href="#player">player</a>, <var>player</var> to <var>new playback rate</var>
is identical to the above procedure except that rather than invoking
the procedure to <a data-link-type="dfn" href="#set-the-current-time">set the current time</a> in the final step, the
procedure to <a data-link-type="dfn" href="#silently-set-the-current-time">silently set the current time</a> is invoked instead.</p>


   <h4 class="heading settled" data-level="3.5.17" id="reversing-a-player-section"><span class="secno">3.5.17. </span><span class="content">Reversing a player</span><a class="self-link" href="#reversing-a-player-section"></a></h4>


   <p>The procedure to <dfn data-dfn-type="dfn" data-noexport="" id="reverse-a-player">reverse a player<a class="self-link" href="#reverse-a-player"></a></dfn> of <a data-link-type="dfn" href="#player">player</a>
<var>player</var> is as follows:</p>


   <ol>
    <li data-md="">
     <p>If there is no <a data-link-type="dfn" href="#timeline">timeline</a> associated with <var>player</var>, or the
associated <a data-link-type="dfn" href="#timeline">timeline</a> is <a data-link-type="dfn" href="#inactive-timeline">inactive</a>
<a href="http://heycam.github.io/webidl/#dfn-throw">throw</a> an
InvalidStateError and abort these steps.</p>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#silently-update-the-player-playback-rate">Silently update the player playback rate</a> of
<var>player</var> to <code>−<a data-link-type="dfn" href="#player-playback-rate">player playback rate</a></code>.</p>
     


     <div class="annotation">
    This must be done silently or else we may end up resolving
    the <a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> when we do the compensatory
    seek despite the fact that we are most likely not exiting the
    <a data-link-type="dfn" href="#pending-play-state">pending play state</a>.
</div>
     

    <li data-md="">
     <p>Run the steps to <a data-link-type="dfn" href="#play-a-player">play a player</a> for <var>player</var>.</p>
     
</ol>

   <h4 class="heading settled" data-level="3.5.18" id="player-state"><span class="secno">3.5.18. </span><span class="content">Player state</span><a class="self-link" href="#player-state"></a></h4>


   <p>A <a data-link-type="dfn" href="#player">player</a> may be described as being in one of the following
<dfn data-dfn-type="dfn" data-lt="play state" data-noexport="" id="play-state">play states<a class="self-link" href="#play-state"></a></dfn> for each of which, a 
non-normative description is also provided:</p>


   <div class="informative-bg">


    <dl>
     <dt data-md="">
      <p><dfn data-dfn-type="dfn" data-lt="idle play state" data-noexport="" id="idle-play-state">idle<a class="self-link" href="#idle-play-state"></a></dfn></p>
      

     <dd data-md="">
      <p>The <a data-link-type="dfn" href="#current-time">current time</a> of the player is <a data-link-type="dfn" href="#unresolved">unresolved</a> and
there are no pending tasks.
In this state the player has no effect.</p>
      

     <dt data-md="">
      <p><dfn data-dfn-type="dfn" data-lt="pending play state" data-noexport="" id="pending-play-state">pending<a class="self-link" href="#pending-play-state"></a></dfn></p>
      

     <dd data-md="">
      <p>The player is waiting on some pending task to complete.</p>
      

     <dt data-md="">
      <p><dfn data-dfn-type="dfn" data-lt="running play state" data-noexport="" id="running-play-state">running<a class="self-link" href="#running-play-state"></a></dfn></p>
      

     <dd data-md="">
      <p>The player has a resolved <a data-link-type="dfn" href="#current-time">current time</a> that changes on each
<a data-link-type="dfn" href="#sampling">sample</a> (provided the <a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> is not zero).</p>
      

     <dt data-md="">
      <p><dfn data-dfn-type="dfn" data-lt="paused play state" data-noexport="" id="paused-play-state">paused<a class="self-link" href="#paused-play-state"></a></dfn></p>
      

     <dd data-md="">
      <p>The player has been suspended and the <a data-link-type="dfn" href="#current-time">current time</a>
is no longer changing.</p>
      

     <dt data-md="">
      <p><dfn data-dfn-type="dfn" data-lt="finished play state" data-noexport="" id="finished-play-state">finished<a class="self-link" href="#finished-play-state"></a></dfn></p>
      

     <dd data-md="">
      <p>The player has reached the natural boundary of its playback range
and the <a data-link-type="dfn" href="#current-time">current time</a> is no longer updating.</p>
      
</dl>
</div>


   <p>The <a data-link-type="dfn" href="#play-state">play state</a> of <a data-link-type="dfn" href="#player">player</a>, <var>player</var>, at a given
moment is the state corresponding to the <em>first</em> matching
condition from the following:</p>


   <div class="switch">


    <dl>
     <dt data-md="">
      <p><var>player</var> has a <a data-link-type="dfn" href="#pending-play-task">pending play task</a> or a
<a data-link-type="dfn" href="#pending-pause-task">pending pause task</a>,</p>
      

     <dd data-md="">
      <p>→ <a data-link-type="dfn" href="#pending-play-state">pending</a></p>
      

     <dt data-md="">
      <p>The <a data-link-type="dfn" href="#current-time">current time</a> of <var>player</var> is
<a data-link-type="dfn" href="#unresolved">unresolved</a>,</p>
      

     <dd data-md="">
      <p>→ <a data-link-type="dfn" href="#idle-play-state">idle</a></p>
      

     <dt data-md="">
      <p>The <a data-link-type="dfn" href="#player-start-time">start time</a> of <var>player</var> is
<a data-link-type="dfn" href="#unresolved">unresolved</a>,</p>
      

     <dd data-md="">
      <p>→ <a data-link-type="dfn" href="#paused-play-state">paused</a></p>
      

     <dt data-md="">
      <p>For <var>player</var>,
<a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> > 0 and
<a data-link-type="dfn" href="#current-time">current time</a> ≥ <a data-link-type="dfn" href="#source-content-end">source content end</a>; or<br>
<a data-link-type="dfn" href="#player-playback-rate">player playback rate</a> &lt; 0 and
<a data-link-type="dfn" href="#current-time">current time</a> ≤ 0,</p>
      

     <dd data-md="">
      <p>→ <a data-link-type="dfn" href="#finished-play-state">finished</a></p>
      

     <dt data-md="">
      <p>Otherwise,</p>
      

     <dd data-md="">
      <p>→ <a data-link-type="dfn" href="#running-play-state">running</a></p>
      
</dl>
</div>


   <div class="note" role="note">


    <p>Note that the <a data-link-type="dfn" href="#paused-play-state">paused play state</a> effectively
“wins” over the <a data-link-type="dfn" href="#finished-play-state">finished play state</a>.</p>


    <p>However, a player that is paused outside of its natural playback range can
be converted from a <a data-link-type="dfn" href="#paused-play-state">paused</a>
player into a <a data-link-type="dfn" href="#finished-play-state">finished</a> player
without restarting by setting the <a data-link-type="dfn" href="#player-start-time">player start time</a> such as below:</p>


    <pre class="example lang-javascript">player.source.timing.duration = 5000;
player.currentTime = 4000;
player.pause();
player.ready.then(function() {
  player.source.timing.duration = 3000;
  alert(player.playState); // Displays 'paused'
  player.startTime =
    document.timeline.currentTime - player.currentTime * player.playbackRate;
  alert(player.playState); // Displays 'finished'
});</pre>

</div>


   <h3 class="heading settled" data-level="3.6" id="animation-nodes"><span class="secno">3.6. </span><span class="content">Animation nodes</span><a class="self-link" href="#animation-nodes"></a></h3>


   <p>An <dfn data-dfn-type="dfn" data-noexport="" id="animation-node">animation node<a class="self-link" href="#animation-node"></a></dfn> is an abstract term referring to an item in
the timing hierarchy.</p>


   <h4 class="heading settled" data-level="3.6.1" id="animation-nodes-and-players"><span class="secno">3.6.1. </span><span class="content">Relationship between animation nodes and players</span><a class="self-link" href="#animation-nodes-and-players"></a></h4>


   <p>The <a data-link-type="dfn" href="#source-content">source content</a> of a <a data-link-type="dfn" href="#player">player</a>, if set, is a type of
<a data-link-type="dfn" href="#animation-node">animation node</a>.
The <a data-link-type="dfn" href="#source-content">source content</a> of a <a data-link-type="dfn" href="#player">player</a> is said to be <dfn data-dfn-type="dfn" data-lt="directly associated with a player" data-noexport="" id="directly-associated-with-a-player">directly associated<a class="self-link" href="#directly-associated-with-a-player"></a></dfn>
with that player.</p>


   <p><a data-link-type="dfn" href="#animation-node">Animation nodes</a> can be combined together into a hierarchy using
<a data-link-type="dfn" href="#animation-group">animation groups</a> (see <a href="#grouping-and-synchronization">§3.13 Grouping and synchronization</a>).
Only the <a data-link-type="dfn" href="#root">root</a> <a data-link-type="dfn" href="#animation-node">animation node</a> of such a hierarchy can be
<a data-link-type="dfn" href="#directly-associated-with-a-player">directly associated with a player</a>.
If an <a data-link-type="dfn" href="#animation-node">animation node</a> that has a <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>
is designated as the <a data-link-type="dfn" href="#source-content">source content</a> of a <a data-link-type="dfn" href="#player">player</a>, the
<a data-link-type="dfn" href="#animation-node">animation node</a> is removed from its <a data-link-type="dfn" href="#parent-animation-group">parent animation
group</a> before being associated with the <a data-link-type="dfn" href="#player">player</a>.</p>


   <p>An <a data-link-type="dfn" href="#animation-node">animation node</a> is <dfn data-dfn-type="dfn" data-noexport="" id="associated-with-a-player">associated with a player<a class="self-link" href="#associated-with-a-player"></a></dfn> if it
is <a data-link-type="dfn" href="#directly-associated-with-a-player">directly associated with a player</a> or if it has an
<a data-link-type="dfn" href="#ancestor">ancestor</a> <a data-link-type="dfn" href="#animation-group">animation group</a> that is <a data-link-type="dfn" href="#directly-associated-with-a-player">directly associated
with a player</a>.At a given moment, an <a data-link-type="dfn" href="#animation-node">animation node</a> can be <a data-link-type="dfn" href="#associated-with-a-player">associated</a> with at most one
<a data-link-type="dfn" href="#player">player</a>.</p>


   <p>An <a data-link-type="dfn" href="#animation-node">animation node</a>, <var>node</var>, is <dfn data-dfn-type="dfn" data-noexport="" id="associated-with-a-timeline">associated with
a timeline<a class="self-link" href="#associated-with-a-timeline"></a></dfn>, <var>timeline</var>, if <var>node</var> is
<a data-link-type="dfn" href="#associated-with-a-player">associated with a player</a> which, in turn, is associated with
<var>timeline</var>.</p>


   <h4 class="heading settled" data-level="3.6.2" id="types-of-animation-nodes"><span class="secno">3.6.2. </span><span class="content">Types of animation nodes</span><a class="self-link" href="#types-of-animation-nodes"></a></h4>


   <p>This specification defines two types of <a data-link-type="dfn" href="#animation-node">animation nodes</a>:</p>


   <ul>
    <li data-md="">
     <p><a data-link-type="dfn" href="#concept-animation">animations</a>, and</p>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-group">animation groups</a>.</p>
     
</ul>

   <p>All types of <a data-link-type="dfn" href="#animation-node">animation nodes</a> define a number of common
properties which are described in the following sections.</p>


   <h4 class="heading settled" data-level="3.6.3" id="the-active-interval"><span class="secno">3.6.3. </span><span class="content">The active interval</span><a class="self-link" href="#the-active-interval"></a></h4>


   <div class="informative-bg">


    <p>The period that an <a data-link-type="dfn" href="#animation-node">animation node</a> is scheduled to run is
called its <a data-link-type="dfn" href="#active-interval">active interval</a>.
Each <a data-link-type="dfn" href="#animation-node">animation node</a> has only one such interval.</p>


    <p>The lower bound of the <a data-link-type="dfn" href="#active-interval">active interval</a> is determined by the
<a data-link-type="dfn" href="#animation-node-start-time">start time</a> of the
<a data-link-type="dfn" href="#animation-node">animation node</a> but may be shifted by a <a data-link-type="dfn" href="#start-delay">start delay</a> on
the <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>


    <p>The upper bound of the interval is determined by the <a data-link-type="dfn" href="#active-duration">active
duration</a>.</p>


    <p>The relationship between the <a data-link-type="dfn" href="#animation-node-start-time">start time</a>, <a data-link-type="dfn" href="#start-delay">start
delay</a>, and <a data-link-type="dfn" href="#active-duration">active duration</a> is illustrated below.</p>


    <div class="figure">
<img alt="Examples of the effect of the start delay on the endpoints
        of the active interval" src="img/active-interval-examples.svg" width="600">
</div>

    <p class="caption">
Examples of the effect of the <a data-link-type="dfn" href="#start-delay">start delay</a> on the endpoints of
the <a data-link-type="dfn" href="#active-interval">active interval</a>.<br>
(a) An animation node with no delay; the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> and beginning of
the <a data-link-type="dfn" href="#active-interval">active interval</a> are coincident.<br>
(b) An animation node with a positive delay; the beginning of the
<a data-link-type="dfn" href="#active-interval">active interval</a> is deferred by the delay.<br>
(c) An animation node with a negative delay; the beginning of the
<a data-link-type="dfn" href="#active-interval">active interval</a> is brought forward by the delay.
</p>


    <p>An <a data-link-type="dfn" href="#end-delay">end delay</a> may also be specified but is primarily only of
use when sequencinganimations such as by using an <a data-link-type="dfn" href="#animation-sequence">animation sequence</a>.</p>
</div>


   <p><a data-link-type="dfn" href="#animation-node">Animation nodes</a> define an <dfn data-dfn-type="dfn" data-noexport="" id="active-interval">active interval<a class="self-link" href="#active-interval"></a></dfn> which is
the period of time during which the node is scheduled to produce its
effect with the exception of <a data-link-type="dfn" href="#fill-mode">fill modes</a> which apply outside the
<a data-link-type="dfn" href="#active-interval">active interval</a>.</p>


   <p>The lower bound of the <a data-link-type="dfn" href="#active-interval">active interval</a> is defined by the
combination of the animation node’s
<a data-link-type="dfn" href="#animation-node-start-time">start time</a> and <a data-link-type="dfn" href="#start-delay">start delay</a>.</p>


   <p>An <a data-link-type="dfn" href="#animation-node">animation node</a>’s
<dfn data-dfn-type="dfn" data-lt="animation node start time" data-noexport="" id="animation-node-start-time">start time<a class="self-link" href="#animation-node-start-time"></a></dfn> is the moment at
which the <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>,
if any, has scheduled the <a data-link-type="dfn" href="#animation-node">animation node</a> to begin.
It is expressed in <a data-link-type="dfn" href="#inherited-time">inherited time</a>.</p>


   <p>In most cases, including the case when the <a data-link-type="dfn" href="#animation-node">animation node</a> has
no <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>,
the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> is zero.
The singular exception is <a data-link-type="dfn" href="#animation-sequence">animation sequences</a> which set
the <a data-link-type="dfn" href="#animation-node-start-time">start times</a> of their
children as described in <a href="#the-start-time-of-children-of-an-animation-sequence">§3.13.4.1 The start time of children of an animation sequence</a>.</p>


   <p>In addition to the <a data-link-type="dfn" href="#animation-node-start-time">start
time</a>, an <a data-link-type="dfn" href="#animation-node">animation node</a> also has a <dfn data-dfn-type="dfn" data-noexport="" id="start-delay">start delay<a class="self-link" href="#start-delay"></a></dfn>
which is an offset from the <a data-link-type="dfn" href="#animation-node-start-time">start time</a>.
Unlike the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> which
is determined by the <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>, the <a data-link-type="dfn" href="#start-delay">start
delay</a> is a property of the <a data-link-type="dfn" href="#animation-node">animation node</a> itself.
The lower bound of the <a data-link-type="dfn" href="#active-interval">active interval</a> of an <a data-link-type="dfn" href="#animation-node">animation
node</a>, expressed in <a data-link-type="dfn" href="#inherited-time">inherited time
space</a>, is the sum of the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> and the <a data-link-type="dfn" href="#start-delay">start
delay</a>.</p>


   <p>These definitions are incorporated in the calculation of the <a data-link-type="dfn" href="#local-time">local
time</a> (see <a href="#local-time-and-inherited-time">§3.6.4 Local time and inherited time</a>)
and <a data-link-type="dfn" href="#active-time">active time</a>.</p>


   <p>The length of the <a data-link-type="dfn" href="#active-interval">active interval</a> is called the <a data-link-type="dfn" href="#active-duration">active
duration</a>, the calculation of which is defined in <a href="#calculating-the-active-duration">§3.10.2 Calculating the active duration</a>.</p>


   <p>Similar to the <a data-link-type="dfn" href="#start-delay">start delay</a>, an <a data-link-type="dfn" href="#animation-node">animation node</a> also has
an <dfn data-dfn-type="dfn" data-noexport="" id="end-delay">end delay<a class="self-link" href="#end-delay"></a></dfn> which may be used to delay the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of the <a data-link-type="dfn" href="#next-sibling">next
sibling</a> in a <a data-link-type="dfn" href="#animation-sequence">animation sequence</a>.</p>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="end-time">end time<a class="self-link" href="#end-time"></a></dfn> of an <a data-link-type="dfn" href="#animation-node">animation node</a> is simply the sum of its <a data-link-type="dfn" href="#animation-node-start-time">start time</a>, <a data-link-type="dfn" href="#start-delay">start delay</a>, <a data-link-type="dfn" href="#active-duration">active
duration</a>, and <a data-link-type="dfn" href="#end-delay">end delay</a>.</p>


   <h4 class="heading settled" data-level="3.6.4" id="local-time-and-inherited-time"><span class="secno">3.6.4. </span><span class="content">Local time and inherited time</span><a class="self-link" href="#local-time-and-inherited-time"></a></h4>


   <div class="informative-bg">


    <p>In Web Animations all times are relative to some point of reference.
These different points of reference produce different <em>time
spaces</em>.</p>


    <p>This can be compared to coordinate spaces as used in computer
graphics.
The zero time of a time space is analogous to the origin of
a coordinate space.</p>


    <p>Just as with coordinate spaces, time spaces can also be nested.
<a data-link-type="dfn" href="#animation-group">Animation groups</a> typically perform some
transformations on the <a data-link-type="dfn" href="#time-value">time values</a> they
receive from their <a data-link-type="dfn" href="#parent-animation-group">parent</a> or
<a data-link-type="dfn" href="#player">player</a> before passing on the transformed <a data-link-type="dfn" href="#time-value">time values</a>
to their children.
Child <a data-link-type="dfn" href="#animation-node">animation nodes</a> then operate <em>within</em> that
transformed time space.</p>


    <p>Children take the transformed time values from their
parent—called the <a data-link-type="dfn" href="#inherited-time">inherited time</a>—and add their
<a data-link-type="dfn" href="#animation-node-start-time">start time</a> to establish
their own <a data-link-type="dfn" href="#local-time">local time space</a> as illustrated
below.</p>

    <div class="figure">
<img alt="Inherited time and local time." src="img/local-time.svg" width="600">
</div>

    <p class="caption">
Inherited time and local time.<br>
At time <var>t</var>, the <a data-link-type="dfn" href="#inherited-time">inherited time</a> is 2.5.<br>
For <a data-link-type="dfn" href="#animation-node">animation node</a> (a) which has a <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of 1, the
  <a data-link-type="dfn" href="#local-time">local time</a> is 1.5.<br>
For <a data-link-type="dfn" href="#animation-node">animation node</a> (b) which has a <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of 1
  and a <a data-link-type="dfn" href="#start-delay">start delay</a> of 1,
  the <a data-link-type="dfn" href="#local-time">local time</a> is also 1.5
  since <a data-link-type="dfn" href="#local-time">local time</a> is based on an <a data-link-type="dfn" href="#animation-node">animation node</a>’s
  <a data-link-type="dfn" href="#animation-node-start-time">start time</a> only,
  and not on its <a data-link-type="dfn" href="#start-delay">start delay</a>.
</p>

</div>


   <p>For an <a data-link-type="dfn" href="#animation-node">animation node</a>, the <dfn data-dfn-type="dfn" data-noexport="" id="inherited-time">inherited time<a class="self-link" href="#inherited-time"></a></dfn> at
a given moment is based on the first matching condition from the
following:</p>


   <div class="switch">


    <dl>
     <dt data-md="">
      <p>If the <a data-link-type="dfn" href="#animation-node">animation node</a> has a <a data-link-type="dfn" href="#parent-animation-group">parent animation
group</a>,</p>
      

     <dd data-md="">
      <p>the inherited time is the <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>’s current
<a data-link-type="dfn" href="#transformed-time">transformed time</a>.</p>
      

     <dt data-md="">
      <p>If the <a data-link-type="dfn" href="#animation-node">animation node</a> is <a data-link-type="dfn" href="#directly-associated-with-a-player">directly associated with
a player</a>,</p>
      

     <dd data-md="">
      <p>the inherited time is the <a data-link-type="dfn" href="#current-time">current time</a> of the
<a data-link-type="dfn" href="#player">player</a>.</p>
      

     <dt data-md="">
      <p>Otherwise,</p>
      

     <dd data-md="">
      <p>the inherited time is <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
      
</dl>
</div>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="local-time">local time<a class="self-link" href="#local-time"></a></dfn> of an <a data-link-type="dfn" href="#animation-node">animation node</a> is the
<a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#inherited-time">inherited time</a> minus its <a data-link-type="dfn" href="#animation-node-start-time">start time</a>.
If the <a data-link-type="dfn" href="#inherited-time">inherited time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a> then the local time
is also <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>


   <h4 class="heading settled" data-level="3.6.5" id="animation-node-phases-and-states"><span class="secno">3.6.5. </span><span class="content">Animation node phases and states</span><a class="self-link" href="#animation-node-phases-and-states"></a></h4>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>At a given moment, an <a data-link-type="dfn" href="#animation-node">animation node</a> may be in one of three
possible <em>phases</em>.
If an <a data-link-type="dfn" href="#animation-node">animation node</a> has an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#local-time">local
time</a> it will not be in any phase.</p>


    <p>The different phases are illustrated below.</p>


    <div class="figure">
<img alt="An example of the different phases and states used to
         describe an animation node." src="img/animation-node-phases-and-states.svg" width="700">
</div>

    <p class="caption">
An example of the different phases and states used to describe
an <a data-link-type="dfn" href="#animation-node">animation node</a>.
</p>


    <p>The phases are as follows:</p>


    <dl>
     <dt data-md="">
      <p><a data-link-type="dfn" href="#before-phase">before phase</a></p>
      

     <dd data-md="">
      <p>The <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#local-time">local time</a> falls before the
node’s <a data-link-type="dfn" href="#active-interval">active interval</a>.</p>
      

     <dt data-md="">
      <p><a data-link-type="dfn" href="#active-phase">active phase</a></p>
      

     <dd data-md="">
      <p>The <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#local-time">local time</a> falls inside the
node’s <a data-link-type="dfn" href="#active-interval">active interval</a>.</p>
      

     <dt data-md="">
      <p><a data-link-type="dfn" href="#after-phase">after phase</a></p>
      

     <dd data-md="">
      <p>The <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#local-time">local time</a> falls after the
node’s <a data-link-type="dfn" href="#active-interval">active interval</a>.</p>
      
</dl>

    <p>In addition to these phases, an <a data-link-type="dfn" href="#animation-node">animation node</a> may also be
described as being in one of several overlapping <em>states</em>.
These states are only established for the duration of a single
sample and are primarily a convenience for describing stative parts
of the model.</p>


    <p>These states and their useage within the model are summarised as
follows:</p>


    <dl>
     <dt data-md="">
      <p><a data-link-type="dfn" href="#in-play">in play</a></p>
      

     <dd data-md="">
      <p>Corresponds to an <a data-link-type="dfn" href="#animation-node">animation node</a> whose <a data-link-type="dfn" href="#active-time">active time</a>
is changing on each sample.
This occurs when the <a data-link-type="dfn" href="#animation-node">animation node</a> <em>and all its
ancestors</em> are in the <a data-link-type="dfn" href="#active-phase">active phase</a>.
<a data-link-type="dfn" href="#concept-animation">Animations</a> only “move” when
they are <a data-link-type="dfn" href="#in-play">in play</a>.</p>
      


      <p>It is possible for an <a data-link-type="dfn" href="#animation-node">animation node</a> to be in the
<a data-link-type="dfn" href="#active-phase">active phase</a> but not <a data-link-type="dfn" href="#in-play">in play</a>.
For example, if an <a data-link-type="dfn" href="#animation-node">animation node</a> has a <a data-link-type="dfn" href="#parent-animation-group">parent
animation group</a> that causes the animation node’s <a data-link-type="dfn" href="#active-interval">active
interval</a> to be clipped and both parent and child apply the
same <a data-link-type="dfn" href="#fill-mode">fill mode</a>, the child <a data-link-type="dfn" href="#animation-node">animation node</a> may be
effectively be snapshotted within the <a data-link-type="dfn" href="#active-phase">active phase</a>
despite no longer being <a data-link-type="dfn" href="#in-play">in play</a>.</p>
      

     <dt data-md="">
      <p><a data-link-type="dfn" href="#current">current</a></p>
      

     <dd data-md="">
      <p>Corresponds to an <a data-link-type="dfn" href="#animation-node">animation node</a> that is either <a data-link-type="dfn" href="#in-play">in
play</a> or may become <a data-link-type="dfn" href="#in-play">in play</a> in the future.
This will be the case if the <a data-link-type="dfn" href="#animation-node">animation node</a> is <a data-link-type="dfn" href="#in-play">in
play</a> or in its <a data-link-type="dfn" href="#before-phase">before phase</a>, <em>or</em> it has an
ancestor for which this is true thereby opening up the
possibility that this <a data-link-type="dfn" href="#animation-node">animation node</a> might play again
(e.g. due to repeating).</p>
      


     <dt data-md="">
      <p><a data-link-type="dfn" href="#in-effect">in effect</a></p>
      

     <dd data-md="">
      <p>Corresponds to an <a data-link-type="dfn" href="#animation-node">animation node</a> that has a resolved
<a data-link-type="dfn" href="#active-time">active time</a>.
This occurs when either the <a data-link-type="dfn" href="#animation-node">animation node</a> is in its
<a data-link-type="dfn" href="#active-phase">active phase</a> or outside the <a data-link-type="dfn" href="#active-interval">active interval</a> but at
a time where the node’s <a data-link-type="dfn" href="#fill-mode">fill mode</a> (see <a href="#fill-behavior">§3.7 Fill behavior</a>) causes its
<a data-link-type="dfn" href="#active-time">active time</a> to be resolved.
Only <a data-link-type="dfn" href="#in-effect">in effect</a> <a data-link-type="dfn" href="#concept-animation">animations</a> apply
a result to their target.</p>
      
</dl>

    <p>The normative definition of each of these states follows.</p>

</div>


   <p>An <a data-link-type="dfn" href="#animation-node">animation node</a> is in the <dfn data-dfn-type="dfn" data-noexport="" id="before-phase">before phase<a class="self-link" href="#before-phase"></a></dfn> if the
animation node’s <a data-link-type="dfn" href="#local-time">local time</a> is not <a data-link-type="dfn" href="#unresolved">unresolved</a> and is
less than the node’s <a data-link-type="dfn" href="#start-delay">start delay</a>.</p>


   <p>An <a data-link-type="dfn" href="#animation-node">animation node</a> is in the <dfn data-dfn-type="dfn" data-noexport="" id="active-phase">active phase<a class="self-link" href="#active-phase"></a></dfn> if
<em>all</em> of the following conditions are met:</p>


   <ol>
    <li data-md="">
     <p>the <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#local-time">local time</a> is not
<a data-link-type="dfn" href="#unresolved">unresolved</a>, and</p>
     

    <li data-md="">
     <p>the <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#local-time">local time</a> is <em>greater than
or equal</em> to its <a data-link-type="dfn" href="#start-delay">start delay</a>, and</p>
     

    <li data-md="">
     <p>the <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#local-time">local time</a> is <em>less
than</em> the sum of its <a data-link-type="dfn" href="#start-delay">start delay</a> and <a data-link-type="dfn" href="#active-duration">active
duration</a>.</p>
     
</ol>

   <p>An <a data-link-type="dfn" href="#animation-node">animation node</a> is in the <dfn data-dfn-type="dfn" data-noexport="" id="after-phase">after phase<a class="self-link" href="#after-phase"></a></dfn> if the
animation node’s <a data-link-type="dfn" href="#local-time">local time</a> is not <a data-link-type="dfn" href="#unresolved">unresolved</a> and is
<em>greater than or equal</em> to the sum of its <a data-link-type="dfn" href="#start-delay">start delay</a>
and <a data-link-type="dfn" href="#active-duration">active duration</a>.</p>


   <p>An <a data-link-type="dfn" href="#animation-node">animation node</a> is <dfn data-dfn-type="dfn" data-noexport="" id="in-play">in play<a class="self-link" href="#in-play"></a></dfn> if <em>all</em>
of the following conditions are met:</p>


   <ol>
    <li data-md="">
     <p>the <a data-link-type="dfn" href="#animation-node">animation node</a> is in the <a data-link-type="dfn" href="#active-phase">active phase</a>, and</p>
     

    <li data-md="">
     <p>the <a data-link-type="dfn" href="#animation-node">animation node</a> has a <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a> that
is <a data-link-type="dfn" href="#in-play">in play</a> or else the <a data-link-type="dfn" href="#animation-node">animation node</a> is
<a data-link-type="dfn" href="#directly-associated-with-a-player">directly associated with a player</a> that is not <a data-link-type="dfn" href="#finished-play-state">finished</a>.</p>
     
</ol>

   <p>An animation node is <dfn data-dfn-type="dfn" data-noexport="" id="current">current<a class="self-link" href="#current"></a></dfn> if
<em>any</em>of the following conditions is true:</p>


   <ul>
    <li data-md="">
     <p>it is in the <a data-link-type="dfn" href="#before-phase">before phase</a>, or</p>
     

    <li data-md="">
     <p>it is <a data-link-type="dfn" href="#in-play">in play</a>, or</p>
     

    <li data-md="">
     <p>it has a <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a> and the
<a data-link-type="dfn" href="#parent-animation-group">parent animation group</a> is <a data-link-type="dfn" href="#current">current</a>.</p>
     
</ul>

   <p>An animation node is <dfn data-dfn-type="dfn" data-noexport="" id="in-effect">in effect<a class="self-link" href="#in-effect"></a></dfn> if its <a data-link-type="dfn" href="#active-time">active time</a> as
calculated according to the procedure in <a href="#calculating-the-active-time">§3.10.3.1 Calculating the active time</a> is not
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>


   <h3 class="heading settled" data-level="3.7" id="fill-behavior"><span class="secno">3.7. </span><span class="content">Fill behavior</span><a class="self-link" href="#fill-behavior"></a></h3>


   <p>The effect of an <a data-link-type="dfn" href="#animation-node">animation node</a> when it is not <a data-link-type="dfn" href="#in-play">in play</a> is
determined by its <dfn data-dfn-type="dfn" data-noexport="" id="fill-mode">fill mode<a class="self-link" href="#fill-mode"></a></dfn>.</p>


   <p>The possible <a data-link-type="dfn" href="#fill-mode">fill modes</a> are:</p>


   <ul>
    <li data-md="">
     <p>none,</p>
     

    <li data-md="">
     <p>forwards,</p>
     

    <li data-md="">
     <p>backwards, and</p>
     

    <li data-md="">
     <p>both.</p>
     
</ul>

   <p>The normative definition of these modes is incorporated in the
calculation of the <a data-link-type="dfn" href="#active-time">active time</a> in <a href="#calculating-the-active-time">§3.10.3.1 Calculating the active time</a>.</p>


   <h4 class="heading settled" data-level="3.7.1" id="fill-modes"><span class="secno">3.7.1. </span><span class="content">Fill modes</span><a class="self-link" href="#fill-modes"></a></h4>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>The effect of each <a data-link-type="dfn" href="#fill-mode">fill mode</a> is as follows:</p>


    <dl>
     <dt data-md="">
      <p>none</p>
      

     <dd data-md="">
      <p>The animation node has no effect when it is not <a data-link-type="dfn" href="#in-play">in play</a>.</p>
      

     <dt data-md="">
      <p>forwards</p>
     <p></p>

     <dd data-md="">
      <p>When the animation node is in the <a data-link-type="dfn" href="#after-phase">after phase</a>,
or when the animation node is in the <a data-link-type="dfn" href="#active-phase">active phase</a> but an
<a data-link-type="dfn" href="#ancestor">ancestor</a> is in its <a data-link-type="dfn" href="#after-phase">after phase</a>,
the animation node will produce the same <a data-link-type="dfn" href="#transformed-time">transformed time value</a> as the last
moment it is scheduled to be <a data-link-type="dfn" href="#in-play">in play</a>.</p>


      <p>For all other times that the animation node is not <a data-link-type="dfn" href="#in-play">in play</a>,
it will have no effect.</p>

     <dt data-md="">
      <p>backwards</p>

     <dd data-md="">
      <p>When the animation node is in the <a data-link-type="dfn" href="#before-phase">before phase</a>,
or when the animation node is in the <a data-link-type="dfn" href="#active-phase">active phase</a> but an
<a data-link-type="dfn" href="#ancestor">ancestor</a> is in its <a data-link-type="dfn" href="#before-phase">before phase</a>,
the animation node will produce the same <a data-link-type="dfn" href="#transformed-time">transformed time value</a> as the earliest
moment that it is scheduled to be <a data-link-type="dfn" href="#in-play">in play</a>.</p>


      <p>For all other times that the animation node is not <a data-link-type="dfn" href="#in-play">in play</a>,
it will have no effect.</p>

     <dt data-md="">
      <p>both</p>
     <p></p>

     <dd data-md="">
      <p>When the animation node
or an <a data-link-type="dfn" href="#ancestor">ancestor</a> is in its <a data-link-type="dfn" href="#before-phase">before phase</a>,
<span class="prop-value">backwards</span> fill behavior is used.</p>


      <p>When the animation node
or an <a data-link-type="dfn" href="#ancestor">ancestor</a> is in its <a data-link-type="dfn" href="#after-phase">after phase</a>,
<span class="prop-value">forwards</span> fill behavior is used.</p>
</dl>

    <p>Some examples of the these fill modes are illustrated below.</p>


    <div class="figure">
  <img alt="Examples of various fill modes and the states produced." src="img/animation-state-and-fill-behavior.svg" width="600">
</div>

    <p class="caption">
  Examples of various fill modes and the states produced.<br>
  (a) fill mode ‘none’. The animation node has no effect
      outside its active interval.<br>
  (b) fill mode ‘forwards’. After the active interval has
      finished, the timed value continues to maintain a fill value.<br>
  (c) fill mode ‘backwards’. The animation node produces
      a fill value until the start of the active interval.<br>
  (d) fill mode ‘both’. Both before and after the active
      interval the animation node produces a fill value.
</p>


    <p class="note" role="note">Note: setting a fill mode has no bearing on the endpoints of the
    <a data-link-type="dfn" href="#active-interval">active interval</a>.
    However, the fill mode <em>does</em> have an effect on various other
    properties of the timing model since the <a data-link-type="dfn" href="#active-time">active time</a> of an
    animation node is only defined (that is, not <a data-link-type="dfn" href="#unresolved">unresolved</a>) inside
    the <a data-link-type="dfn" href="#active-interval">active interval</a> <em>or</em> when a fill is applied.</p>


    <div class="issue" id="issue-8c26106d"><a class="self-link" href="#issue-8c26106d"></a>
Currently <a data-link-type="dfn" href="#timing-function">timing functions</a> that generate results outside the
range [0, 1] will behave unexpectedly when applied to animation
groups, as children will increase iterations or enter into fill mode
rather than continuing to extrapolate along their defined behavior
(which is what they would do if the timing function applied to them
directly).


     <p>To fix this it is possible we will wish to introduce <a class="property" data-link-type="propdesc" href="http://dev.w3.org/csswg/css-overflow-3/#propdef-overflow">overflow</a> fill
modes that respond to time values larger than or smaller than the
active time range by extrapolating rather than filling.</p>


     <p>See <a href="http://lists.w3.org/Archives/Public/public-fx/2013AprJun/0184.html">section
15 (Overflowing fill) of minuted discussion from Tokyo 2013 F2F</a>.</p>
</div>

</div>


   <h3 class="heading settled" data-level="3.8" id="repeating"><span class="secno">3.8. </span><span class="content">Repeating</span><a class="self-link" href="#repeating"></a></h3>


   <h4 class="heading settled" data-level="3.8.1" id="iteration-intervals"><span class="secno">3.8.1. </span><span class="content">Iteration intervals</span><a class="self-link" href="#iteration-intervals"></a></h4>


   <p>It is possible to specify that an animation node should repeat
a fixed number of times or indefinitely.
This repetition occurs <em>within</em> the <a data-link-type="dfn" href="#active-interval">active interval</a>.
The span of time during which a single repetition takes place is
called an <dfn data-dfn-type="dfn" data-noexport="" id="iteration-interval">iteration interval<a class="self-link" href="#iteration-interval"></a></dfn>.</p>


   <p>Unlike the <a data-link-type="dfn" href="#active-interval">active interval</a>, an animation node can have multiple
<a data-link-type="dfn" href="#iteration-interval">iteration intervals</a> although typically only the interval
corresponding to the <a data-link-type="dfn" href="#current-iteration">current iteration</a> is of interest.</p>


   <p>The length of a single iteration is called the <dfn data-dfn-type="dfn" data-noexport="" id="iteration-duration">iteration
duration<a class="self-link" href="#iteration-duration"></a></dfn>.
The initial <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> of an animation node is simply
its <a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration duration</a>.</p>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="intrinsic-iteration-duration">intrinsic iteration duration<a class="self-link" href="#intrinsic-iteration-duration"></a></dfn> of an animation node is
zero, however some specific types of animation node such as
<a data-link-type="dfn" href="#animation-group">animation groups</a> override this behavior and provide an
alternative intrinsic duration (see <a href="#the-intrinsic-iteration-duration-of-an-animation-group">§3.13.3 The intrinsic iteration duration of an animation group</a> and <a href="#the-intrinsic-iteration-duration-of-an-animation-sequence">§3.13.4.2 The intrinsic iteration duration of an animation sequence</a>).
The <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> of an <a data-link-type="dfn" href="#animation-node">animation node</a> may be set
by the author to represent a value other than the <a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic
iteration duration</a>.</p>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>Comparing the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> and the <a data-link-type="dfn" href="#active-duration">active
duration</a> we have:</p>


    <dl>
     <dt data-md="">
      <p>Iteration duration</p>
      

     <dd data-md="">
      <p>The time taken for a single iteration of the animation node to
complete.</p>
      

     <dt data-md="">
      <p>Active duration</p>
      

     <dd data-md="">
      <p>The time taken for the entire animation node to complete,
including repetitions.
This may be longer or shorter than the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a>.</p>
      
</dl>

    <p>The relationship between the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> and <a data-link-type="dfn" href="#active-duration">active
duration</a> is illustrated below.</p>


    <div class="figure">
  <img alt="Comparison of the iteration duration and active time." src="img/iteration-intervals.svg" width="600">
</div>

    <p class="caption">
  A comparison of the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> and <a data-link-type="dfn" href="#active-duration">active
  duration</a> of an animation node with an <a data-link-type="dfn" href="#iteration-count">iteration count</a> of
  2.5.
  Note that the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> for the final iteration does
  not change, it is simply cut-off by the <a data-link-type="dfn" href="#active-duration">active duration</a>.
</p>

</div>


   <h4 class="heading settled" data-level="3.8.2" id="controlling-iteration"><span class="secno">3.8.2. </span><span class="content">Controlling iteration</span><a class="self-link" href="#controlling-iteration"></a></h4>


   <p>The number of times an <a data-link-type="dfn" href="#animation-node">animation node</a> repeats is called its
<dfn data-dfn-type="dfn" data-noexport="" id="iteration-count">iteration count<a class="self-link" href="#iteration-count"></a></dfn>.
The <a data-link-type="dfn" href="#iteration-count">iteration count</a> is a real number greater than or equal to
zero.
The <a data-link-type="dfn" href="#iteration-count">iteration count</a> may also be positive infinity to represent
that the <a data-link-type="dfn" href="#animation-node">animation node</a> repeats indefinitely.</p>


   <p>In addition to the <a data-link-type="dfn" href="#iteration-count">iteration count</a>, <a data-link-type="dfn" href="#animation-node">animation nodes</a> also
have an <dfn data-dfn-type="dfn" data-noexport="" id="iteration-start">iteration start<a class="self-link" href="#iteration-start"></a></dfn> property which specifies an offset
into the series of iterations at which the <a data-link-type="dfn" href="#animation-node">animation node</a>
should begin.
The <a data-link-type="dfn" href="#iteration-start">iteration start</a> is a finite real number greater than or
equal to zero.</p>


   <p>The behavior of these parameters is defined in the calculations in <a href="#core-animation-node-calculations">§3.10 Core animation node calculations</a>.</p>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>The effect of the <a data-link-type="dfn" href="#iteration-count">iteration count</a> and <a data-link-type="dfn" href="#iteration-start">iteration start</a>
parameters is illustrated below.</p>


    <div class="figure">
  <img alt="The effect of the iteration count and iteration start parameters" src="img/iteration-count-and-start.svg" width="600">
</div>

    <p class="caption">
  The effect of the <a data-link-type="dfn" href="#iteration-count">iteration count</a> and <a data-link-type="dfn" href="#iteration-start">iteration start</a>
  parameters.<br>
  In the first case the <a data-link-type="dfn" href="#iteration-count">iteration count</a> is 2.5 resulting in the
  third iteration being cut-off half way through its <a data-link-type="dfn" href="#iteration-interval">iteration
  interval</a>.<br>
  The second case is the same but with an <a data-link-type="dfn" href="#iteration-start">iteration start</a> of
  0.5.
  This causes the <a data-link-type="dfn" href="#animation-node">animation node</a> to begin half way through the
  first iteration.
</p>


    <p>Unlike the <a data-link-type="dfn" href="#iteration-count">iteration count</a> parameter, the <a data-link-type="dfn" href="#iteration-start">iteration
start</a> parameter does not effect the length of the <a data-link-type="dfn" href="#active-duration">active
duration</a>.</p>


    <p>Note that values of <a data-link-type="dfn" href="#iteration-start">iteration start</a> greater than or equal to
one are generally not useful unless used in combination with an
<a data-link-type="dfn" href="#animation-effect">animation effect</a> that has an <a data-link-type="dfn" href="#iteration-composite-operation">iteration composite
operation</a> of
<a data-link-type="dfn" href="#iteration-composite-operation-accumulate">accumulate</a>.</p>

</div>


   <h4 class="heading settled" data-level="3.8.3" id="iteration-time-space"><span class="secno">3.8.3. </span><span class="content">Iteration time space</span><a class="self-link" href="#iteration-time-space"></a></h4>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>We have already encountered different time spaces in describing
<a data-link-type="dfn" href="#local-time">local time</a> and <a data-link-type="dfn" href="#inherited-time">inherited time</a> (see <a href="#local-time-and-inherited-time">§3.6.4 Local time and inherited time</a>).
Repetition introduces yet another time space: the iteration time
space.</p>



    <p><em>Iteration time space</em> is a time space whose zero time is the
beginning of an animation node’s current iteration.</p>



    <p>Within the Web Animations model we also refer to <a data-link-type="dfn" href="#active-time">active
time</a> which is a time relative to the beginning of the active
interval.
This time space, however, is internal to the model and not exposed in
the programming interface or in markup.</p>



    <p>These time spaces are illustrated below.</p>


    <div class="figure">
  <img alt="A comparison of local time, active time, and iteration time." src="img/time-spaces.svg" width="600">
</div>

    <p class="caption">
A comparison of local time, active time, and iteration time for an
animation with a iteration duration of 1s and an iteration count of
2.5.
</p>


    <p class="note" role="note">Note: While the time spaces themselves are not bounded, Web
    Animations defines <a data-link-type="dfn" href="#active-time">active time</a> and <a data-link-type="dfn" href="#iteration-time">iteration
    time</a> such that they are clamped to a set range as shown in the
    diagram.
    For example, whilst a time of -1 second is a valid time in
    <em>active time space</em>, the procedure for calculating the
    <a data-link-type="dfn" href="#active-time">active time</a> defined in <a href="#calculating-the-active-time">§3.10.3.1 Calculating the active time</a> will
    never return a negative value.</p>


    <p>In addition to these time spaces we can also refer to the
<em>document time space</em> which is time space of the <a data-link-type="dfn" href="#time-value">time
values</a> of the <a data-link-type="dfn" href="#document-timeline">document timeline</a> of the <a href="http://www.w3.org/TR/html5/browsers.html#active-document">active
document</a>.</p>

</div>


   <h4 class="heading settled" data-level="3.8.4" id="interval-timing"><span class="secno">3.8.4. </span><span class="content">Interval timing</span><a class="self-link" href="#interval-timing"></a></h4>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>When an animation node repeats we must define the behavior at the
iteration boundaries.
For this and indeed for all interval-timing, Web Animations uses an
endpoint-exclusive timing model.
This means that whilst the begin time of an interval
is included in the interval, the end time time is not.
In interval notation this can written <code>[begin, end)</code>.
This model provides sensible behavior when intervals are repeated and
sequenced since there is no overlap between the intervals.</p>



    <p>In the examples below, for the repeated node, at local time 1s,
the iteration time is 0.
For the sequenced nodes, at inherited time 1s, only node B will be
<a data-link-type="dfn" href="#in-play">in play</a>; there is no overlap.</p>


    <div class="figure">
  <img alt="Illustration of end-point exclusive timing." src="img/endpoint-exclusive-timing.svg" width="600">
</div>

    <p class="caption">
  Illustration of end-point exclusive timing. For both repeated and
  sequenced animation nodes there is no overlap at the boundaries
  between intervals.
</p>


    <p>An exception to this behavior is that when performing a <a href="#fill-behavior">fill</a>, if the fill begins at an
interval endpoint, the endpoint is used.
This behavior falls out of the algorithm given in <a href="#calculating-the-iteration-time">§3.10.3.3 Calculating the iteration time</a> and is illustrated below.</p>


    <div class="figure">
  <img alt="Effect of iterations and fill on iteration time." src="img/endpoint-exclusive-timing-and-fill.svg" width="600">
</div>

    <p class="caption">
  After one iteration, the iteration time is 0, but after two iterations
  (and thereonwards), the iteration time is equal to the iteration
  duration due to the special behavior defined when an animation node
  fills.
</p>

</div>


   <h3 class="heading settled" data-level="3.9" id="animation-node-speed-control"><span class="secno">3.9. </span><span class="content">Animation node speed control</span><a class="self-link" href="#animation-node-speed-control"></a></h3>


   <p>Like <a data-link-type="dfn" href="#player">players</a>, <a data-link-type="dfn" href="#animation-node">animation nodes</a> also have a <dfn data-dfn-type="dfn" data-lt="animation node playback rate" data-noexport="" id="animation-node-playback-rate">playback rate<a class="self-link" href="#animation-node-playback-rate"></a></dfn> parameter.
The <a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a> of
an <a data-link-type="dfn" href="#animation-node">animation node</a> is a finite real number that acts as
a multiplier when calculating the <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#transformed-time">transformed
time</a> from its <a data-link-type="dfn" href="#local-time">local time</a>.</p>


   <p>The effect of setting the <a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a> of an <a data-link-type="dfn" href="#animation-node">animation node</a> differs from the
setting the <a data-link-type="dfn" href="#player-playback-rate">playback rate</a> on
a player.  Its behavior is defined in the timing calculations given in
<a href="#core-animation-node-calculations">§3.10 Core animation node calculations</a>.</p>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>In summary, the behavior of the <a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a> of an <a data-link-type="dfn" href="#animation-node">animation node</a> is as follows:</p>


    <ul>
     <li data-md="">
      <p>The <a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a> is
applied only to the <a data-link-type="dfn" href="#active-interval">active interval</a> of an <a data-link-type="dfn" href="#animation-node">animation
node</a> and not to the time while it is <a data-link-type="dfn" href="#start-delay">delayed</a> or <a data-link-type="dfn" href="#fill-mode">filling</a>.</p>
      


     <li data-md="">
      <p>Setting a negative <a data-link-type="dfn" href="#animation-node-playback-rate">playback
rate</a> on an <a data-link-type="dfn" href="#animation-node">animation node</a> causes the <a data-link-type="dfn" href="#animation-node">animation
node</a> to begin at the end of its <a data-link-type="dfn" href="#active-interval">active interval</a>.
This differs from the <a data-link-type="dfn" href="#player-playback-rate">playback
rate</a> on a <a data-link-type="dfn" href="#player">player</a>.
Setting a <a data-link-type="dfn" href="#player-playback-rate">playback rate</a> on
a <a data-link-type="dfn" href="#player">player</a> to a negative value at a moment before the
<a data-link-type="dfn" href="#player">player</a>’s source content has begun, will result in the
<a data-link-type="dfn" href="#source-content">source content</a> never playing.</p>
      


     <li data-md="">
      <p>Setting the <a data-link-type="dfn" href="#animation-node-playback-rate">playback
rate</a> of an <a data-link-type="dfn" href="#animation-node">animation node</a> affects the calculated value of
the <a data-link-type="dfn" href="#active-duration">active duration</a> (see <a href="#calculating-the-active-duration">§3.10.2 Calculating the active duration</a>).</p>
      


     <li data-md="">
      <p>Changing the <a data-link-type="dfn" href="#animation-node-playback-rate">playback
rate</a> of an <a data-link-type="dfn" href="#animation-node">animation node</a> whose <a data-link-type="dfn" href="#local-time">local time</a> is
within its <a data-link-type="dfn" href="#active-interval">active interval</a> will cause it to jump.
This is because the <a data-link-type="dfn" href="#active-duration">active duration</a> will be updated but the
<a data-link-type="dfn" href="#local-time">local time</a> will not.</p>
      
</ul>

    Furthermore, if other <a data-link-type="dfn" href="#animation-node">animation nodes</a> depend on the
    <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#active-duration">active duration</a>, such as sibling
    <a data-link-type="dfn" href="#animation-node">animation node</a> in a <a data-link-type="dfn" href="#animation-sequence">animation sequence</a>, they
    too may jump as a result of setting the <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a>.
    For runtime speed control the <a data-link-type="dfn" href="#player-playback-rate">playback rate</a> of the
    <a data-link-type="dfn" href="#player">player</a> should be used.

</div>



   <h3 class="heading settled" data-level="3.10" id="core-animation-node-calculations"><span class="secno">3.10. </span><span class="content">Core animation node calculations</span><a class="self-link" href="#core-animation-node-calculations"></a></h3>


   <h4 class="heading settled" data-level="3.10.1" id="overview"><span class="secno">3.10.1. </span><span class="content">Overview</span><a class="self-link" href="#overview"></a></h4>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>At the core of the Web Animations timing model is the process that
takes an <a data-link-type="dfn" href="#inherited-time">inherited time</a> value and converts it to an
<a data-link-type="dfn" href="#iteration-time">iteration time</a>.</p>



    <p>Following this, further transformations are applied before resulting at
a final <a data-link-type="dfn" href="#transformed-time">transformed time</a>.</p>



    <p>The first step in this process is to calculate the bounds of the
<a data-link-type="dfn" href="#active-interval">active interval</a> which is determined by the <a data-link-type="dfn" href="#active-duration">active
duration</a>.</p>


    <p>This process is illustrated below.</p>


    <div class="figure">
  <img alt="Calculation of the active duration." src="img/active-duration-calculation.svg" width="650">
</div>

    <p class="caption">
  Calculation of the <a data-link-type="dfn" href="#active-duration">active duration</a> is based on
  multiplying the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> by the
<a data-link-type="dfn" href="#iteration-count">iteration count</a> and then dividing by the <a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a>.</p>

    <p>
  The process for calculating the <a data-link-type="dfn" href="#active-duration">active duration</a> is normatively
  defined in <a href="#calculating-the-active-duration">§3.10.2 Calculating the active duration</a>.
</p>

    <p>
  Having established the <a data-link-type="dfn" href="#active-duration">active duration</a>, the process for
  transforming an <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#inherited-time">inherited time</a> into its
  <a data-link-type="dfn" href="#transformed-time">transformed time</a> is illustrated below.
</p>

    <div class="figure">
  <img alt="An overview of timing model calculations." src="img/time-calculations.svg" width="650">
</div>

    <p class="caption">
  An overview of timing model calculations.<br>
  (1) The <a data-link-type="dfn" href="#inherited-time">inherited time</a> is converted into a <a data-link-type="dfn" href="#local-time">local time</a> by
  incorporating the <a data-link-type="dfn" href="#animation-node-start-time">start
  time</a>.<br>
  (2) The <a data-link-type="dfn" href="#local-time">local time</a> is converted into an <a data-link-type="dfn" href="#active-time">active time</a> by
  incorporating the <a data-link-type="dfn" href="#start-delay">start delay</a>.<br>  (3) The <a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a>
  and <a data-link-type="dfn" href="#iteration-start">iteration start</a> properties are
  applied to the <a data-link-type="dfn" href="#active-time">active time</a> to produce the <a data-link-type="dfn" href="#scaled-active-time">scaled active
  time</a>.<br>
  (4) The <a data-link-type="dfn" href="#scaled-active-time">scaled active time</a> is then converted to an offset
  within a single iteration: the <a data-link-type="dfn" href="#iteration-time">iteration time</a>.<br>
  (5) The <a data-link-type="dfn" href="#iteration-time">iteration time</a> is converted into a <a data-link-type="dfn" href="#directed-time">directed time</a>
  by incorporating the <a data-link-type="dfn" href="#playback-direction">playback direction</a>.<br>
  (6) Finally, a timing function is applied to the <a data-link-type="dfn" href="#directed-time">directed
  time</a> to produce the <a data-link-type="dfn" href="#transformed-time">transformed time</a>.
</p>


    <p>The first step, calculating the <a data-link-type="dfn" href="#local-time">local time</a> is described in <a href="#local-time-and-inherited-time">§3.6.4 Local time and inherited time</a>.
Steps 2 to 4 in the diagram are described in the following sections.
Steps 5 and 6 are described in
<a href="#calculating-the-directed-time">§3.11.1 Calculating the directed time</a>
and
<a href="#calculating-the-transformed-time">§3.12.5 Calculating the transformed time</a>
respectively.</p>

</div>



   <h4 class="heading settled" data-level="3.10.2" id="calculating-the-active-duration"><span class="secno">3.10.2. </span><span class="content">Calculating the active duration</span><a class="self-link" href="#calculating-the-active-duration"></a></h4>


   <p>In order to calculate the <a data-link-type="dfn" href="#active-duration">active duration</a> we first define the
<a data-link-type="dfn" href="#repeated-duration">repeated duration</a> as follows:</p>


   <blockquote>
  <dfn data-dfn-type="dfn" data-noexport="" id="repeated-duration">repeated duration<a class="self-link" href="#repeated-duration"></a></dfn> =
    <code><a data-link-type="dfn" href="#iteration-duration">iteration duration</a> ×
          <a data-link-type="dfn" href="#iteration-count">iteration count</a></code>
    
    <p>
      If either the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> or <a data-link-type="dfn" href="#iteration-count">iteration count</a>
      are zero, the      <a data-link-type="dfn" href="#repeated-duration">repeated duration</a>
      is zero.
    </p>
    
    <p class="note" role="note">
      This clarification is needed since the result of infinity
      multiplied by zero is undefined according to IEEE 754-2008.
    </p>
</blockquote>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="active-duration">active duration<a class="self-link" href="#active-duration"></a></dfn> is calculated according to the following
steps:</p>


   <ol>
    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a> is
  zero, return <code>Infinity</code>.</p>
     

    <li data-md="">
     <p>Otherwise, return <code><a data-link-type="dfn" href="#repeated-duration">repeated duration</a> / abs(<a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a>)</code>.</p>
     
</ol>

   <h4 class="heading settled" data-level="3.10.3" id="transforming-the-local-time"><span class="secno">3.10.3. </span><span class="content">Transforming the local time</span><a class="self-link" href="#transforming-the-local-time"></a></h4>


   <h5 class="heading settled" data-level="3.10.3.1" id="calculating-the-active-time"><span class="secno">3.10.3.1. </span><span class="content">Calculating the active time</span><a class="self-link" href="#calculating-the-active-time"></a></h5>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="active-time">active time<a class="self-link" href="#active-time"></a></dfn> is based on the <a data-link-type="dfn" href="#local-time">local time</a>
and <a data-link-type="dfn" href="#start-delay">start delay</a>.
However, it is only defined when the <a data-link-type="dfn" href="#animation-node">animation node</a> should
produce an output and hence depends on its <a data-link-type="dfn" href="#fill-mode">fill mode</a> and
phase
as well as the phase of its <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>, if any,
as follows,</p>


   <div class="switch">


    <dl>
     <dt data-md="">
      <p>If the animation node is in the <a data-link-type="dfn" href="#before-phase">before phase</a>,</p>
      

     <dd data-md="">
      <p>The result depends on the first matching condition from the
following,</p>
      


      <div class="switch">


       <dl>
        <dt data-md="">
         <p>If the animation node has a <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>
and that parent animation group is in the <a data-link-type="dfn" href="#after-phase">after
phase</a>,</p>
         

        <dd data-md="">
         <p>Return an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>
         

        <dt data-md="">
         <p>If the <a data-link-type="dfn" href="#fill-mode">fill mode</a> is <span class="prop-mode">backwards</span> or <span class="prop-mode">both</span>,</p>
         

        <dd data-md="">
         <p>Return zero.</p>
         

        <dt data-md="">
         <p>Otherwise,</p>
         

        <dd data-md="">
         <p>Return an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>
         
</dl>
</div>
      


     <dt data-md="">
      <p>If the animation node is in the <a data-link-type="dfn" href="#active-phase">active phase</a>,</p>
      

     <dd data-md="">
      <p>The result depends on the first matching condition from the
following,</p>
      


      <div class="switch">


       <dl>
        <dt data-md="">
         <p>If the animation node has a <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>
and that parent animation group is in the <a data-link-type="dfn" href="#before-phase">before
phase</a>, and the <a data-link-type="dfn" href="#fill-mode">fill mode</a> of this animation node
is <span class="prop-value">none</span> or <span class="prop-value">forwards,</span></p>
         

        <dd data-md="">
         <p>Return an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>
         

        <dt data-md="">
         <p>If the animation node has a <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>
and that parent animation group is in the <a data-link-type="dfn" href="#after-phase">after
phase</a>, and the <a data-link-type="dfn" href="#fill-mode">fill mode</a> of this animation node
is <span class="prop-value">none</span> or <span class="prop-value">backwards,</span></p>
         

        <dd data-md="">
         <p>Return an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>
         

        <dt data-md="">
         <p>Otherwise,</p>
         

        <dd data-md="">
         <p>Return <code><a data-link-type="dfn" href="#local-time">local time</a> - <a data-link-type="dfn" href="#start-delay">start delay</a></code>.</p>
         
</dl>
</div>
      

     <dt data-md="">
      <p>If the animation node is in the <a data-link-type="dfn" href="#after-phase">after phase</a>,</p>
      

     <dd data-md="">
      <p>The result depends on the first matching condition from the
following,</p>
      


      <div class="switch">


       <dl>
        <dt data-md="">
         <p>If the animation node has a <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>
and that parent animation group is in the <a data-link-type="dfn" href="#before-phase">before
phase</a>,</p>
         

        <dd data-md="">
         <p>Return an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>
         

        <dt data-md="">
         <p>If the <a data-link-type="dfn" href="#fill-mode">fill mode</a> is <span class="prop-mode">forwards</span> or <span class="prop-mode">both</span>,</p>
         

        <dd data-md="">
         <p>Return the <a data-link-type="dfn" href="#active-duration">active duration</a>.</p>
         

        <dt data-md="">
         <p>Otherwise,</p>
         

        <dd data-md="">
         <p>Return an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>
         
</dl>
</div>
      


     <dt data-md="">
      <p>Otherwise (the <a data-link-type="dfn" href="#local-time">local time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>),</p>
      

     <dd data-md="">
      <p>Return an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>
      
</dl>
</div>


   <h5 class="heading settled" data-level="3.10.3.2" id="calculating-the-scaled-active-time"><span class="secno">3.10.3.2. </span><span class="content">Calculating the scaled active time</span><a class="self-link" href="#calculating-the-scaled-active-time"></a></h5>


   <p>Before the <a data-link-type="dfn" href="#active-time">active time</a> can be converted to an <a data-link-type="dfn" href="#iteration-time">iteration
time</a> we must factor in the <a data-link-type="dfn" href="#animation-node">animation node</a>’s
<a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a> and
<a data-link-type="dfn" href="#iteration-start">iteration start</a>.
The result is called the <a data-link-type="dfn" href="#scaled-active-time">scaled active time</a>.</p>


   <p>In order to calculate the <a data-link-type="dfn" href="#scaled-active-time">scaled active time</a> we first
define the <a data-link-type="dfn" href="#start-offset">start offset</a> as follows:</p>


   <blockquote>
  <dfn data-dfn-type="dfn" data-noexport="" id="start-offset">start offset<a class="self-link" href="#start-offset"></a></dfn> =
    <code><a data-link-type="dfn" href="#iteration-start">iteration start</a> ×
          <a data-link-type="dfn" href="#iteration-duration">iteration duration</a></code>


    <p>If the <a data-link-type="dfn" href="#iteration-start">iteration start</a> is zero, the <a data-link-type="dfn" href="#start-offset">start offset</a>
  is zero.</p>


    <p class="note" role="note">Note: This clarification is needed since the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a>
      may be infinity and the result of infinity multiplied by zero is
      undefined according to IEEE 754-2008.</p>

</blockquote>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="scaled-active-time">scaled active time<a class="self-link" href="#scaled-active-time"></a></dfn> is calculated according to
the following steps:</p>


   <ol>
    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#active-time">active time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>, return
an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>
     


    <li data-md="">
     <p>Return the scaled active time based on the
<a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a> as
follows,</p>
     


     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If the <a data-link-type="dfn" href="#animation-node-playback-rate">playback
rate</a> is less than zero,</p>
        

       <dd data-md="">
        <p>Return <code>(<a data-link-type="dfn" href="#active-time">active time</a> -
            <a data-link-type="dfn" href="#active-duration">active duration</a>)
× <a data-link-type="dfn" href="#animation-node-playback-rate">playback
rate</a> + <a data-link-type="dfn" href="#start-offset">start offset</a></code>.</p>
        


       <dt data-md="">
        <p>If the <a data-link-type="dfn" href="#animation-node-playback-rate">playback
rate</a> is zero,</p>
        

       <dd data-md="">
        <p>Return <a data-link-type="dfn" href="#start-offset">start offset</a>.</p>
        


       <dt data-md="">
        <p>Otherwise,</p>
        

       <dd data-md="">
        <p>Return <code><a data-link-type="dfn" href="#active-time">active time</a>
× <a data-link-type="dfn" href="#animation-node-playback-rate">playback
rate</a> + <a data-link-type="dfn" href="#start-offset">start offset</a></code>.</p>
        
</dl>
</div>
     
</ol>

   <h5 class="heading settled" data-level="3.10.3.3" id="calculating-the-iteration-time"><span class="secno">3.10.3.3. </span><span class="content">Calculating the iteration time</span><a class="self-link" href="#calculating-the-iteration-time"></a></h5>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="iteration-time">iteration time<a class="self-link" href="#iteration-time"></a></dfn> is calculated according to the
following steps:</p>


   <ol>
    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#scaled-active-time">scaled active time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>,
return <a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     


    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> is zero, return zero.</p>
     


    <li data-md="">
     <p>If <code><a data-link-type="dfn" href="#scaled-active-time">scaled active time</a> - <a data-link-type="dfn" href="#start-offset">start
offset</a></code> is equal to the    <a data-link-type="dfn" href="#repeated-duration">repeated duration</a>,    and <a data-link-type="dfn" href="#iteration-count">iteration count</a> is not zero,
and <code>(<a data-link-type="dfn" href="#iteration-count">iteration count</a> + <a data-link-type="dfn" href="#iteration-start">iteration start</a>)
% 1</code> is zero,
return the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a>.</p>
     


    <li data-md="">
     <p>Otherwise, return <code><a data-link-type="dfn" href="#scaled-active-time">scaled active time</a>
% <a data-link-type="dfn" href="#iteration-duration">iteration duration</a></code>.</p>
     
</ol>

   <h4 class="heading settled" data-level="3.10.4" id="calculating-the-current-iteration"><span class="secno">3.10.4. </span><span class="content">Calculating the current iteration</span><a class="self-link" href="#calculating-the-current-iteration"></a></h4>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="current-iteration">current iteration<a class="self-link" href="#current-iteration"></a></dfn> can be calculated using the
following steps:</p>


   <ol>
    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#scaled-active-time">scaled active time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>, return
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     


    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#scaled-active-time">scaled active time</a> is zero, return zero.</p>
     


    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> is zero, return
<code>ceil(<a data-link-type="dfn" href="#iteration-start">iteration start</a> + <a data-link-type="dfn" href="#iteration-count">iteration count</a>) -
1</code>.</p>
     


    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#iteration-time">iteration time</a> equals the <a data-link-type="dfn" href="#iteration-duration">iteration
duration</a>, return <code><a data-link-type="dfn" href="#iteration-start">iteration start</a>+
<a data-link-type="dfn" href="#iteration-count">iteration count</a> - 1</code>.</p>
     


    <li data-md="">
     <p>Return <code>floor(<a data-link-type="dfn" href="#scaled-active-time">scaled active time</a> /
<a data-link-type="dfn" href="#iteration-duration">iteration duration</a>)</code>.</p>
     

     <p class="note" role="note">
  If the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> is infinite, the
  result of <code>floor(<a data-link-type="dfn" href="#scaled-active-time">scaled active time</a> /
  <a data-link-type="dfn" href="#iteration-duration">iteration duration</a>)</code> will be zero as defined by
  IEEE 754-2008.
</p></ol>

   <h3 class="heading settled" data-level="3.11" id="direction-control"><span class="secno">3.11. </span><span class="content">Direction control</span><a class="self-link" href="#direction-control"></a></h3>


   <p><a data-link-type="dfn" href="#animation-node">Animation nodes</a> may also be configured to run iterations in
alternative directions using direction control.
For this purpose, <a data-link-type="dfn" href="#animation-node">animation nodes</a> have a <dfn data-dfn-type="dfn" data-noexport="" id="playback-direction">playback
direction<a class="self-link" href="#playback-direction"></a></dfn> parameter which takes one of the following values:</p>


   <ul>
    <li data-md="">
     <p>normal,</p>
     

    <li data-md="">
     <p>reverse,</p>
     

    <li data-md="">
     <p>alternate, or</p>
     

    <li data-md="">
     <p>alternate-reverse.</p>
     
</ul>

   <p>The semantics of these values are incorporated into the calculation of
the <a data-link-type="dfn" href="#directed-time">directed time</a> which follows.</p>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>A non-normative definition of these values is as follows:</p>


    <dl>
     <dt data-md="">
      <p>normal</p>
      

     <dd data-md="">
      <p>All iterations are played as specified.</p>
      


     <dt data-md="">
      <p>reverse</p>
      

     <dd data-md="">
      <p>All iterations are played in the reverse direction from the way
they are specified.</p>
      


     <dt data-md="">
      <p>alternate</p>
      

     <dd data-md="">
      <p>Even iterations are played as specified, odd iterations are played
in the reverse direction from the way they are specified.</p>
      


     <dt data-md="">
      <p>alternate-reverse</p>
      

     <dd data-md="">
      <p>Even iterations are played in the reverse direction from the way
they are specified, odd iterations are played as specified.</p>
      
</dl>
</div>


   <h4 class="heading settled" data-level="3.11.1" id="calculating-the-directed-time"><span class="secno">3.11.1. </span><span class="content">Calculating the directed time</span><a class="self-link" href="#calculating-the-directed-time"></a></h4>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="directed-time">directed time<a class="self-link" href="#directed-time"></a></dfn> is calculated from the <a data-link-type="dfn" href="#iteration-time">iteration
  time</a> using the following steps:</p>


   <ol>
    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#iteration-time">iteration time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>, return
<a data-link-type="dfn" href="#unresolved">unresolved</a>.</p>
     


    <li data-md="">
     <p>Calculate the <var>current direction</var> using the first
matching condition from the following list:</p>
     

     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If <a data-link-type="dfn" href="#playback-direction">playback direction</a> is <code>normal</code>,</p>
        

       <dd data-md="">
        <p>Let the <var>current direction</var> be forwards.</p>
        


       <dt data-md="">
        <p>If <a data-link-type="dfn" href="#playback-direction">playback direction</a> is <code>reverse</code>,</p>
        

       <dd data-md="">
        <p>Let the <var>current direction</var> be reverse.</p>
        


       <dt data-md="">
        <p>Otherwise,</p>
        

       <dd data-md="">


        <ol>
         <li data-md="">
          <p>Let <var>d</var> be the <a data-link-type="dfn" href="#current-iteration">current iteration</a>.</p>
          


         <li data-md="">
          <p>If <a data-link-type="dfn" href="#playback-direction">playback direction</a> is
  <code>alternate-reverse</code> increment
  <var>d</var> by 1.</p>
          


         <li data-md="">
          <p class="issue" id="issue-eb1151df"><a class="self-link" href="#issue-eb1151df"></a>There used to be a step here which seemed to be adding
  special handling for filling when the node ends on
  a repeat boundary but it seems like that is taken care
  of by the calcuation of <a data-link-type="dfn" href="#iteration-time">iteration time</a> and
  <a data-link-type="dfn" href="#current-iteration">current iteration</a>.
  Is anything actually needed here?</p>
          


         <li data-md="">
          <p>If <code><var>d</var> % 2 == 0</code>, let the
  <var>current direction</var> be forwards, otherwise let
  the <var>current direction</var> be reverse.
  If <var>d</var> is infinity, let the <var>current direction</var>
  be forwards.</p>
          
</ol></dl>
</div>
     


    <li data-md="">
     <p>If the <var>current direction</var> is forwards then return
the <a data-link-type="dfn" href="#iteration-time">iteration time</a>.</p>
     


     <p>Otherwise, return the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> - <a data-link-type="dfn" href="#iteration-time">iteration time</a>.</p>
     
</ol>

   <h3 class="heading settled" data-level="3.12" id="time-transformations"><span class="secno">3.12. </span><span class="content">Time transformations</span><a class="self-link" href="#time-transformations"></a></h3>


   <h4 class="heading settled" data-level="3.12.1" id="scaling-the-time"><span class="secno">3.12.1. </span><span class="content">Scaling the time</span><a class="self-link" href="#scaling-the-time"></a></h4>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>It is often desirable to control the rate at which an <a data-link-type="dfn" href="#animation-node">animation
node</a> progresses.
For example, easing the rate of animation can create a sense of
momentum and produce a more natural effect.
Conversely, in other situations such as when modelling a discrete
change, a smooth transition is undesirable and instead it is necessary
for the <a data-link-type="dfn" href="#animation-node">animation node</a> to progress in a series of distinct
steps.</p>


    <p>For such situations Web Animations provides <a data-link-type="dfn" href="#timing-function">timing functions</a>
that scale the progress of an <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>


    <p><a data-link-type="dfn" href="#timing-function">Timing functions</a> take an input time fraction and produce
a scaled output time fraction.</p>


    <div class="figure">
  <img alt="Example of a timing function that produces an ease-in effect." src="img/timing-function-example.svg" width="350">
</div>

    <p class="caption">
  Example of a timing function that produces an ease-in effect.
  Given an input timing fraction of 0.7, the timing function scales the
  value to produce an output time fraction of 0.52.<br>
  By applying this timing function, time will appear to progress more
  slowly at first but then gradually progress more quickly.
</p>


    <p><a data-link-type="dfn" href="#timing-function">Timing functions</a> are applied to an iteration of an <a data-link-type="dfn" href="#animation-node">animation
node</a>.</p>

</div>


   <h4 class="heading settled" data-level="3.12.2" id="timing-functions"><span class="secno">3.12.2. </span><span class="content">Timing functions</span><a class="self-link" href="#timing-functions"></a></h4>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="timing-function">timing function<a class="self-link" href="#timing-function"></a></dfn> takes an input time fraction in the range
[0, 1] and produces an output time fraction whose range is unbounded
(i.e. positive and negative infinity are permitted).</p>


   <p><a data-link-type="dfn" href="#animation-node">Animation nodes</a> have one <a data-link-type="dfn" href="#timing-function">timing function</a> associated with
them.
The default <a data-link-type="dfn" href="#timing-function">timing function</a> is the <dfn data-dfn-type="dfn" data-noexport="" id="linear-timing-function">linear timing
function<a class="self-link" href="#linear-timing-function"></a></dfn> whose output is identical to its input.
The <a data-link-type="dfn" href="#linear-timing-function">linear timing function</a> can be represented by the string
“linear”.</p>


   <p>The range of timing functions that may be applied to a given
<a data-link-type="dfn" href="#animation-node">animation node</a> depends on the type of the <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>


   <div class="issue" id="issue-a889e2ba"><a class="self-link" href="#issue-a889e2ba"></a>
Currently, the set of <a data-link-type="dfn" href="#timing-function">timing functions</a> allowed on
an <a data-link-type="dfn" href="#animation-group">animation group</a> is not restricted.
This has raised concern about complexity of implementation and also
complexity of behavior with regards to fill modes.
As a result, allowing the full set of timing functions on animation
groups is considered <strong>at risk</strong>.
Alternatives are to either restrict timing functions on animation
groups to the <a data-link-type="dfn" href="#linear-timing-function">linear timing function</a> or to a set of
“simple” timing functions that have properties that
alleviate some of the concerns with the more complex timing
functions.


    <p>See <a href="http://lists.w3.org/Archives/Public/public-fx/2013JulSep/0076.html">section
2 of the discussion from August 2013</a>.</p>
</div>


   <h4 class="heading settled" data-level="3.12.3" id="scaling-using-a-cubic-bezier-curve"><span class="secno">3.12.3. </span><span class="content">Scaling using a cubic Bézier curve</span><a class="self-link" href="#scaling-using-a-cubic-bezier-curve"></a></h4>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>A common method of producing easing effects is to use a cubic Bézier
curve to scale the time.
The endpoints of the curve are fixed at (0, 0) and (1, 1) while two
control points <var>P1</var> and <var>P2</var> define the shape of
the curve.
Provided the <var>x</var> values of <var>P1</var> and <var>P2</var>
lie within the range [0, 1] such a curve produces a function that is
used to map input times (the <var>x</var> values) onto output times
(the <var>y</var> values).
This arrangement is illustrated below.</p>


    <div class="figure">
  <img alt="A cubic Bezier curve used as a timing function." src="img/cubic-bezier-timing-curve.svg" width="500">
</div>

    <p class="caption">
  A cubic Bézier curve used as a timing function.<br>
  The shape of the curve is determined by the location of the control
  points <var>P1</var> and <var>P2</var>.<br>
  Input time fractions serve as <var>x</var> values of the curve,
  whilst the <var>y</var> values are the output time fractions.
</p>


    <p>Some example cubic Bézier timing functions are illustrated below.</p>


    <div class="figure">
  <img alt="The timing functions produced by keyword values." src="img/curve-keywords.svg" width="500">
</div>

    <p class="caption">
  The timing functions produced by each of the keyword values
  associated with cubic Béier timing functions accepted by the
  <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-easing">easing</a></code> member of the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface
  member from the <a href="#programming-interface">programming
  interface</a>.
</p>
</div>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="cubic-bzier-timing-function">cubic Bézier timing function<a class="self-link" href="#cubic-bzier-timing-function"></a></dfn> is a type of <a data-link-type="dfn" href="#timing-function">timing
function</a> defined by four real numbers that specify the two control
points, <var>P1</var> and <var>P2</var>, of a cubic Bézier curve whose
end points are fixed at (0, 0) and (1, 1).
The x coordinates of <var>P1</var> and <var>P2</var> are
restricted to the range [0, 1].</p>


   <p>The evaluation of this curve is covered in many sources such as
<a data-link-type="biblio" href="#biblio-fund-comp-graphics">[FUND-COMP-GRAPHICS]</a>.</p>


   <p>A <a data-link-type="dfn" href="#cubic-bzier-timing-function">cubic Bézier timing function</a> may be specified as a string
using the following syntax (using notation from <a data-link-type="biblio" href="#biblio-css3val">[CSS3VAL]</a>):</p>

   <blockquote>
  
    <div class="production"><dfn class="css" data-dfn-type="type" data-export="" id="typedef-cubic-bezier-timing-function">&lt;cubic-bezier-timing-function><a class="self-link" href="#typedef-cubic-bezier-timing-function"></a></dfn> =
    ease | ease-in | ease-out | ease-in-out |
    <span class="atom">cubic-bezier(&lt;number>, &lt;number>,
      &lt;number>, &lt;number>)</span></div>
</blockquote>


   <p>The meaning of each value is as follows:</p>


   <dl>
    <dt data-md="">
     <p>ease</p>
     

    <dd data-md="">
     <p>Equivalent to cubic-bezier(0.25, 0.1, 0.25, 1).</p>
     

    <dt data-md="">
     <p>ease-in</p>
     

    <dd data-md="">
     <p>Equivalent to cubic-bezier(0.42, 0, 1, 1).</p>
     

    <dt data-md="">
     <p>ease-out</p>
     

    <dd data-md="">
     <p>Equivalent to cubic-bezier(0, 0, 0.58, 1).</p>
     

    <dt data-md="">
     <p>ease-in-out</p>
     

    <dd data-md="">
     <p>Equivalent to cubic-bezier(0.42, 0, 0.58, 1).</p>
     

    <dt data-md="">
     <p>cubic-bezier(&lt;number>, &lt;number>, &lt;number>, &lt;number>)</p>
     

    <dd data-md="">
     <p>Specifies a <a data-link-type="dfn" href="#cubic-bzier-timing-function">cubic Bézier timing function</a>.
The four numbers specify points <var>P1</var> and <var>P2</var> of
the curve as (x1, y1, x2, y2).
Both x values must be in the range [0, 1] or the definition is
invalid.</p>
     
</dl>

   <div class="issue" id="issue-9e5dcac9"><a class="self-link" href="#issue-9e5dcac9"></a>
It has been proposed to extend <code>cubic-bezier</code> to allow
multiple segments, using syntax such as the following:


    <pre><code>cubic-bezier( [ &lt;number>{6} ; ]* &lt;number>{4} )</code>
</pre>


    <p>(i.e. the curve starts at (0, 0); each segment is defined by six
numbers where the start point is the end of the previous segment and
the numbers define the two control points and the end point. The
last segment is defined by four numbers since the end point is fixed
at (1, 1).)</p>


    <p>This would provide a simple and compact syntax for tools trying to
map arbitrary curves (e.g. bounce functions) to timing functions.</p>
</div>


   <h4 class="heading settled" data-level="3.12.4" id="timing-in-discrete-steps"><span class="secno">3.12.4. </span><span class="content">Timing in discrete steps</span><a class="self-link" href="#timing-in-discrete-steps"></a></h4>


   <div class="informative-bg"><em>This section is non-normative</em>
It is possible to scale an animation node’s timing so that the animation node
occurs in a series of discrete steps using a stepping function.


    <p>Some example step timing functions are illustrated below.</p>


    <div class="figure">
  <img alt="Example step timing functions." src="img/step-timing-func-examples.svg" width="700">
</div>

    <p class="caption">
  Example step timing functions.
  In each case the domain is the input time fraction whilst the range
  represents the output time fraction produced by the step
  function.<br>
  The first row shows the function for each transition point when only
  one step is specified whilst the second row shows the same for three
  steps.
</p>

</div>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="step-timing-function">step timing function<a class="self-link" href="#step-timing-function"></a></dfn> is a type of <a data-link-type="dfn" href="#timing-function">timing function</a>
that divides the input time into a specified number of intervals that
are equal in duration.
The output time, starting at zero, rises by an amount equal to the
interval duration once during each interval at the transition point
which may be either the start, midpoint, or end of the interval.</p>


   <p>In keeping with Web Animations' model of endpoint exclusive
interval timing (see <a href="#interval-timing">§3.8.4 Interval timing</a>), the output time at the transition point is
the time <em>after</em> applying the increase (i.e. the top of the
step) with the following exception.</p>


   <p>When a transition point coincides with the end of the <a data-link-type="dfn" href="#active-interval">active
interval</a> extra care must be taken to produce the correct result
when performing a <a data-link-type="dfn" href="#fill-mode">fill</a>.
To achieve this, when a <a data-link-type="dfn" href="#step-timing-function">step timing function</a> is
applied to an <a data-link-type="dfn" href="#animation-node">animation node</a> or applied to an <a data-link-type="dfn" href="#animation-effect">animation
effect</a> associated with an <a data-link-type="dfn" href="#animation-node">animation node</a>, an additional
<dfn data-dfn-type="dfn" data-noexport="" id="before-flag">before flag<a class="self-link" href="#before-flag"></a></dfn> is passed.
The value of the <a data-link-type="dfn" href="#before-flag">before flag</a> is determined as follows:</p>



   <ol>
    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#active-time">active time</a> of the animation node is
<a data-link-type="dfn" href="#unresolved">unresolved</a>, the <a data-link-type="dfn" href="#before-flag">before flag</a> is not set and these
steps should be aborted.</p>
     

    <li data-md="">
     <p>Determine the <var>current direction</var> using the procedure
defined in <a href="#calculating-the-directed-time">§3.11.1 Calculating the directed time</a>.</p>
     

    <li data-md="">
     <p>If <em>either</em> the <var>current direction</var> is <span class="prop-value">forwards</span> or the <a data-link-type="dfn" href="#animation-node-playback-rate">animation node
playback rate</a> ≥ 0 (but <em>not</em> when both conditions
are true),
let <var>going forwards</var> be true, otherwise it is false.</p>
     

    <li data-md="">
     <p>The <a data-link-type="dfn" href="#before-flag">before flag</a> is set if the animation node is in the
<a data-link-type="dfn" href="#before-phase">before phase</a> and <var>going forwards</var> is true;
or if the animation node is in the <a data-link-type="dfn" href="#after-phase">after phase</a> and
<var>going forwards</var> is false.</p>
     
</ol>

   <p>When a step timing function is evaluated at a transition point, if
the <a data-link-type="dfn" href="#before-flag">before flag</a> is set the result is the value <em>before</em>
applying the increase.</p>


   <p>A <a data-link-type="dfn" href="#step-timing-function">step timing function</a> may be specified as a string
using the following syntax:</p>


   <blockquote>
  
    <div class="production"><dfn class="css" data-dfn-type="type" data-export="" id="typedef-step-timing-function">&lt;step-timing-function><a class="self-link" href="#typedef-step-timing-function"></a></dfn> =
    step-start | step-middle | step-end |
    <span class="atom">steps(&lt;integer>[,
                       [ start | middle | end ] ]?)</span></div>
</blockquote>


   <p>The meaning of each value is as follows:</p>


   <dl>
    <dt data-md="">
     <p>step-start</p>
     

    <dd data-md="">
     <p>Equivalent to steps(1, start);</p>
     

    <dt data-md="">
     <p>step-middle</p>
     

    <dd data-md="">
     <p>Equivalent to steps(1, middle);</p>
     

    <dt data-md="">
     <p>step-end</p>
     

    <dd data-md="">
     <p>Equivalent to steps(1, end);</p>
     

    <dt data-md="">
     <p>steps(&lt;integer>[, [ start | middle | end ] ]?)</p>
     

    <dd data-md="">
     <p>Specifies a <a data-link-type="dfn" href="#step-timing-function">step timing function</a>.
The first parameter specifies the number of intervals in the
function.
It must be a positive integer (greater than 0).
The second parameter, which is optional, specifies the point at
which the change of values occur within the interval.
If the second parameter is omitted, it is given the value <span class="prop-value">end</span>.</p>
     
</dl>

   <h4 class="heading settled" data-level="3.12.5" id="calculating-the-transformed-time"><span class="secno">3.12.5. </span><span class="content">Calculating the transformed time</span><a class="self-link" href="#calculating-the-transformed-time"></a></h4>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="transformed-time">transformed time<a class="self-link" href="#transformed-time"></a></dfn> is calculated from the
<a data-link-type="dfn" href="#directed-time">directed time</a> using the following steps:</p>


   <ol>
    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#directed-time">directed time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>,
return an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>
     

    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> is infinity,
return the <a data-link-type="dfn" href="#directed-time">directed time</a>.</p>
     

    <li data-md="">
     <p>Let <var>iteration fraction</var> be the result of
evaluating <code><a data-link-type="dfn" href="#directed-time">directed time</a> / <a data-link-type="dfn" href="#iteration-duration">iteration
duration</a></code> unless <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> is
zero, in which case let <var>iteration fraction</var> be
zero.</p>
     

    <li data-md="">
     <p>Let <var>scaled fraction</var> be the result of
evaluating the <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#timing-function">timing function</a>
with <var>iteration fraction</var> as the input time
fraction.</p>
     

    <li data-md="">
     <p>Return the result of evaluating <code><var>scaled
fraction</var> × <a data-link-type="dfn" href="#iteration-duration">iteration duration</a></code>.
If the <var>scaled fraction</var> is zero, let the result be
zero.</p>
     


     <p class="note" role="note">Note: This clarification is needed since the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a>
    may be infinity and the result of infinity multiplied by zero is
    undefined according to IEEE 754-2008.</p>
     
</ol>

   <h3 class="heading settled" data-level="3.13" id="grouping-and-synchronization"><span class="secno">3.13. </span><span class="content">Grouping and synchronization</span><a class="self-link" href="#grouping-and-synchronization"></a></h3>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>While it is possible to set the timing properties of <a data-link-type="dfn" href="#animation-node">animation
nodes</a> individually, it is often useful to synchronize <a data-link-type="dfn" href="#animation-node">animation
nodes</a> so that they share common timing properties and maintain
their temporal relationship.  This is achieved using an <a data-link-type="dfn" href="#animation-group">animation
group</a>.</p>


    <p>A simple example is illustrated below.</p>


    <div class="figure">
  <img alt="Using groups to share common timing properties." src="img/grouping-delay.svg" width="800">
</div>

    <p class="caption">
  Using groups to share common timing properties.<br>
  (a) Shows setting a delay of 5 seconds on individual animations.<br>
  (b) Produces the same effect by setting the delay on the group.
</p>


    <p>When an <a data-link-type="dfn" href="#animation-group">animation group</a> is <a data-link-type="dfn" href="#directly-associated-with-a-player">directly associated with
a player</a>, the <a data-link-type="dfn" href="#animation-node">animation nodes</a> associated with the
<a data-link-type="dfn" href="#animation-group">animation group</a> can be seeked, paused, and stopped as a unit.</p>

    <p></p>

</div>


   <p>An <dfn data-dfn-type="dfn" data-noexport="" id="animation-group">animation group<a class="self-link" href="#animation-group"></a></dfn> is a type of <a data-link-type="dfn" href="#animation-node">animation node</a> that
contains an ordered sequence of zero or more <a data-link-type="dfn" href="#animation-node">animation nodes</a>
known as <dfn data-dfn-type="dfn" data-lt="child animation node" data-noexport="" id="child-animation-node">child animation nodes<a class="self-link" href="#child-animation-node"></a></dfn>.</p>


   <p>At a given moment, an <a data-link-type="dfn" href="#animation-node">animation node</a> may be a <a data-link-type="dfn" href="#child-animation-node">child animation
node</a> of at most one <a data-link-type="dfn" href="#animation-group">animation group</a> known as the <dfn data-dfn-type="dfn" data-noexport="" id="parent-animation-group">parent
animation group<a class="self-link" href="#parent-animation-group"></a></dfn>.
The <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a> cannot be the same <a data-link-type="dfn" href="#animation-node">animation
node</a> as the <a data-link-type="dfn" href="#child-animation-node">child animation node</a> itself.</p>


   <p>By nesting <a data-link-type="dfn" href="#animation-group">animation groups</a> it is possible to create hierarchical
tree structures.
The following terms are used to describe the parts and properties of
such structures and are defined in <a data-link-type="biblio" href="#biblio-dom">[DOM]</a>:</p>


   <ul>
    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="tree-order"><a href="http://www.w3.org/TR/dom/#concept-tree-order">
tree order</a><a class="self-link" href="#tree-order"></a></dfn></p>
     

    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="root"><a href="http://www.w3.org/TR/dom/#concept-tree-root">
root</a><a class="self-link" href="#root"></a></dfn></p>
     

    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="ancestor"><a href="http://www.w3.org/TR/dom/#concept-tree-ancestor">
ancestor</a><a class="self-link" href="#ancestor"></a></dfn></p>
     

    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="descendant"><a href="http://www.w3.org/TR/dom/#concept-tree-descendant">
descendant</a><a class="self-link" href="#descendant"></a></dfn></p>
     

    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="inclusive-ancestor"><a href="http://www.w3.org/TR/dom/#concept-tree-inclusive-ancestor">
inclusive ancestor</a><a class="self-link" href="#inclusive-ancestor"></a></dfn></p>
     

    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="inclusive-descendant"><a href="http://www.w3.org/TR/dom/#concept-tree-inclusive-descendant">
inclusive descendant</a><a class="self-link" href="#inclusive-descendant"></a></dfn></p>
     

    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="next-sibling"><a href="http://www.w3.org/TR/dom/#concept-tree-next-sibling">
next sibling</a><a class="self-link" href="#next-sibling"></a></dfn></p>
     

    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="previous-sibling"><a href="http://www.w3.org/TR/dom/#concept-tree-previous-sibling">
previous sibling</a><a class="self-link" href="#previous-sibling"></a></dfn></p>
     

    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="first-child"><a href="http://www.w3.org/TR/dom/#concept-tree-first-child">
first child</a><a class="self-link" href="#first-child"></a></dfn></p>
     

    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="last-child"><a href="http://www.w3.org/TR/dom/#concept-tree-last-child">
last child</a><a class="self-link" href="#last-child"></a></dfn></p>
     
</ul>

   <p class="note" role="note">Note: in applying these definitions to <a data-link-type="dfn" href="#animation-node">animation nodes</a>, the
    term <em>parent</em> refers exclusively to a <a data-link-type="dfn" href="#parent-animation-group">parent animation
    group</a> and does <em>not</em> include the <a data-link-type="dfn" href="#player">player</a> which with
    an <a data-link-type="dfn" href="#animation-node">animation node</a> may be <a data-link-type="dfn" href="#directly-associated-with-a-player">directly associated</a>
    despite the fact that conceptually the <a data-link-type="dfn" href="#player">player</a> acts as a parent
    time source.</p>


   <p>The temporal relationship between a <a data-link-type="dfn" href="#child-animation-node">child animation node</a> and its
<a data-link-type="dfn" href="#parent-animation-group">parent animation group</a> is incorporated in the definition of
<a data-link-type="dfn" href="#inherited-time">inherited time</a> (see <a href="#local-time-and-inherited-time">§3.6.4 Local time and inherited time</a>).</p>


   <h4 class="heading settled" data-level="3.13.1" id="relationship-of-group-time-to-child-time"><span class="secno">3.13.1. </span><span class="content">Relationship of group time to child time</span><a class="self-link" href="#relationship-of-group-time-to-child-time"></a></h4>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>The timing of the children of an <a data-link-type="dfn" href="#animation-group">animation group</a> is based on
the timing of the group.
Specifically, times for the children are based on the parent’s
<a data-link-type="dfn" href="#transformed-time">transformed time</a>.
With regards to repetition, this means the children operate
<em>inside</em> an iteration of the parent.</p>


    <p>For example, if an <a data-link-type="dfn" href="#animation-group">animation group</a> has an <a data-link-type="dfn" href="#iteration-count">iteration
count</a> of 2, then the children of of the group will all play twice
since they effectively play <em>inside</em> the group’s iterations.</p>


    <div class="figure">
  <img alt="The effect of multiple iterations on the children of a group." src="img/grouping-repetition.svg" width="600">
</div>

    <p class="caption">
  Since children of an <a data-link-type="dfn" href="#animation-group">animation group</a> base their timing on the
  group’s <a data-link-type="dfn" href="#transformed-time">transformed time</a>, when the group repeats, the
  children play again.
</p>


    <p>Note that even in this case, the child <a data-link-type="dfn" href="#animation-node">animation nodes</a> still
have only <em>one</em> <a data-link-type="dfn" href="#active-interval">active interval</a>.
However, as a result of the parent’s timing, the <a data-link-type="dfn" href="#active-interval">active
interval</a> is played twice.</p>


    <p>If an <a data-link-type="dfn" href="#iteration-count">iteration count</a> is specified for the children of a group
as well as for the group itself, the effect is as if the <a data-link-type="dfn" href="#iteration-count">iteration
count</a> of the group was multiplied with the <a data-link-type="dfn" href="#iteration-count">iteration count</a>
of the children.</p>


    <div class="figure">
  <img alt="Iteration counts are multiplicative." src="img/grouping-repetition-and-animation-repetition.svg" width="600">
</div>

    <p class="caption">
  Specifying an <a data-link-type="dfn" href="#iteration-count">iteration count</a> of 2 on an <a data-link-type="dfn" href="#animation-group">animation group</a>
  and an <a data-link-type="dfn" href="#iteration-count">iteration count</a> of 3 on one of its children results in
  that child playing 6 times.
</p>


    <p>A further result of the children of an <a data-link-type="dfn" href="#animation-group">animation group</a> basing
their timing on the group’s <a data-link-type="dfn" href="#transformed-time">transformed time</a> is that they
cannot animate outside of the group’s <a data-link-type="dfn" href="#active-interval">active interval</a>.
This is because the <a data-link-type="dfn" href="#transformed-time">transformed time</a> of a group will not
change outside its <a data-link-type="dfn" href="#active-interval">active interval</a>.
This allows groups to <em>clip</em> the playback of their children.</p>


    <div class="figure">
  <img alt="Groups clip the active interval of contained children." src="img/grouping-clipping.svg" width="600">
</div>

    <p class="caption">
  In the first instance, an <a data-link-type="dfn" href="#animation-node">animation node</a> has a negative delay
  and an infinite <a data-link-type="dfn" href="#iteration-count">iteration count</a>.<br>
  However, when a similar <a data-link-type="dfn" href="#animation-node">animation node</a> is placed inside
  an <a data-link-type="dfn" href="#animation-group">animation group</a> with a specified <a data-link-type="dfn" href="#iteration-duration">iteration duration</a>
  it has the effect of clipping the child <a data-link-type="dfn" href="#animation-node">animation node</a>’s
  <a data-link-type="dfn" href="#active-interval">active interval</a>.
</p>


    <p>Some further consequences of <a data-link-type="dfn" href="#animation-group">animation group</a> children basing
their timing on their parent group’s <a data-link-type="dfn" href="#transformed-time">transformed time</a> are:</p>



    <ul>
     <li data-md="">
      <p>Setting the <a data-link-type="dfn" href="#animation-node-playback-rate">playback
rate</a> of an <a data-link-type="dfn" href="#animation-group">animation group</a> will speed up or slow down all
children.</p>
      


     <li data-md="">
      <p>Changing the <a data-link-type="dfn" href="#playback-direction">playback direction</a> of an <a data-link-type="dfn" href="#animation-group">animation group</a>
will change the direction of all children.</p>
      


     <li data-md="">
      <p>Applying a <a data-link-type="dfn" href="#timing-function">timing function</a> to an <a data-link-type="dfn" href="#animation-group">animation group</a> will
affect the progress of all children.</p>
      
</ul>
</div>


   <h4 class="heading settled" data-level="3.13.2" id="the-start-time-of-children-of-an-animation-group"><span class="secno">3.13.2. </span><span class="content">The start time of children of an animation group</span><a class="self-link" href="#the-start-time-of-children-of-an-animation-group"></a></h4>


   <p>The <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of a <a data-link-type="dfn" href="#child-animation-node">child
animation node</a> of an <a data-link-type="dfn" href="#animation-group">animation group</a> is zero.</p>


   <p>Note that specific types of <a data-link-type="dfn" href="#animation-group">animation groups</a> may override
this definition to provide other kinds of synchronization behavior.</p>


   <h4 class="heading settled" data-level="3.13.3" id="the-intrinsic-iteration-duration-of-an-animation-group"><span class="secno">3.13.3. </span><span class="content">The intrinsic iteration duration of an animation group</span><a class="self-link" href="#the-intrinsic-iteration-duration-of-an-animation-group"></a></h4>


   <p>The <a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration duration</a> of an <a data-link-type="dfn" href="#animation-group">animation
group</a> is based on the time when the last <a data-link-type="dfn" href="#child-animation-node">child animation
node</a> completes its <a data-link-type="dfn" href="#active-interval">active interval</a> and depends on the
number of <a data-link-type="dfn" href="#child-animation-node">child animation nodes</a> as follows.</p>


   <div class="switch">


    <dl>
     <dt data-md="">
      <p>If the group has no <a data-link-type="dfn" href="#child-animation-node">child animation nodes</a>,</p>
      

     <dd data-md="">
      <p>the <a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration duration</a> is zero.</p>
      


     <dt data-md="">
      <p>Otherwise,</p>
      

     <dd data-md="">


      <ol>
       <li data-md="">
        <p>Let <var>maximum end time</var> be the maximum value
after calculating the <a data-link-type="dfn" href="#end-time">end time</a> of each <a data-link-type="dfn" href="#child-animation-node">child
animation node</a> in the group.</p>
        

       <li data-md="">
        <p>The <a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration duration</a> is the result of
evaluating <code>max(0, <var>maximum end
time</var>)</code>.</p>
        
</ol></dl>
</div>


   <p>This definition of the <a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration duration</a> may be
overridden by specific types of <a data-link-type="dfn" href="#animation-group">animation groups</a>.</p>


   <h4 class="heading settled" data-level="3.13.4" id="animation-sequences"><span class="secno">3.13.4. </span><span class="content">Animation sequences</span><a class="self-link" href="#animation-sequences"></a></h4>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>Specific types of <a data-link-type="dfn" href="#animation-group">animation groups</a> can be used to provide
different kinds of synchronization behavior for their children.
This specification defines one additional type of <a data-link-type="dfn" href="#animation-group">animation
group</a>: an <a data-link-type="dfn" href="#animation-sequence">animation sequence</a>.
<a data-link-type="dfn" href="#animation-sequence">Animation sequences</a> arrange the start times of their
children so that they run one at a time, in turn.</p>


    <p>Compare the two arrangements illustrated below:</p>


    <div class="figure">
  <img alt="Animation groups and animation sequences." src="img/grouping-types.svg" width="600">
</div>

    <p class="caption">
  Animation groups and animation sequences.<br>
  (a) is a regular <a data-link-type="dfn" href="#animation-group">animation group</a> where all the children run
      simultaneously.<br>
  (b) is an <a data-link-type="dfn" href="#animation-sequence">animation sequence</a> where the children run in turn.
</p>


    <p>Since <a data-link-type="dfn" href="#animation-group">animation groups</a> can also contain other <a data-link-type="dfn" href="#animation-group">animation
groups</a>, complex synchronization is possible by combining
different types of groups as illustrated below.</p>


    <div class="figure">
  <img alt="Nesting of animation groups." src="img/grouping-nesting.svg" width="600">
</div>

    <p class="caption">
  An <a data-link-type="dfn" href="#animation-sequence">animation sequence</a> that contains a regular <a data-link-type="dfn" href="#animation-group">animation
  group</a> as a child.<br>
  The <a data-link-type="dfn" href="#animation-group">animation group</a> waits for the previous child of the
  <a data-link-type="dfn" href="#animation-sequence">animation sequence</a> to finish, and then the children of the
  <a data-link-type="dfn" href="#animation-group">animation group</a> play simultaneously.
  After they have finished the next child of the <a data-link-type="dfn" href="#animation-sequence">animation
  sequence</a> plays.
</p>

</div>


   <p>An <dfn data-dfn-type="dfn" data-noexport="" id="animation-sequence">animation sequence<a class="self-link" href="#animation-sequence"></a></dfn> is a type of <a data-link-type="dfn" href="#animation-group">animation group</a>
that schedules its <a data-link-type="dfn" href="#child-animation-node">child animation nodes</a> such that they play in
turn following their order in the group.
This sequencing is achieved by adjusting the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of each <a data-link-type="dfn" href="#child-animation-node">child
animation node</a> in the group.</p>


   <h5 class="heading settled" data-level="3.13.4.1" id="the-start-time-of-children-of-an-animation-sequence"><span class="secno">3.13.4.1. </span><span class="content">The start time of children of an animation sequence</span><a class="self-link" href="#the-start-time-of-children-of-an-animation-sequence"></a></h5>


   <p>The <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of
a <a data-link-type="dfn" href="#child-animation-node">child animation node</a> of an <a data-link-type="dfn" href="#animation-sequence">animation sequence</a> is the
<a data-link-type="dfn" href="#end-time">end time</a> of the child’s <a data-link-type="dfn" href="#previous-sibling">previous sibling</a>.
If the child has no <a data-link-type="dfn" href="#previous-sibling">previous sibling</a> the start time is zero.</p>


   <div class="note" role="note">
When the <a data-link-type="dfn" href="#active-duration">active duration</a> is positive infinity the behavior
for calculating the <a data-link-type="dfn" href="#end-time">end time</a> of an <a data-link-type="dfn" href="#animation-node">animation node</a>
and the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of
subsequent children follows the usual behavior defined by IEEE
754-2008.
As a result, if any of the children of an <a data-link-type="dfn" href="#animation-sequence">animation
sequence</a> has an infinite <a data-link-type="dfn" href="#active-duration">active duration</a>, any children
that occur later in the sequence will not play.


    <p>Similarly, the above definition does not restrict
<a data-link-type="dfn" href="#animation-node-start-time">start times</a> to positive
values and hence some children may not play due to a negative
<a data-link-type="dfn" href="#start-delay">start delay</a> on children that occur earlier in the group
since their <a data-link-type="dfn" href="#active-interval">active interval</a> may end before the group’s <a data-link-type="dfn" href="#animation-node-start-time">start time</a>.</p>
</div>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>Because the start of the <a data-link-type="dfn" href="#active-interval">active interval</a> is based on the
sum of an <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#animation-node-start-time">start time</a> <em>and</em>
<a data-link-type="dfn" href="#start-delay">start delay</a>, the <a data-link-type="dfn" href="#active-interval">active intervals</a> of
children of an <a data-link-type="dfn" href="#animation-sequence">animation sequence</a> need not run in strict
sequence but can be shifted back and forth by using the <a data-link-type="dfn" href="#start-delay">start
delay</a> as shown in the following diagram.</p>


    <div class="figure">
  <img alt="Using negative start delays to overlap children of seq
        groups" src="img/sequence-groups-and-start-delays.svg" width="600">
</div>

    <p class="caption">
  Example of using the <a data-link-type="dfn" href="#start-delay">start delay</a> on children of an
  <a data-link-type="dfn" href="#animation-sequence">animation sequence</a> to shift their timing so that they
  overlap (a negative delay) or are spaced apart (a positive delay).
</p>


    <p>A negative <a data-link-type="dfn" href="#start-delay">start delay</a> can be used to cause the <a data-link-type="dfn" href="#active-interval">active
interval</a> of two children to overlap.
Note that the <a data-link-type="dfn" href="#start-delay">start delay</a> affects the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of subsequent
children in the group.</p>

</div>


   <h5 class="heading settled" data-level="3.13.4.2" id="the-intrinsic-iteration-duration-of-an-animation-sequence"><span class="secno">3.13.4.2. </span><span class="content">The intrinsic iteration duration of an animation sequence</span><a class="self-link" href="#the-intrinsic-iteration-duration-of-an-animation-sequence"></a></h5>


   <p>The <a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration duration</a> of an <a data-link-type="dfn" href="#animation-sequence">animation
sequence</a> is equivalent to the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of a hypothetical
<a data-link-type="dfn" href="#child-animation-node">child animation node</a> appended to the group’s children
calculated according to the definition in <a href="#the-start-time-of-children-of-an-animation-sequence">§3.13.4.1 The start time of children of an animation sequence</a> unless that produces a negative value, in
which case the <a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration duration</a> is zero.</p>


   <p>As a result, if the <a data-link-type="dfn" href="#animation-sequence">animation sequence</a> has no <a data-link-type="dfn" href="#child-animation-node">child
animation nodes</a> the <a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration duration</a> will be
zero.</p>

   <h3 class="heading settled" data-level="3.14" id="animations"><span class="secno">3.14. </span><span class="content">Animations</span><a class="self-link" href="#animations"></a></h3>


   <p><dfn data-dfn-type="dfn" data-noexport="" id="concept-animation">Animations<a class="self-link" href="#concept-animation"></a></dfn> are a kind of <a data-link-type="dfn" href="#animation-node">animation
node</a> that apply an <a data-link-type="dfn" href="#animation-effect">animation effect</a> or a <a data-link-type="dfn" href="#custom-effect">custom effect</a>
to an element or pseudo-element such as <code>::before</code> or
<code>::after</code> <a data-link-type="biblio" href="#biblio-select">[SELECT]</a> referred to as the <dfn data-dfn-type="dfn" data-noexport="" id="animation-target">animation
target<a class="self-link" href="#animation-target"></a></dfn>.</p>


   <h4 class="heading settled" data-level="3.14.1" id="calculating-the-time-fraction"><span class="secno">3.14.1. </span><span class="content">Calculating the time fraction</span><a class="self-link" href="#calculating-the-time-fraction"></a></h4>


   <p>Before passing the <a data-link-type="dfn" href="#transformed-time">transformed time</a> of an <a data-link-type="dfn" href="#concept-animation">animation</a> to
its <a data-link-type="dfn" href="#animation-effect">animation effect</a> it is converted to a <em>time
fraction</em>.
The <dfn data-dfn-type="dfn" data-noexport="" id="time-fraction">time fraction<a class="self-link" href="#time-fraction"></a></dfn> of an <a data-link-type="dfn" href="#animation-node">animation node</a> is calculated
by running the steps corresponding to the first matching condition from
the following:</p>


   <div class="switch">


    <dl>
     <dt data-md="">
      <p>If the <a data-link-type="dfn" href="#transformed-time">transformed time</a> is <a data-link-type="dfn" href="#unresolved">unresolved</a>, return
an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-value">time value</a>.</p>
      

     <dt data-md="">
      <p>If the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> is zero,</p>
      

     <dd data-md="">
      <p>the <a data-link-type="dfn" href="#time-fraction">time fraction</a> is as follows,</p>
      


      <div class="switch">


       <dl>
        <dt data-md="">
         <p>If <a data-link-type="dfn" href="#local-time">local time</a> &lt; <a data-link-type="dfn" href="#start-delay">start delay</a>,</p>
         

        <dd data-md="">
         <p>Return the result of recalculating the <a data-link-type="dfn" href="#transformed-time">transformed time</a>
using an <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> of 1.</p>
         


        <dt data-md="">
         <p>Otherwise,</p>
         

        <dd data-md="">


         <ol>
          <li data-md="">
           <p>Let <var>normalized active duration</var> be the result of
recalculating the <a data-link-type="dfn" href="#active-duration">active duration</a> using an
<a data-link-type="dfn" href="#iteration-duration">iteration duration</a> of 1.</p>
           

          <li data-md="">
           <p>Return the result of recalculating the <a data-link-type="dfn" href="#transformed-time">transformed
time</a> using a <a data-link-type="dfn" href="#local-time">local time</a> of <code><a data-link-type="dfn" href="#start-delay">start
delay</a> + <var>normalized active duration</var></code>
and an <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> of 1.</p>
           
</ol></dl>
</div>
      


     <dt data-md="">
      <p>Otherwise,</p>
      

     <dd data-md="">
      <p>Return <a data-link-type="dfn" href="#transformed-time">transformed time</a> / <a data-link-type="dfn" href="#iteration-duration">iteration duration</a>.</p>
      
</dl>
</div>


   <p class="note" role="note">Note: Since <a data-link-type="dfn" href="#timing-function">timing functions</a> are allowed to produce output times
    outside the range [0, 1] it is possible that the value calculated for
    a <a data-link-type="dfn" href="#time-fraction">time fraction</a> also lies outside this range.</p>






   <h2 class="heading settled" data-level="4" id="animation-model"><span class="secno">4. </span><span class="content">Animation Model</span><a class="self-link" href="#animation-model"></a></h2>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>The Web Animations <em>animation model</em> takes the <a data-link-type="dfn" href="#time-fraction">time
fractions</a> and <a data-link-type="dfn" href="#current-iteration">current iteration</a> values produced by the
<em>timing model</em> for a given <a data-link-type="dfn" href="#concept-animation">animation</a> and
applies it as the input to the <a data-link-type="dfn" href="#concept-animation">animation</a>’s
<a data-link-type="dfn" href="#animation-effect">animation effect</a>.</p>


    <p>The output of each <a data-link-type="dfn" href="#animation-effect">animation effect</a> is then combined with other
<a data-link-type="dfn" href="#animation-effect">animation effects</a> using an <a data-link-type="dfn" href="#animation-stack">animation stack</a> before being
applied to the target properties (see <a href="#combining-animations">§4.2 Combining animations</a>).</p>

</div>


   <h3 class="heading settled" data-level="4.1" id="animation-effects"><span class="secno">4.1. </span><span class="content">Animation effects</span><a class="self-link" href="#animation-effects"></a></h3>


   <p>An <dfn data-dfn-type="dfn" data-noexport="" id="animation-effect">animation effect<a class="self-link" href="#animation-effect"></a></dfn> takes a <a data-link-type="dfn" href="#time-fraction">time fraction</a> and
a <a data-link-type="dfn" href="#current-iteration">current iteration</a> value and uses them to calculate an
<a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation value</a> for its <a data-link-type="dfn" href="#target-property">target properties</a>.  Each <a data-link-type="dfn" href="#concept-animation">animation</a>
may have at most one <a data-link-type="dfn" href="#animation-effect">animation effect</a> associated with it.</p>


   <p>Since the result of an <a data-link-type="dfn" href="#animation-effect">animation effect</a> is based on the
<a data-link-type="dfn" href="#time-fraction">time fraction</a> and <a data-link-type="dfn" href="#current-iteration">current iteration</a> value, it is updated
whenever the timing model is <a data-link-type="dfn" href="#sampling">sampled</a>.</p>


   <h4 class="heading settled" data-level="4.1.1" id="target-properties"><span class="secno">4.1.1. </span><span class="content">Target properties</span><a class="self-link" href="#target-properties"></a></h4>


   <p>Each <a data-link-type="dfn" href="#animation-effect">animation effect</a> can have zero or more associated
<dfn data-dfn-type="dfn" data-lt="target property" data-noexport="" id="target-property">target properties<a class="self-link" href="#target-property"></a></dfn>.</p>


   <p><a data-link-type="dfn" href="#target-property">Target properties</a> may be CSS properties
or DOM attributes.
If a given <a data-link-type="dfn" href="#animation-target">animation target</a> has an attribute with the same name
as a CSS property, any <a data-link-type="dfn" href="#target-property">target property</a> of that name is taken to
refer to to the CSS property.</p>


   <p class="note" role="note">Note: If there ever exists a situation where we need to animate an attribute
      with the same name as a property (other than a <a href="http://www.w3.org/TR/SVG2/intro.html#TermPresentationAttribute">presentation
      attribute</a> <a data-link-type="biblio" href="#biblio-svg2">[SVG2]</a>) then we will need to introduce
      a disambiguation strategy. Generally, however, such naming should be
      avoided.</p>


   <h4 class="heading settled" data-level="4.1.2" id="procedures-for-animating-properties"><span class="secno">4.1.2. </span><span class="content">Procedures for animating properties</span><a class="self-link" href="#procedures-for-animating-properties"></a></h4>


   <p>Unless specifically defined not to be, all properties are considered
<dfn data-dfn-type="dfn" data-noexport="" id="concept-animatable">animatable<a class="self-link" href="#concept-animatable"></a></dfn>.
In order to animate a <a data-link-type="dfn" href="#target-property">target property</a>, the following procedures
must be defined.</p>


   <ul>
    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-lt="animation interpolation" data-noexport="" id="animation-interpolation">interpolation<a class="self-link" href="#animation-interpolation"></a></dfn> —
given two target property values <var>V</var><sub>start</sub> and
<var>V</var><sub>end</sub>, produces an intermediate value
<var>V</var><sub>res</sub> at a distance of <var>p</var> along the
interval between <var>V</var><sub>start</sub> and
<var>V</var><sub>end</sub> such that
<var>p</var> = 0 produces <var>V</var><sub>start</sub> and
<var>p</var> = 1 produces <var>V</var><sub>end</sub>.
The range of <var>p</var> is (−∞, ∞) due to the
effect of <a data-link-type="dfn" href="#timing-function">timing functions</a>.
As a result, this procedure must also define extrapolation
behavior for <var>p</var> outside [0, 1].</p>
     


    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-lt="animation addition" data-noexport="" id="animation-addition">addition<a class="self-link" href="#animation-addition"></a></dfn> — given two
target property values
<var>V</var><sub>a</sub> and <var>V</var><sub>b</sub>, returns the
sum of the two properties, <var>V</var><sub>result</sub>.
For addition that is not commutative (for example, matrix
multiplication) <var>V</var><sub>a</sub> represents the first term
of the operation and <var>V</var><sub>b</sub> represents the
second.</p>
     


     <div class="informative-bg"><em>This section is non-normative</em>


      <p>While <a data-link-type="dfn" href="#animation-addition">addition</a> can often be
expressed in terms of the same weighted sum function used to
define <a data-link-type="dfn" href="#animation-interpolation">interpolation</a>,
this is not always the case.
For example, interpolation of transform matrices involves
decomposing and interpolating the matrix components whilst
addition relies on matrix multiplication.</p>

</div>
     


    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-lt="animation accumulation" data-noexport="" id="animation-accumulation">accumulation<a class="self-link" href="#animation-accumulation"></a></dfn> —
given two target property values
<var>V</var><sub>a</sub> and <var>V</var><sub>b</sub>, returns the
result, <var>V</var><sub>result</sub>, of combining
the two operands such that <var>V</var><sub>b</sub> is treated as
a <em>delta</em> from <var>V</var><sub>a</sub>.
For accumulation that is not commutative (for example,
accumulation of mismatched transform lists)
<var>V</var><sub>a</sub> represents the first term of the
operation and <var>V</var><sub>b</sub> represents the second.</p>
     


     <div class="informative-bg"><em>This section is non-normative</em>


      <p>For many types of animation such as numbers or lengths, <a data-link-type="dfn" href="#animation-accumulation">accumulation</a> is defined to
be identical to <a data-link-type="dfn" href="#animation-addition">addition</a>.</p>


      <p>A common case where the definitions differ is for list-based
types where <a data-link-type="dfn" href="#animation-addition">addition</a> may be
defined as appending to a list
whilst <a data-link-type="dfn" href="#animation-accumulation">accumulation</a> may
be defined as component-based addition.
For example, the filter list values "blur(2)" and
"blur(3)", when <a data-link-type="dfn" href="#animation-addition">added</a>
together may produce "blur(2) blur(3)", but when
<a data-link-type="dfn" href="#animation-accumulation">accumulated</a>,
may produce "blur(5)".</p>

</div>
     


    <li data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="distance-computation">distance computation<a class="self-link" href="#distance-computation"></a></dfn> — given two target property
values <var>V</var><sub>start</sub> and
<var>V</var><sub>end</sub>, calculates some notion of scalar
distance between the values, <var>distance</var>.</p>
     
</ul>

   <h4 class="heading settled" data-level="4.1.3" id="specific-animation-behaviors"><span class="secno">4.1.3. </span><span class="content">Specific animation behaviors</span><a class="self-link" href="#specific-animation-behaviors"></a></h4>


   <p>The specific procedures used for animating a given <a data-link-type="dfn" href="#target-property">target
property</a> are referred to as the property’s <dfn data-dfn-type="dfn" data-noexport="" id="animation-behavior">animation
behavior<a class="self-link" href="#animation-behavior"></a></dfn>.</p>


   <p>The <a data-link-type="dfn" href="#animation-behavior">animation behavior</a> of CSS properties is defined by the
"Animatable:" line in the summary of the property’s definition or in
<a data-link-type="biblio" href="#biblio-css3-transitions">[CSS3-TRANSITIONS]</a> for properties that lack a such a line.</p>


   <p class="issue" id="issue-48287af4"><a class="self-link" href="#issue-48287af4"></a>The default <a data-link-type="dfn" href="#animation-behavior">animation behavior</a> for CSS properties is "as
       string".  Should this be defined here or in CSS Animations Level 4?</p>


   <p>For DOM attributes, the <a data-link-type="dfn" href="#animation-behavior">animation behavior</a> is defined alongside
the attribute definition.
Unlike CSS properties, if such a definition is not provided the
default <a data-link-type="dfn" href="#animation-behavior">animation behavior</a> is “<a data-link-type="dfn" href="#concept-not-animatable">not animatable</a>”.</p>


   <p>Following is a series of pre-defined <a data-link-type="dfn" href="#animation-behavior">animation behaviors</a>.
<a data-link-type="biblio" href="#biblio-css3-transitions">[CSS3-TRANSITIONS]</a> provides further CSS-specific <a data-link-type="dfn" href="#animation-behavior">animation
behaviors</a>.</p>


   <p>For <a data-link-type="dfn" href="#animation-behavior">animation behaviors</a> that do not define a specific procedure
for <a data-link-type="dfn" href="#animation-addition">addition</a> or which are defined as
<dfn data-dfn-type="dfn" data-noexport="" id="not-additive">not additive<a class="self-link" href="#not-additive"></a></dfn>, the <a data-link-type="dfn" href="#animation-addition">addition procedure</a> is simply
<var>V</var><sub>res</sub> = <var>V</var><sub>b</sub>.</p>


   <p>For <a data-link-type="dfn" href="#animation-behavior">animation behaviors</a> that do not define a specific procedure
for <a data-link-type="dfn" href="#animation-accumulation">accumulation</a>, the <a data-link-type="dfn" href="#animation-accumulation">accumulation procedure</a> is identical
to the <a data-link-type="dfn" href="#animation-addition">addition procedure</a> for that
behavior.</p>


   <p>For <a data-link-type="dfn" href="#animation-behavior">animation behaviors</a> that do not define a specific procedure
for <a data-link-type="dfn" href="#distance-computation">distance computation</a> or which are defined as <dfn data-dfn-type="dfn" data-noexport="" id="not-paceable">not
paceable<a class="self-link" href="#not-paceable"></a></dfn>, the <a data-link-type="dfn" href="#distance-computation">distance computation</a> procedure is simply
<var>distance</var> = 1.</p>


   <h5 class="heading settled" data-level="4.1.3.1" id="not-animatable-section"><span class="secno">4.1.3.1. </span><span class="content">Not animatable</span><a class="self-link" href="#not-animatable-section"></a></h5>


   <p>Some properties are specifically defined as <dfn data-dfn-type="dfn" data-noexport="" id="concept-not-animatable">not animatable<a class="self-link" href="#concept-not-animatable"></a></dfn>.
For example, properties defining animation parameters are <a data-link-type="dfn" href="#concept-not-animatable">not animatable</a>
since doing so would create complex recursive behavior.</p>


   <p>Unlike other <a data-link-type="dfn" href="#animation-behavior">animation behaviors</a>, no procedures for
<a data-link-type="dfn" href="#animation-interpolation">interpolation</a>,
<a data-link-type="dfn" href="#animation-addition">addition</a> and <a data-link-type="dfn" href="#distance-computation">distance
computation</a> are defined for properties whose <a data-link-type="dfn" href="#animation-behavior">animation
behavior</a> is <a data-link-type="dfn" href="#concept-not-animatable">not animatable</a> since these
properties should not be modified.</p>


   <p>An <a data-link-type="dfn" href="#animation-effect">animation effect</a> that targets a property that is
<a data-link-type="dfn" href="#concept-not-animatable">not animatable</a> will still exhibit the
usual behavior for an <a data-link-type="dfn" href="#animation-node">animation node</a> such as
occupying time in an <a data-link-type="dfn" href="#animation-sequence">animation sequence</a> and
delaying the fulfilment of a <a data-link-type="dfn" href="#player">player</a>’s <a data-link-type="dfn" href="#current-finished-promise">current finished promise</a>.</p>


   <h5 class="heading settled" data-level="4.1.3.2" id="animatable-as-string-section"><span class="secno">4.1.3.2. </span><span class="content">Animatable as string</span><a class="self-link" href="#animatable-as-string-section"></a></h5>


   <p>A <a data-link-type="dfn" href="#target-property">target property</a> that is <dfn data-dfn-type="dfn" data-noexport="" id="animatable-as-string">animatable as string<a class="self-link" href="#animatable-as-string"></a></dfn>
has the following <a data-link-type="dfn" href="#animation-behavior">animation behavior</a>:</p>


   <ul>
    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-interpolation">interpolation</a>:</p>
     

     <div aria-describedby="math-string-interpolation" role="math" style="display: inline">

      <math xmlns="http://www.w3.org/1998/Math/MathML">
  
       <msub>
        <mi>V</mi>
        <mn>res</mn>
       </msub>
       <mo>=</mo>
  
       <mrow>
    
        <mfenced close="" open="{">
      
         <mtable>
        
          <mtr>
          
           <mtd columnalign="left">
            
            <msub>
             <mi>V</mi>
             <mn>start</mn>
            </msub>
            
          
           </mtd>
           
          
           <mtd columnalign="left">
            
            <mtext>if </mtext>
            <mi>p</mi>
            
            
            <mo>&lt;</mo>
            <mn>0.5</mn>
            
          
           </mtd>
           
        
          </mtr>
          
        
          <mtr>
          
           <mtd columnalign="left">
            
            <msub>
             <mi>V</mi>
             <mn>end</mn>
            </msub>
            
          
           </mtd>
           
          
           <mtd columnalign="left">
            
            <mtext>if </mtext>
            <mi>p</mi>
            
            
            <mo>≥</mo>
            <mn>0.5</mn>
            
          
           </mtd>
           
        
          </mtr>
          
      
         </mtable>
         
    
        </mfenced>
        
  
       </mrow>
</math>

      <div id="math-string-interpolation">
  <var>V</var><sub>res</sub> =
    <var>V</var><sub>start</sub>, if <var>p</var> &lt; 0.5 or
    <var>V</var><sub>end</sub>, if <var>p</var> ≥ 0.5
</div>
</div>
     
</ul>

   <h5 class="heading settled" data-level="4.1.3.3" id="animatable-as-real-number-section"><span class="secno">4.1.3.3. </span><span class="content">Animatable as real number</span><a class="self-link" href="#animatable-as-real-number-section"></a></h5>


   <p>A <a data-link-type="dfn" href="#target-property">target property</a> that is <dfn data-dfn-type="dfn" data-noexport="" id="animatable-as-real-number">animatable as real
number<a class="self-link" href="#animatable-as-real-number"></a></dfn> has the following <a data-link-type="dfn" href="#animation-behavior">animation behavior</a>:</p>


   <ul>
    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-interpolation">interpolation</a>:
<var>V</var><sub>res</sub> =
  (1 - <var>p</var>) × <var>V</var><sub>start</sub> +
  <var>p</var> × <var>V</var><sub>end</sub></p>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-addition">addition</a>:
  <var>V</var><sub>a</sub> + <var>V</var><sub>b</sub></p>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#distance-computation">distance computation</a>:
<var>distance</var> =
  |<var>V</var><sub>end</sub> - <var>V</var><sub>start</sub>|</p>
     
</ul>

   <h5 class="heading settled" data-level="4.1.3.4" id="animatable-as-length-percentage-or-calc-section"><span class="secno">4.1.3.4. </span><span class="content">Animatable as length, percentage, or calc</span><a class="self-link" href="#animatable-as-length-percentage-or-calc-section"></a></h5>


   <p>A <a data-link-type="dfn" href="#target-property">target property</a> that is <dfn data-dfn-type="dfn" data-noexport="" id="animatable-as-length-percentage-or-calc">animatable as length,
percentage, or calc<a class="self-link" href="#animatable-as-length-percentage-or-calc"></a></dfn> has the following <a data-link-type="dfn" href="#animation-behavior">animation
behavior</a>:</p>


   <ul>
    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-interpolation">interpolation</a>:
as defined in <a data-link-type="biblio" href="#biblio-css3-transitions">[CSS3-TRANSITIONS]</a>.</p>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-addition">addition</a>:
calc(<var>V</var><sub>a</sub> + <var>V</var><sub>b</sub>)<br>
(Nested <code>calc()</code> functions are expanded when
determining the computed value as defined in <a href="http://www.w3.org/TR/css3-values/#calc-computed-value">CSS
Values and Units</a> <a data-link-type="biblio" href="#biblio-css3val">[CSS3VAL]</a>.)</p>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#distance-computation">distance computation</a>: as with <a data-link-type="dfn" href="#animatable-as-real-number">animatable as real
number</a> but using the <a href="http://www.w3.org/TR/CSS2/cascade.html#used-value">used
value</a> <a data-link-type="biblio" href="#biblio-css21">[CSS21]</a> for <var>V</var><sub>start</sub> and
<var>V</var><sub>end</sub>.</p>
     
</ul>

   <h5 class="heading settled" data-level="4.1.3.5" id="animatable-as-color-section"><span class="secno">4.1.3.5. </span><span class="content">Animatable as color</span><a class="self-link" href="#animatable-as-color-section"></a></h5>


   <p>A <a data-link-type="dfn" href="#target-property">target property</a> that is <dfn data-dfn-type="dfn" data-noexport="" id="animatable-as-color">animatable as color<a class="self-link" href="#animatable-as-color"></a></dfn> has
the following <a data-link-type="dfn" href="#animation-behavior">animation behavior</a>:</p>


   <ul>
    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-interpolation">interpolation</a>:
as defined in <a data-link-type="biblio" href="#biblio-css3-transitions">[CSS3-TRANSITIONS]</a>.</p>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-addition">addition</a>:
as with <a data-link-type="dfn" href="#animatable-as-real-number">animatable as real number</a> but performed on each
RGBA color component in premultiplied space.</p>
     


     <p class="note" role="note">Note: Since negative color is not currently supported, clamping of
      the channel values may be performed upon each addition or once
      when <a data-link-type="dfn" href="#composition">composition</a> is complete.</p>
     

     <p></p>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#distance-computation">distance computation</a>:</p>
     

     <div aria-describedby="math-color-distance" role="math">
  
      <math xmlns="http://www.w3.org/1998/Math/MathML">
  
       <mrow>
    
        <mi>distance</mi>
        <mo>=</mo>
        
    
        <msqrt>
      
         <msup>
        
          <mrow>
          
           <mfenced close=")" open="(" separators=",">
            
            <mrow>
             <msub>
              <mi>R</mi>
              <mn>end</mn>
             </msub>
             
                  
             <mo>-</mo>
             
                  
             <msub>
              <mi>R</mi>
              <mn>start</mn>
             </msub>
            </mrow>
            
          
           </mfenced>
           
        
          </mrow>
          <mn>2</mn>
          
      
         </msup>
         
      
         <mo>+</mo>
         
      
         <msup>
        
          <mrow>
          
           <mfenced close=")" open="(" separators=",">
            
            <mrow>
             <msub>
              <mi>G</mi>
              <mn>end</mn>
             </msub>
             
                  
             <mo>-</mo>
             
                  
             <msub>
              <mi>G</mi>
              <mn>start</mn>
             </msub>
            </mrow>
            
          
           </mfenced>
           
        
          </mrow>
          <mn>2</mn>
          
      
         </msup>
         
      
         <mo>+</mo>
         
      
         <msup>
        
          <mrow>
          
           <mfenced close=")" open="(" separators=",">
            
            <mrow>
             <msub>
              <mi>B</mi>
              <mn>end</mn>
             </msub>
             
                  
             <mo>-</mo>
             
                  
             <msub>
              <mi>B</mi>
              <mn>start</mn>
             </msub>
            </mrow>
            
            
           </mfenced>
           
        
          </mrow>
          <mn>2</mn>
          
      
         </msup>
         
      
         <mo>+</mo>
         
      
         <msup>
        
          <mrow>
          
           <mfenced close=")" open="(" separators=",">
            
            <mrow>
             <msub>
              <mi>A</mi>
              <mn>end</mn>
             </msub>
             
                  
             <mo>-</mo>
             
                  
             <msub>
              <mi>A</mi>
              <mn>start</mn>
             </msub>
            </mrow>
            
          
           </mfenced>
           
        
          </mrow>
          <mn>2</mn>
          
      
         </msup>
         
    
        </msqrt>
        
  
       </mrow>
       
  
      </math>

  
      <div id="math-color-distance">
  distance = sqrt((R<sub>end</sub> - R<sub>start</sub>)^2 + (G<sub>end</sub> - G<sub>start</sub>)^2 + (B<sub>end</sub> - B<sub>start</sub>)^2 + (A<sub>end</sub> - A<sub>start</sub>)^2)
  </div>

</div>
     


     <p>where &lt;<var>R|G|B|A</var><sub>start|end</sub>>
represents the red, green, blue, or alpha channel of
<var>V</var><sub>start</sub> or <var>V</var><sub>end</sub>
respectively.
Each value is normalized to the [0.0, 1.0] range and expressed
in premultiplied color space.</p>
     
</ul>

   <h5 class="heading settled" data-level="4.1.3.6" id="animatable-as-transform-list-section"><span class="secno">4.1.3.6. </span><span class="content">Animatable as transform list</span><a class="self-link" href="#animatable-as-transform-list-section"></a></h5>


   <p>A <a data-link-type="dfn" href="#target-property">target property</a> that is <dfn data-dfn-type="dfn" data-noexport="" id="animatable-as-transform-list">animatable as transform
list<a class="self-link" href="#animatable-as-transform-list"></a></dfn> has the following <a data-link-type="dfn" href="#animation-behavior">animation behavior</a>:</p>


   <ul>
    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-interpolation">interpolation</a>:
as defined in <a href="http://www.w3.org/TR/css3-transforms/#interpolation-of-transforms">Interpolation
of Transforms</a> <a data-link-type="biblio" href="#biblio-css3-transforms">[CSS3-TRANSFORMS]</a>.</p>
     


    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-addition">addition</a>: performed by
concatenating transform lists as
‘<var>V</var><sub>a</sub> <var>V</var><sub>b</sub>’.</p>
     


    <li data-md="">
     <p><a data-link-type="dfn" href="#animation-accumulation">accumulation</a>:</p>
     


     <ol>
      <li data-md="">
       <p>Beginning at the end of each list, <var>V</var><sub>a</sub>
and <var>V</var><sub>b</sub>,
find the largest contiguous portion of each list where the
corresponding list elements from each list have the same
transform type.
Call the matching portions from <var>V</var><sub>a</sub> and
<var>V</var><sub>b</sub>, <var>V</var><sub>matching-a</sub>
and
<var>V</var><sub>matching-b</sub> respectively and likewise
<var>V</var><sub>remainder-a</sub> and
<var>V</var><sub>remainder-b</sub> for the non-matching
parts.</p>
       

       <p class="issue" id="issue-3540bd4c"><a class="self-link" href="#issue-3540bd4c"></a>
  We should probably expand 2d functions to their 3d
  equivalents before matching?
</p>
       

      <li data-md="">
       <p>Let <var>V</var><sub>combined</sub> be a transform list
combining <var>V</var><sub>matching-a</sub> and
<var>V</var><sub>matching-b</sub> by adding the numeric
components of each corresponding function.</p>
       

       <p class="issue" id="issue-7c98bbea"><a class="self-link" href="#issue-7c98bbea"></a>
  This needs to be more specific, e.g. when combining
  <code>translate(20px)</code> and <code>translate(30px
  10px)</code> we have to expand the first function to
  <code>translate(20px 0px)</code> first.
  Probably need to define unit conversion too.
</p>
       

      <li data-md="">
       <p>The result of accumulation is a transform list created by <a data-link-type="dfn" href="#animation-addition">adding</a> the combined result
with the non-matching portions of the two lists as follows:
‘<var>V</var><sub>remainder-a</sub>
<var>V</var><sub>remainder-b</sub>
<var>V</var><sub>combined</sub>’.</p>
       
</ol>
     

    <li data-md="">
     <p><a data-link-type="dfn" href="#distance-computation">distance computation</a>: <span class="todo">See issue
below</span></p>
     
</ul>

   <div class="issue" id="issue-b82dbcbe"><a class="self-link" href="#issue-b82dbcbe"></a>


    <p>For <a data-link-type="dfn" href="#distance-computation">distance computation</a> we previously defined it as follows:</p>


    <ol>
     <li data-md="">
      <p>Look only at the first component of the two lists</p>
      

     <li data-md="">
      <p>If both are translate → euclidean distance</p>
      

     <li data-md="">
      <p>If both are scale → absolute difference</p>
      

     <li data-md="">
      <p>If both are rotate → absolute difference</p>
      

     <li data-md="">
      <p>If both match but are something else → use linear</p>
      

     <li data-md="">
      <p>If they don’t match → use matrix decomposition and
euclidean distance between translate components</p>
      
</ol>

    <p>This seems really arbitrary, especially part 5.</p>


    <p>Also, looking at only the first component seems odd.
    Going through each component, working out the distance and then
    getting the square of the distance also seems much more consistent
    with what we do elsewhere.</p>

</div>


   <h5 class="heading settled" data-level="4.1.3.7" id="other-animation-behaviors"><span class="secno">4.1.3.7. </span><span class="content">Other animation behaviors</span><a class="self-link" href="#other-animation-behaviors"></a></h5>


   <p>The set of <a data-link-type="dfn" href="#animation-behavior">animation behaviors</a> defined here may be extended
by other specifications.
For example, properties with using the &lt;image> type are
animated using the interpolation behavior defined in <a href="http://dev.w3.org/csswg/css-images-4/#interpolation">CSS Image
Values and Replaced Content</a>
<a data-link-type="biblio" href="#biblio-css4-images">[CSS4-IMAGES]</a>.</p>


   <div class="issue" id="issue-2b25d150"><a class="self-link" href="#issue-2b25d150"></a>


    <p>There are a bunch of CSS properties for which distance (and in
    some cases addition) is not defined or which need special
    handling.</p>


    <p>For example,</p>


    <ul>
     <li data-md="">
      <p>font-stretch (an enum but handled like an integer)</p>
      

     <li data-md="">
      <p>visibility (0 or 1 depending on if endpoints match or not)</p>
      

     <li data-md="">
      <p>flex-grow and flex-shrink which allow animation only if one of
the endpoints is 0)</p>
      

     <li data-md="">
      <p>value pairs, triples (use square distance)</p>
      

     <li data-md="">
      <p>rects (use square distance)</p>
      

     <li data-md="">
      <p>dash arrays (square distance but a bit weird due to
percentages)</p>
      

     <li data-md="">
      <p>shadows (square distance of components)</p>
      

     <li data-md="">
      <p>filters (undefined)</p>
      

     <li data-md="">
      <p>background-position (special list handling needed)</p>
      

     <li data-md="">
      <p>pair lists</p>
      
</ul>

    <p>Should we define these here or in the CSS Animation 4 spec?</p>

</div>


   <h4 class="heading settled" data-level="4.1.4" id="intermediate-animation-values"><span class="secno">4.1.4. </span><span class="content">Intermediate animation values</span><a class="self-link" href="#intermediate-animation-values"></a></h4>


   <p>Given a <a data-link-type="dfn" href="#time-fraction">time fraction</a>, a <a data-link-type="dfn" href="#current-iteration">current iteration</a>, and an
<a data-link-type="dfn" href="#underlying-value">underlying value</a>, an <a data-link-type="dfn" href="#animation-effect">animation effect</a> produces
an <dfn data-dfn-type="dfn" data-noexport="" id="intermediate-animation-value">intermediate animation value<a class="self-link" href="#intermediate-animation-value"></a></dfn> for each <a data-link-type="dfn" href="#concept-animatable">animatable</a>
<a data-link-type="dfn" href="#target-property">target property</a>.
The procedure for calculating this value depends on the specific
type of <a data-link-type="dfn" href="#animation-effect">animation effect</a> and is defined subsequently (see <a href="#the-intermediate-animation-value-of-a-keyframe-animation-effect">§4.3.2 The intermediate animation value of a keyframe animation effect</a>).</p>


   <p>Before being applied to the <a data-link-type="dfn" href="#target-property">target
properties</a>,
these <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation values</a> are composed together using
the process defined in <a href="#combining-animations">§4.2 Combining animations</a>.</p>


   <h3 class="heading settled" data-level="4.2" id="combining-animations"><span class="secno">4.2. </span><span class="content">Combining animations</span><a class="self-link" href="#combining-animations"></a></h3>

   <div class="informative-bg"><em>This section is non-normative</em>


    <p>After calculating the <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation values</a> for an
<a data-link-type="dfn" href="#animation-effect">animation effect</a>, they are applied to the <a data-link-type="dfn" href="#animation-effect">animation
effect</a>’s <a data-link-type="dfn" href="#target-property">target properties</a>.</p>


    <p>Since it is possible for multiple <a data-link-type="dfn" href="#in-effect">in effect</a> <a data-link-type="dfn" href="#concept-animation">animations</a> to target
the same property it is often necessary to combine the results of several
<a data-link-type="dfn" href="#animation-effect">animation effects</a> together.
This process is called <dfn data-dfn-type="dfn" data-lt="composition" data-noexport="" id="composition">compositing<a class="self-link" href="#composition"></a></dfn> and is
based on establishing an <a data-link-type="dfn" href="#animation-stack">animation stack</a> for each property
targetted by an <a data-link-type="dfn" href="#in-effect">in effect</a> <a data-link-type="dfn" href="#animation-effect">animation effect</a>.</p>


    <p>After compositing the results of <a data-link-type="dfn" href="#animation-effect">animation
effects</a> together, the composited result is combined with other
values specified for the <a data-link-type="dfn" href="#target-property">target property</a>.</p>


    <p>For a CSS <a data-link-type="dfn" href="#target-property">target property</a> the arrangement is illustrated below:</p>


    <div class="figure">
<img alt="Overview of the application of intermediate animation values
to their target properties" src="img/animation-cascade.svg" width="450">
</div>

    <p class="caption">
Overview of the application of <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation values</a> to
their <a data-link-type="dfn" href="#target-property">target properties</a>.<br>
The results of <a data-link-type="dfn" href="#animation-effect">animation effects</a> targetting the same property
are composited together using an <a data-link-type="dfn" href="#animation-stack">animation stack</a>.<br>
The result of this composition is written to an animation stylesheet
that is more important than other stylesheets but less than any
<code>!important</code> rules.
</p>


    <p>For a <a data-link-type="dfn" href="#target-property">target property</a> that specifies a DOM attribute, the
composited result is combined with the value of the attribute
specified in the DOM or the lacuna value for that attribute if it is
not specified.</p>


    <p>For the first part of this operation—combining <a data-link-type="dfn" href="#intermediate-animation-value">intermediate
animation values</a> that target the same <a data-link-type="dfn" href="#target-property">property</a>— it is necessary to
determine both
<em>how</em> the <a data-link-type="dfn" href="#animation-effect">animation effects</a>
associated with the <a data-link-type="dfn" href="#concept-animation">animations</a> are combined
with one another,
as well as the <em>order</em> in which they are applied, that is,
their relative <em>priority</em>.</p>


    <p>The matter of <em>how</em> <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation values</a> are
combined is governed by the <a data-link-type="dfn" href="#composite-operation">composite operation</a> of
the corresponding <a data-link-type="dfn" href="#animation-effect">animation effects</a>.</p>


    <p>The relative <em>priority</em> of <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation values</a>
is determined by an <a data-link-type="dfn" href="#animation-stack">animation stack</a> established for each
animated property.</p>
</div>


   <h4 class="heading settled" data-level="4.2.1" id="the-animation-stack"><span class="secno">4.2.1. </span><span class="content">The animation stack</span><a class="self-link" href="#the-animation-stack"></a></h4>


   <p>Associated with each property <a data-link-type="dfn" href="#target-property">targetted</a>
by one or more <a data-link-type="dfn" href="#animation-effect">animation effects</a> is an <dfn data-dfn-type="dfn" data-noexport="" id="animation-stack">animation
stack<a class="self-link" href="#animation-stack"></a></dfn> that establishes the relative priority of the <a data-link-type="dfn" href="#animation-effect">animation
effects</a>.</p>


   <p>The relative priority of any two <a data-link-type="dfn" href="#animation-effect">animation
effects</a>, <var>A</var> and <var>B</var>, within an <a data-link-type="dfn" href="#animation-stack">animation
stack</a> is established by comparing the properties of the
<a data-link-type="dfn" href="#concept-animation">animations</a> applying <var>A</var> and
<var>B</var> as follows:</p>


   <ol>
    <li data-md="">
     <p>Let the <dfn data-dfn-type="dfn" data-noexport="" id="associated-player-of-an-animation-effect">associated player of an animation effect<a class="self-link" href="#associated-player-of-an-animation-effect"></a></dfn>
be the <a data-link-type="dfn" href="#player">player</a> <a data-link-type="dfn" href="#associated-with-a-player">associated</a> with the
<a data-link-type="dfn" href="#concept-animation">animation</a> that is applying the <a data-link-type="dfn" href="#animation-effect">animation
effect</a> to the property with which this <a data-link-type="dfn" href="#animation-stack">animation stack</a> is
associated.</p>
     

    <li data-md="">
     <p>Sort <var>A</var> and <var>B</var> by applying the following
conditions in turn until the order is resolved,</p>
     


     <ol>
      <li data-md="">
       <p>Sort <var>A</var> and <var>B</var> using any <a data-link-type="dfn" href="#custom-player-priority">custom
player priority</a> specified for the <a data-link-type="dfn" href="#associated-player-of-an-animation-effect">associated
player</a> of each of <var>A</var> and
<var>B</var> so that lower priorities sort first.</p>
       

      <li data-md="">
       <p>Sort by the <a data-link-type="dfn" href="#player-sequence-number">player sequence number</a> so that lower
sequence numbers sort first.</p>
       


      <li data-md="">
       <p>Sort <var>A</var> and <var>B</var> in <a data-link-type="dfn" href="#tree-order">tree order</a>.
(By this point, <var>A</var> and <var>B</var> must have the
same <a data-link-type="dfn" href="#player">player</a> since otherwise the order would have been
resolved in the previous step.)</p>
       
</ol></ol>

   <p><a data-link-type="dfn" href="#animation-effect">Animation effects</a> that sort earlier have <em>lower</em>
priority.</p>


   <h5 class="heading settled" data-level="4.2.1.1" id="the-custom-player-priority"><span class="secno">4.2.1.1. </span><span class="content">The custom player priority</span><a class="self-link" href="#the-custom-player-priority"></a></h5>


   <p>Each <a data-link-type="dfn" href="#player">player</a> has an associated numeric <dfn data-dfn-type="dfn" data-noexport="" id="custom-player-priority">custom player
priority<a class="self-link" href="#custom-player-priority"></a></dfn> that is used to provide high-level control of
animation priority for specifications layered on top of Web
Animations.
The initial value of the <a data-link-type="dfn" href="#custom-player-priority">custom player priority</a> is zero.</p>


   <div class="note" role="note">


    <p>Note that the <a data-link-type="dfn" href="#custom-player-priority">custom player priority</a> is primarily
intended to be used to prioritize animations at
a high-level, such as to prioritize animations <em>by type</em>.
For example, it can be used to ensure that CSS Animations always
override CSS Transitions.</p>


    <p>It is possible to control animation priority at a lower-level by
setting the <a data-link-type="dfn" href="#player-start-time">player start time</a> appropriately,
(possibly after making compensatory adjustments to the <a data-link-type="dfn" href="#start-delay">start
delay</a> of the <a data-link-type="dfn" href="#source-content">source content</a>) or influencing the
<a data-link-type="dfn" href="#player-sequence-number">player sequence number</a> by controlling when <a data-link-type="dfn" href="#player">players</a>
are created.</p>

</div>


   <h4 class="heading settled" data-level="4.2.2" id="calculating-the-result-of-an-animation-stack"><span class="secno">4.2.2. </span><span class="content">Calculating the result of an animation stack</span><a class="self-link" href="#calculating-the-result-of-an-animation-stack"></a></h4>


   <p>In order to calculate the final value of an <a data-link-type="dfn" href="#animation-stack">animation stack</a>,
the <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation values</a> of each
<a data-link-type="dfn" href="#animation-effect">animation effect</a> in the stack are combined in order of priority
from lowest to highest priority.</p>


   <p>Each step in the process of evaluating an <a data-link-type="dfn" href="#animation-stack">animation stack</a> takes
an <dfn data-dfn-type="dfn" data-noexport="" id="underlying-value">underlying value<a class="self-link" href="#underlying-value"></a></dfn> as input.</p>


   <p>For each <a data-link-type="dfn" href="#animation-effect">animation effect</a> in the stack, the appropriate
<a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation value</a> from the <a data-link-type="dfn" href="#animation-effect">animation effect</a>
is combined with the <a data-link-type="dfn" href="#underlying-value">underlying value</a> to produce a new value.
This resulting value becomes the <a data-link-type="dfn" href="#underlying-value">underlying value</a> for combining
the next <a data-link-type="dfn" href="#animation-effect">animation effect</a> in the stack.</p>


   <p>The final value of an <a data-link-type="dfn" href="#animation-stack">animation stack</a>, called the
<dfn data-dfn-type="dfn" data-noexport="" id="composited-value">composited value<a class="self-link" href="#composited-value"></a></dfn>, is simply the result of combining the
<a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation value</a> of the final (highest priority)
<a data-link-type="dfn" href="#animation-effect">animation effect</a> in the stack with the <a data-link-type="dfn" href="#underlying-value">underlying value</a>
at that point.</p>


   <h4 class="heading settled" data-level="4.2.3" id="animation-composition"><span class="secno">4.2.3. </span><span class="content">Animation composition</span><a class="self-link" href="#animation-composition"></a></h4>


   <p>The specific operation used to combine an <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation
value</a> with an <a data-link-type="dfn" href="#underlying-value">underlying value</a> is determined by the
<dfn data-dfn-type="dfn" data-noexport="" id="composite-operation">composite operation<a class="self-link" href="#composite-operation"></a></dfn> of the <a data-link-type="dfn" href="#animation-effect">animation effect</a> that
produced the <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation value</a>.</p>


   <p>This specification defines three <a data-link-type="dfn" href="#composite-operation">composite operations</a> as
follows:</p>


   <dl>
    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-lt="composite operation replace" data-noexport="" id="composite-operation-replace">replace<a class="self-link" href="#composite-operation-replace"></a></dfn></p>
     

    <dd data-md="">
     <p>The result of compositing the <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation value</a>
with the <a data-link-type="dfn" href="#underlying-value">underlying value</a> is simply the <a data-link-type="dfn" href="#intermediate-animation-value">intermediate
animation value</a>.</p>
     

    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-lt="composite operation add" data-noexport="" id="composite-operation-add">add<a class="self-link" href="#composite-operation-add"></a></dfn></p>
     

    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation value</a> is <a data-link-type="dfn" href="#animation-addition">added</a> to the <a data-link-type="dfn" href="#underlying-value">underlying
value</a>.
For <a data-link-type="dfn" href="#animation-behavior">animation behaviors</a> where the
<a data-link-type="dfn" href="#animation-addition">addition operation</a> is defined
such that it is not commutative, the order of the operands is
<code><a data-link-type="dfn" href="#underlying-value">underlying value</a> + <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation
value</a></code>.</p>
     

    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-lt="composite operation accumulate" data-noexport="" id="composite-operation-accumulate">accumulate<a class="self-link" href="#composite-operation-accumulate"></a></dfn></p>
    <p></p>

    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation value</a> is <a data-link-type="dfn" href="#animation-accumulation">accumulated</a>
onto the <a data-link-type="dfn" href="#underlying-value">underlying value</a>.
For <a data-link-type="dfn" href="#animation-behavior">animation behaviors</a> where the
<a data-link-type="dfn" href="#animation-accumulation">accumulation operation</a> is
defined such that it is not commutative, the order of the operands
is <a data-link-type="dfn" href="#underlying-value">underlying value</a> followed by <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation
value</a>.</p>
</dl>

   <h4 class="heading settled" data-level="4.2.4" id="applying-the-composited-result"><span class="secno">4.2.4. </span><span class="content">Applying the composited result</span><a class="self-link" href="#applying-the-composited-result"></a></h4>


   <p>The process for a applying a <a data-link-type="dfn" href="#composited-value">composited value</a> depends on if the
<a data-link-type="dfn" href="#target-property">target property</a> refers to a CSS property or a DOM attribute.</p>


   <h5 class="heading settled" data-level="4.2.4.1" id="applying-the-result-to-a-css-property"><span class="secno">4.2.4.1. </span><span class="content">Applying the result to a CSS property</span><a class="self-link" href="#applying-the-result-to-a-css-property"></a></h5>


   <p>Applying a <a data-link-type="dfn" href="#composited-value">composited value</a> to a CSS <a data-link-type="dfn" href="#target-property">target property</a>
depends on establishing an <a data-link-type="dfn" href="#animation-stylesheet">animation stylesheet</a>.</p>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="animation-stylesheet">animation stylesheet<a class="self-link" href="#animation-stylesheet"></a></dfn> contains
<a data-link-type="dfn" href="#composited-value">composited animation values</a>
and acts with a higher priority than all other stylesheets.
However, <code>!important</code> rules from all other stylesheets
act with a higher priority than the <a data-link-type="dfn" href="#animation-stylesheet">animation stylesheet</a>.
The <a data-link-type="dfn" href="#animation-stylesheet">animation stylesheet</a> is regenerated each time the
animation model is updated (see <a href="#animation-effects">§4.1 Animation effects</a>).</p>


   <p>The <a data-link-type="dfn" href="#composited-value">composited value</a> calculated for a CSS <a data-link-type="dfn" href="#target-property">target
property</a> is applied using the following process.</p>


   <ol>
    <li data-md="">
     <p>Calculate the <var>base value</var> of the property as
the value generated for that property by computing the <a href="http://www.w3.org/TR/CSS2/cascade.html#used-value">used
value</a> <a data-link-type="biblio" href="#biblio-css21">[CSS21]</a> for that property in the absence of the
<a data-link-type="dfn" href="#animation-stylesheet">animation stylesheet</a>.</p>
     

    <li data-md="">
     <p>Establish the <a data-link-type="dfn" href="#animation-stack">animation stack</a> for the property (see <a href="#the-animation-stack">§4.2.1 The animation stack</a>).</p>
     

    <li data-md="">
     <p>Calculate the <a data-link-type="dfn" href="#composited-value">composited value</a> of the <a data-link-type="dfn" href="#animation-stack">animation
stack</a> passing in the <var>base value</var> of the property
as the initial <a data-link-type="dfn" href="#underlying-value">underlying value</a> (see <a href="#calculating-the-result-of-an-animation-stack">§4.2.2 Calculating the result of an animation stack</a>).</p>
     

    <li data-md="">
     <p>Insert the <a data-link-type="dfn" href="#composited-value">composited value</a> into the <a data-link-type="dfn" href="#animation-stylesheet">animation
stylesheet</a>.</p>
     
</ol>

   <h5 class="heading settled" data-level="4.2.4.2" id="applying-the-composited-result-to-a-dom-attribute"><span class="secno">4.2.4.2. </span><span class="content">Applying the composited result to a DOM attribute</span><a class="self-link" href="#applying-the-composited-result-to-a-dom-attribute"></a></h5>


   <p>DOM attributes are, unless otherwise specified, <a data-link-type="dfn" href="#concept-not-animatable">not animatable</a>.
For each attribute that has a specific <a data-link-type="dfn" href="#animation-behavior">animation behavior</a>
associated with it, an attribute value to use when the attribute is
not specified or in error must be defined, referred to as the
<dfn data-dfn-type="dfn" data-noexport="" id="lacuna-value">lacuna value<a class="self-link" href="#lacuna-value"></a></dfn>.
For example, SVG2 (<a data-link-type="biblio" href="#biblio-svg2">[SVG2]</a>) defines <a href="http://www.w3.org/TR/SVG2/intro.html#TermLacunaValue">lacunae
values</a> for its attributes.</p>


   <p>The <a data-link-type="dfn" href="#composited-value">composited value</a> calculated for a DOM attribute <a data-link-type="dfn" href="#target-property">target
property</a> is applied using the following process.</p>


   <ol>
    <li data-md="">
     <p>Let the <var>base value</var> of the property be the value
specified for attribute in the DOM or,
if the attribute value is not specified in the DOM, the
<a data-link-type="dfn" href="#lacuna-value">lacuna value</a> for that attribute.</p>
     

    <li data-md="">
     <p>Establish the <a data-link-type="dfn" href="#animation-stack">animation stack</a> for the property (see <a href="#the-animation-stack">§4.2.1 The animation stack</a>).</p>
    <p></p>

    <li data-md="">
     <p>Calculate the <a data-link-type="dfn" href="#composited-value">composited value</a> of the <a data-link-type="dfn" href="#animation-stack">animation
stack</a> passing in the <var>base value</var> of the attribute
as the initial <a data-link-type="dfn" href="#underlying-value">underlying value</a> (see <a href="#calculating-the-result-of-an-animation-stack">§4.2.2 Calculating the result of an animation stack</a>).</p>
    <p></p>

    <li data-md="">
     <p>Record the <a data-link-type="dfn" href="#composited-value">composited value</a> as the <dfn data-dfn-type="dfn" data-noexport="" id="animated-attribute-value">animated
attribute value<a class="self-link" href="#animated-attribute-value"></a></dfn> of the attribute.</p>
</ol>

   <p>The <a data-link-type="dfn" href="#animated-attribute-value">animated attribute value</a> does not replace the value of
the attribute in the DOM although it may be accessible via some
other interface.
For all intents and purposes other than interaction with DOM
interfaces, user agents must treat the <a data-link-type="dfn" href="#animated-attribute-value">animated attribute
value</a> as the attribute value.</p>


   <h4 class="heading settled" data-level="4.2.5" id="animation-accumulation-section"><span class="secno">4.2.5. </span><span class="content">Animation accumulation</span><a class="self-link" href="#animation-accumulation-section"></a></h4>


   <p>Similar to the compositing performed between <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation
values</a> (see <a href="#animation-composition">§4.2.3 Animation composition</a>), the <dfn data-dfn-type="dfn" data-noexport="" id="iteration-composite-operation">iteration composite operation<a class="self-link" href="#iteration-composite-operation"></a></dfn>
determines how values are combined between successive iterations of
the same <a data-link-type="dfn" href="#concept-animation">animation</a>.</p>


   <p>This specification defines two <a data-link-type="dfn" href="#iteration-composite-operation">iteration composite operations</a>
as follows:</p>


   <dl>
    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-lt="iteration composite operation replace" data-noexport="" id="iteration-composite-operation-replace">replace<a class="self-link" href="#iteration-composite-operation-replace"></a></dfn></p>
     

    <dd data-md="">
     <p>Each successive iteration is calculated independently of previous
iterations.</p>
     

    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-lt="iteration composite operation accumulate" data-noexport="" id="iteration-composite-operation-accumulate">accumulate<a class="self-link" href="#iteration-composite-operation-accumulate"></a></dfn></p>
     

    <dd data-md="">
     <p>Successive iterations of the animation are <a data-link-type="dfn" href="#animation-accumulation">accumulated</a> with the
final value of the previous iteration.</p>
     


     <p>The application of the <a data-link-type="dfn" href="#iteration-composite-operation">iteration composite operation</a> is
incorporated in the calculation of the <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation
value</a> for each type of <a data-link-type="dfn" href="#animation-effect">animation effect</a>.</p>
     
</dl>

   <h3 class="heading settled" data-level="4.3" id="keyframe-animation-effects"><span class="secno">4.3. </span><span class="content">Keyframe animation effects</span><a class="self-link" href="#keyframe-animation-effects"></a></h3>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="keyframe-animation-effect">keyframe animation effect<a class="self-link" href="#keyframe-animation-effect"></a></dfn> is an <a data-link-type="dfn" href="#animation-effect">animation effect</a>
that produces <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation values</a> for its <a data-link-type="dfn" href="#target-property">target
properties</a> by interpolating between a series of property values
positioned at fractional offsets.</p>


   <p>Each set of property values indexed by an offset is called
a <dfn data-dfn-type="dfn" data-noexport="" id="keyframe">keyframe<a class="self-link" href="#keyframe"></a></dfn>.</p>


   <p>The <dfn data-dfn-type="dfn" data-lt="keyframe offset" data-noexport="" id="keyframe-offset">offset of a keyframe<a class="self-link" href="#keyframe-offset"></a></dfn> is a value
in the range [0, 1] or the special value null.
The list of <a data-link-type="dfn" href="#keyframe">keyframes</a> for a <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation effect</a> is
<dfn data-dfn-type="dfn" data-noexport="" id="loosely-sorted-by-offset">loosely sorted by offset<a class="self-link" href="#loosely-sorted-by-offset"></a></dfn> which means that for each
<a data-link-type="dfn" href="#keyframe">keyframe</a> in the list that has a <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> that is
not null, the offset is greater than or equal to the offset of the
previous <a data-link-type="dfn" href="#keyframe">keyframe</a> in the list with a <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> that
is not null, if any.</p>


   <p>The behavior when <a data-link-type="dfn" href="#keyframe">keyframes</a> overlap or have unsupported values
is defined in <a href="#the-intermediate-animation-value-of-a-keyframe-animation-effect">§4.3.2 The intermediate animation value of a keyframe animation effect</a>.</p>


   <p>Each keyframe also has a <a data-link-type="dfn" href="#timing-function">timing function</a> associated with it
that is applied to the period of time between the keyframe on which it
is specified and the <em>next</em> keyframe in the list.
The <a data-link-type="dfn" href="#timing-function">timing function</a> specified on the last keyframe in the
list is never applied.</p>


   <p>In addition to the <a data-link-type="dfn" href="#composite-operation">composite operation</a> specified on the
<a data-link-type="dfn" href="#animation-effect">animation effect</a>, each <a data-link-type="dfn" href="#keyframe">keyframe</a> may also have an
associated <a data-link-type="dfn" href="#composite-operation">composite operation</a> that is applied to all values
specified in that <a data-link-type="dfn" href="#keyframe">keyframe</a>.
If no <a data-link-type="dfn" href="#composite-operation">composite operation</a> is specified for a <a data-link-type="dfn" href="#keyframe">keyframe</a>,
the <a data-link-type="dfn" href="#composite-operation">composite operation</a> specified for the <a data-link-type="dfn" href="#animation-effect">animation
effect</a> is used.</p>


   <h4 class="heading settled" data-level="4.3.1" id="spacing-keyframes"><span class="secno">4.3.1. </span><span class="content">Spacing keyframes</span><a class="self-link" href="#spacing-keyframes"></a></h4>

   <div class="informative-bg"><em>This section is non-normative.</em>


    <p>It is often useful to be able to provide a series of property values
without having calculate the <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of each value in
time but instead to rely on some automatic spacing.</p>


    <p>For example, rather than typing:</p>


    <pre class="example lang-javascript">elem.animate([ { color: 'blue', offset: 0 },
               { color: 'green', offset: 1/3 },
               { color: 'red', offset: 2/3 },
               { color: 'yellow', offset: 1 } ], 2000);</pre>


    <p>It should be possible to type the following and allow the user agent
to calculate the <a data-link-type="dfn" href="#keyframe-offset">offset</a> of each
keyframe:</p>


    <pre class="example lang-javascript">elem.animate([ { color: 'blue' },
               { color: 'green' },
               { color: 'red' },
               { color: 'yellow' } ], 2000);</pre>


    <p>Web Animations provides spacing modes for this purpose. The default
spacing mode for keyframe animation effects is
“<a data-link-type="dfn" href="#distribute-keyframe-spacing-mode">distribute</a>” which
produces the result described above.</p>


    <p>The other spacing mode, “<a data-link-type="dfn" href="#paced-keyframe-spacing-mode">paced</a>”, is useful when
it is desirable to maintain an even rate of change such as for motion path
animation.</p>


    <p>For example, consider the following animation:</p>


    <pre class="example lang-javascript">elem.animate([ { left: '0px' },
               { left: '-20px' },
               { left: '100px' },
               { left: '50px' } ], 1000);</pre>


    <p>The resulting value of the <span class="prop-name">left</span>
property is illustrated below:</p>


    <div class="figure">
<img alt="The animated value of the left property over time when applying the distribute spacing mode.
The values are evenly spaced in time but the rate of change differs for each segment as indicated the varying slope of the graph." src="img/spacing-distribute.svg" width="350">
</div>

    <p class="caption">
The animated value of the left property over time when applying the
<a data-link-type="dfn" href="#distribute-keyframe-spacing-mode">distribute</a> spacing
mode.
The values are evenly spaced in time but the rate of change differs
for each segment as indicated the varying slope of the graph.
</p>


    <p>We can use the <a data-link-type="dfn" href="#paced-keyframe-spacing-mode">paced</a>
spacing mode as follows:</p>


    <pre class="example lang-javascript">elem.animate(
  new KeyframeEffect([ { left: '0px' },
                       { left: '-20px' },
                       { left: '100px' },
                       { left: '50px' } ], { spacing: "paced(left)" }), 1000);</pre>


    <p>The result is illustrated below:</p>


    <div class="figure">
<img alt="The animated value of the left property over time when applying the paced spacing mode.
The absolute value of the slope is graph is equal for all segments of the animation indicating a constant rate of change." src="img/spacing-paced.svg" width="350">
</div>

    <p class="caption">
The animated value of the left property over time when applying the
<a data-link-type="dfn" href="#paced-keyframe-spacing-mode">paced</a> spacing mode.
The absolute value of the slope is graph is equal for all segments
of the animation indicating a constant rate of change.
</p>


    <p>It is also possible to combine fixed <a data-link-type="dfn" href="#keyframe-offset">keyframe offsets</a> with
spacing modes as follows:</p>


    <pre class="example lang-javascript">elem.animate(
  new KeyframeEffect([ { left: '0px' },
                       { left: '-20px' },
                       { left: '100px', offset: 0.5 },
                       { left: '50px' } ], { spacing: "paced(left)" }), 1000);</pre>


    <p>The result is illustrated below:</p>


    <div class="figure">
<img alt="The animated value of the left property over time when applying the paced spacing mode and a fixed offset that puts the 100px value at 0.5.
The slope of the graph is equal for the first two segments but changes for the last segment in order to accommodate the fixed offset." src="img/spacing-paced-with-offset.svg" width="350">
</div>

    <p class="caption">
The animated value of the left property over time when applying the
<a data-link-type="dfn" href="#paced-keyframe-spacing-mode">paced</a> spacing mode and
a fixed <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> that
puts the 100px value at 0.5.
The slope of the graph is equal for the first two segments but
changes for the last segment in order to accommodate the fixed
offset.
</p>
</div>


   <p>Before calculating animation values from a <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation
effect</a>, an absolute value must be computed for the <a data-link-type="dfn" href="#keyframe-offset">keyframe
offset</a> of each <a data-link-type="dfn" href="#keyframe">keyframe</a> with a null offset.
The values computed depend on the <dfn data-dfn-type="dfn" data-noexport="" id="keyframe-spacing-mode">keyframe spacing mode<a class="self-link" href="#keyframe-spacing-mode"></a></dfn>
specified for the <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation effect</a>.
The keyframe spacing modes are:</p>


   <dl>
    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-lt="distribute keyframe spacing mode" data-noexport="" id="distribute-keyframe-spacing-mode">distribute<a class="self-link" href="#distribute-keyframe-spacing-mode"></a></dfn></p>
    <p></p>

    <dd data-md="">
     <p>Indicates that <a data-link-type="dfn" href="#keyframe">keyframes</a> with a null <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a>
null are positioned so that the difference between subsequent
<a data-link-type="dfn" href="#keyframe-offset">keyframe offsets</a> are equal.</p>

    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-lt="paced keyframe spacing mode" data-noexport="" id="paced-keyframe-spacing-mode">paced<a class="self-link" href="#paced-keyframe-spacing-mode"></a></dfn></p>
    <p></p>

    <dd data-md="">
     <p>Indicates that <a data-link-type="dfn" href="#keyframe">keyframes</a> with a null <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a>
null are positioned so that the <em>distance</em> between subsequent
values of a specified <dfn data-dfn-type="dfn" data-noexport="" id="paced-property">paced property<a class="self-link" href="#paced-property"></a></dfn> are equal.
The distance is calculated using the <a data-link-type="dfn" href="#distance-computation">distance computation</a>
procedure defined by the <a data-link-type="dfn" href="#animation-behavior">animation behavior</a> associated
with the <a data-link-type="dfn" href="#paced-property">paced property</a>.</p>
</dl>

   <h5 class="heading settled" data-level="4.3.1.1" id="applying-spacing-to-keyframes"><span class="secno">4.3.1.1. </span><span class="content">Applying spacing to keyframes</span><a class="self-link" href="#applying-spacing-to-keyframes"></a></h5>


   <p>We define a generic procedure for <dfn data-dfn-type="dfn" data-noexport="" id="evenly-distributing-a-keyframe">evenly distributing
a keyframe<a class="self-link" href="#evenly-distributing-a-keyframe"></a></dfn>, <var>keyframe</var>, between two reference
keyframes, <var>start</var> and <var>end</var>, whose <a data-link-type="dfn" href="#keyframe-offset">keyframe
offsets</a> are <em>not</em> null, as follows:</p>


   <ol>
    <li data-md="">
     <p>Let <dfn data-dfn-type="dfn" data-noexport="" id="offsetk">offset<sub><var>k</var></sub><a class="self-link" href="#offsetk"></a></dfn> be the <a data-link-type="dfn" href="#keyframe-offset">keyframe
offset</a> of a <a data-link-type="dfn" href="#keyframe">keyframe</a> <var>k</var>.</p>
     

    <li data-md="">
     <p>Let <var>n</var> be the number of keyframes <em>between</em> and
including <var>start</var> and <var>end</var> minus 1.</p>
     

    <li data-md="">
     <p>Let <var>index</var> refer to the position of
<var>keyframe</var> in the sequence of keyframes between
<var>start</var> and <var>end</var> such that the first keyframe
after <var>start</var> has an <var>index</var> of 1.</p>
     

    <li data-md="">
     <p>Set the <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of <var>keyframe</var> to
<a data-link-type="dfn" href="#offsetk">offset</a><sub><var>start</var></sub> +
(<a data-link-type="dfn" href="#offsetk">offset</a><sub><var>end</var></sub> −
 <a data-link-type="dfn" href="#offsetk">offset</a><sub><var>start</var></sub>)
× <var>index</var> / <var>n</var>.</p>
     
</ol>

   <p>The computed <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> values of each <a data-link-type="dfn" href="#keyframe">keyframe</a>
with a null keyframe offset are determined using the following
procedure.</p>


   <ol>
    <li data-md="">
     <p>Let <var>keyframes</var> refer to the list of <a data-link-type="dfn" href="#keyframe">keyframes</a>
associated with the <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation effect</a>.</p>
     

    <li data-md="">
     <p>If <var>keyframes</var> contains more than one
<a data-link-type="dfn" href="#keyframe">keyframe</a> and the <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of
the first <a data-link-type="dfn" href="#keyframe">keyframe</a> in <var>keyframes</var> is null,
set the <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of
the first <a data-link-type="dfn" href="#keyframe">keyframe</a> to 0.</p>
     

    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of the last <a data-link-type="dfn" href="#keyframe">keyframe</a> in
<var>distributed keyframes</var> is null, set its
<a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> to 1.</p>
     

    <li data-md="">
     <p>For each pair of <a data-link-type="dfn" href="#keyframe">keyframes</a> <var>A</var> and <var>B</var>
where:</p>
     


     <ul>
      <li data-md="">
       <p><var>A</var> appears before <var>B</var> in
<var>keyframes</var>, and</p>
       

      <li data-md="">
       <p><var>A</var> and <var>B</var> have a <a data-link-type="dfn" href="#keyframe-offset">keyframe
offset</a> that is not null, and</p>
       

      <li data-md="">
       <p>all <a data-link-type="dfn" href="#keyframe">keyframes</a> between <var>A</var> and <var>B</var>
have a null <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a>,</p>
       
</ul>
     

     <p>calculate the <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of
each <a data-link-type="dfn" href="#keyframe">keyframe</a> between <var>A</var> and <var>B</var>
depending on the <a data-link-type="dfn" href="#keyframe-spacing-mode">keyframe spacing mode</a> as follows:</p>
     


     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If the <a data-link-type="dfn" href="#keyframe-spacing-mode">spacing mode</a>
is <a data-link-type="dfn" href="#paced-keyframe-spacing-mode">paced</a>,</p>
       <p></p>

       <dd data-md="">


        <ol>
         <li data-md="">
          <p>Define a keyframe as <dfn data-dfn-type="dfn" data-noexport="" id="paceable">paceable<a class="self-link" href="#paceable"></a></dfn> if it
contains a value for the <a data-link-type="dfn" href="#paced-property">paced property</a>.</p>
          

         <li data-md="">
          <p>Let <var>paced A</var> be the first keyframe in the
range [<var>A</var>, <var>B</var>] that is
<a data-link-type="dfn" href="#paceable">paceable</a>, if any.</p>
          

         <li data-md="">
          <p>Let <var>paced B</var> be the last keyframe in the
range [<var>A</var>, <var>B</var>] that is
<a data-link-type="dfn" href="#paceable">paceable</a>, if any.</p>
          

         <li data-md="">
          <p>If there is no <var>paced A</var> or <var>paced
B</var> let both refer to <var>B</var>.</p>
          


          <p class="note" role="note">Note: In this case the spacing behavior degenerates to <a data-link-type="dfn" href="#distribute-keyframe-spacing-mode">distribute</a> spacing.</p>
          


         <li data-md="">
          <p>For each keyframe in the range
(<var>A</var>, <var>paced A</var>] and
[<var>paced B</var>, <var>B</var>),
apply the procedure for <a data-link-type="dfn" href="#evenly-distributing-a-keyframe">evenly distributing
a keyframe</a> using <var>A</var> and <var>B</var> as
the <var>start</var> and <var>end</var> keyframes
respectively.</p>
          


          <div class="annotation">


           <p>Yes, this is correct.
We want, <var>index</var> and <var>n</var> in that
procedure to reflect <em>all</em> the keyframes
between <var>A</var> and <var>B</var>, not just the
keyframes between, for example, <var>A</var> and
<var>spaced A</var>.</p>

</div>
          


         <li data-md="">
          <p>For each keyframe in the range
(<var>paced A</var>, <var>paced B</var>) that is
<a data-link-type="dfn" href="#paceable">paceable</a>:</p>
          


          <ol>
           <li data-md="">
            <p>Let
<dfn data-dfn-type="dfn" data-noexport="" id="distk">dist<sub><var>k</var></sub><a class="self-link" href="#distk"></a></dfn>
represent the cumulative distance to a keyframe
<var>k</var> from <var>paced A</var>
as calculated by applying the <a data-link-type="dfn" href="#distance-computation">distance
computation</a> defined by the <a data-link-type="dfn" href="#animation-behavior">animation
behavior</a> of the <a data-link-type="dfn" href="#paced-property">paced property</a> to the
values of the <a data-link-type="dfn" href="#paced-property">paced property</a> on each pair of
successive <a data-link-type="dfn" href="#paceable">paceable</a> keyframes in the range
[<var>paced A</var>, <var>k</var>].</p>
            

           <li data-md="">
            <p>Set the offset of <var>k</var> to
<a data-link-type="dfn" href="#offsetk">offset</a><sub><var>paced
  A</var></sub> +
(<a data-link-type="dfn" href="#offsetk">offset</a><sub><var>paced
  B</var></sub> −
<a data-link-type="dfn" href="#offsetk">offset</a><sub><var>paced
  A</var></sub>) ×
<a data-link-type="dfn" href="#distk">dist</a><sub><var>k</var></sub> /
<a data-link-type="dfn" href="#distk">dist</a><sub><var>paced
  B</var></sub></p>
            
</ol>
         <li data-md="">
          <p>For each keyframe in the range (<var>paced A</var>,
<var>paced B</var>) that still has
a null <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> (because it is not
<a data-link-type="dfn" href="#paceable">paceable</a>), apply the procedure
for <a data-link-type="dfn" href="#evenly-distributing-a-keyframe">evenly distributing a keyframe</a> using
the nearest <a data-link-type="dfn" href="#keyframe">keyframe</a> before and after the
keyframe in question in <var>keyframes</var> that has
a <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> that is not null, as the
<var>start</var> and <var>end</var> keyframes
respectively.</p>
          
</ol>
       <dt data-md="">
        <p>Otherwise,</p>
       <p></p>

       <dd data-md="">
        <p>Apply the procedure for <a data-link-type="dfn" href="#evenly-distributing-a-keyframe">evenly distributing
a keyframe</a> to each keyframe in the range (<var>A</var>,
<var>B</var>) using <var>A</var> and <var>B</var> as the
<var>start</var> and <var>end</var> keyframes respectively.</p>
</dl>
</div>
     
</ol>

   <p class="note" role="note">Note: although the above procedure defines computing keyframe
    offsets in terms of overwriting null values, user agents that
    implement the <a href="#programming-interface">programming
    interface</a> are required to maintain the original null values as
    well as calculating the computed offsets.
    This is because the <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffectreadonly-getframes">getFrames()</a></code> method of the
    <code class="idl"><a data-link-type="idl" href="#keyframeeffect">KeyframeEffect</a></code> interface returns keyframe offsets both
    before and after applying spacing.</p>


   <p class="issue" id="issue-867fbc9b"><a class="self-link" href="#issue-867fbc9b"></a>The above algorithm is quite complex.
    It attempts to cover all possible combinations of input where
    keyframe offsets and or paced property values may be missing.
    Furthermore, it attempts to do this in a way that degenerates
    consistently and also allows the author to combine fixed offsets
    with either pacing or distribute spacing.
    We await implementation experience to determine if the complexity
    is justified.</p>


   <h4 class="heading settled" data-level="4.3.2" id="the-intermediate-animation-value-of-a-keyframe-animation-effect"><span class="secno">4.3.2. </span><span class="content">The intermediate animation value of a keyframe animation effect</span><a class="self-link" href="#the-intermediate-animation-value-of-a-keyframe-animation-effect"></a></h4>


   <p>The <a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation value</a> of a single property
referenced by a <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation effect</a> as one of its
<a data-link-type="dfn" href="#target-property">target properties</a>, for a given
<var>time fraction</var>, <var>current iteration</var> and
<var>underlying value</var> is calculated as follows.</p>


   <ol>
    <li data-md="">
     <p>Let <var>target property</var> be the property for which the
<a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation value</a> is to be calculated.</p>
     

    <li data-md="">
     <p>If <a data-link-type="dfn" href="#animation-behavior">animation behavior</a> of the <var>target property</var> is
<a data-link-type="dfn" href="#concept-not-animatable">not animatable</a> abort this procedure
since the effect cannot be applied.</p>
     

    <li data-md="">
     <p>Define the <dfn data-dfn-type="dfn" data-noexport="" id="neutral-value-for-composition">neutral value for composition<a class="self-link" href="#neutral-value-for-composition"></a></dfn> as a value
which, when combined with an <a data-link-type="dfn" href="#underlying-value">underlying value</a> using the <a data-link-type="dfn" href="#composite-operation-add">add</a> <a data-link-type="dfn" href="#composite-operation">composite
operation</a>, produces the <a data-link-type="dfn" href="#underlying-value">underlying value</a>.</p>
     

    <li data-md="">
     <p>Let <var>property-specific keyframes</var> be a copy of the list
of <a data-link-type="dfn" href="#keyframe">keyframes</a> specified on the effect.</p>
     

    <li data-md="">
     <p>Remove any <a data-link-type="dfn" href="#keyframe">keyframes</a> from <var>property-specific
keyframes</var> that do not have a property value for
<var>target property</var>.</p>
     

    <li data-md="">
     <p>If <var>property-specific keyframes</var> is empty, return
<var>underlying value</var>.</p>
     

    <li data-md="">
     <p>If there is no <a data-link-type="dfn" href="#keyframe">keyframe</a> in <var>property-specific
keyframes</var> with a <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of
0, create a new <a data-link-type="dfn" href="#keyframe">keyframe</a> with a <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of
0, a property value set to the <a data-link-type="dfn" href="#neutral-value-for-composition">neutral value for
composition</a>, and a <a data-link-type="dfn" href="#composite-operation">composite operation</a> of <a data-link-type="dfn" href="#composite-operation-add">add</a>, and prepend it to the
beginning of <var>property-specific keyframes</var>.</p>
     

    <li data-md="">
     <p>Similarly, if there is no <a data-link-type="dfn" href="#keyframe">keyframe</a> in
<var>property-specific keyframes</var> with a <a data-link-type="dfn" href="#keyframe-offset">keyframe
offset</a> of 1,
create a new <a data-link-type="dfn" href="#keyframe">keyframe</a> with a <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of 1,
a property value set to the <a data-link-type="dfn" href="#neutral-value-for-composition">neutral value for composition</a>,
and a <a data-link-type="dfn" href="#composite-operation">composite operation</a> of <a data-link-type="dfn" href="#composite-operation-add">add</a>, and append it to the
end of <var>property-specific keyframes</var>.</p>
     

    <li data-md="">
     <p>Let <var>interval endpoints</var> be an empty sequence of
keyframes.</p>
     

    <li data-md="">
     <p>Populate <var>interval points</var> by following the steps from
the first matching condition from below:</p>
     


     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If <var>time fraction</var> &lt; 0 and there is more
than one <a data-link-type="dfn" href="#keyframe">keyframe</a> in <var>property-specific
keyframes</var> with a <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of
0,</p>
        

       <dd data-md="">
        <p>Add the first <a data-link-type="dfn" href="#keyframe">keyframe</a> in <var>property-specific
keyframes</var> to <var>interval endpoints</var>.</p>
        

       <dt data-md="">
        <p>If <var>time fraction</var> ≥ 1 and there is more
than one <a data-link-type="dfn" href="#keyframe">keyframe</a> in <var>property-specific
keyframes</var> with a <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of
1,</p>
        

       <dd data-md="">
        <p>Add the last <a data-link-type="dfn" href="#keyframe">keyframe</a> in <var>property-specific
keyframes</var> to <var>interval endpoints</var>.</p>
        

       <dt data-md="">
        <p>Otherwise,</p>
        

       <dd data-md="">


        <ol>
         <li data-md="">
          <p>Append to <var>interval endpoints</var> the last
<a data-link-type="dfn" href="#keyframe">keyframe</a> in <var>property-specific
keyframes</var> whose <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> is less than
or equal to <var>time fraction</var> and less than 1.  If
there is no such <a data-link-type="dfn" href="#keyframe">keyframe</a> (because, for example,
the <a data-link-type="dfn" href="#time-fraction">time fraction</a> is negative), add the last
<a data-link-type="dfn" href="#keyframe">keyframe</a> whose <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> is 0.</p>
          

         <li data-md="">
          <p>Append to <var>interval endpoints</var> the next
<a data-link-type="dfn" href="#keyframe">keyframe</a> in <var>property-specific keyframes</var>
after the one added in the previous step.</p>
          
</ol></dl>
</div>
     


    <li data-md="">
     <p>For each <var>keyframe</var> in <var>interval endpoints</var>:</p>
     


     <ol>
      <li data-md="">
       <p>If <var>keyframe</var> has a <a data-link-type="dfn" href="#composite-operation">composite operation</a>
that is <em>not</em> <a data-link-type="dfn" href="#composite-operation-replace">replace</a>, or
<var>keyframe</var> has no <a data-link-type="dfn" href="#composite-operation">composite operation</a>
and the <a data-link-type="dfn" href="#composite-operation">composite operation</a> of this <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe
animation effect</a> is <em>not</em> <a data-link-type="dfn" href="#composite-operation-replace">replace</a>, then
perform the following steps:</p>
       


       <ol>
        <li data-md="">
         <p>Let <var>composite operation to use</var> be the
<a data-link-type="dfn" href="#composite-operation">composite operation</a> of <var>keyframe</var>, or if
it has none, the <a data-link-type="dfn" href="#composite-operation">composite operation</a> of this
<a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation effect</a>.</p>
         

        <li data-md="">
         <p>Let <var>value to combine</var> be the property value of
<var>target property</var> specified on
<var>keyframe</var>.</p>
         

        <li data-md="">
         <p>Replace the property value of <var>target property</var>
on <var>keyframe</var> with the result of combining
<var>underlying value</var> (<var>V</var><sub>a</sub>) and
<var>value to combine</var> (<var>V</var><sub>b</sub>)
using the <var>composite operation to use</var>
procedure defined by the <var>target property</var>’s
<a data-link-type="dfn" href="#animation-behavior">animation behavior</a>.</p>
         
</ol>
       

      <li data-md="">
       <p>If this <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation effect</a> has an <a data-link-type="dfn" href="#iteration-composite-operation">iteration
composite operation</a> of <a data-link-type="dfn" href="#iteration-composite-operation-accumulate">accumulate</a>,
apply the following step <var>current iteration</var> times:</p>
       


       <ul>
        <li data-md="">
         <p>replace the property value of <var>target property</var>
on <var>keyframe</var> with the result of combining the
property value (<var>V</var><sub>a</sub>) with the
property value on the final keyframe in
<var>property-specific keyframes</var>
(<var>V</var><sub>b</sub>) using the <a data-link-type="dfn" href="#animation-accumulation">accumulation procedure</a>
defined for <var>target property</var>.</p>
         
</ul>
       

       <p class="issue" id="issue-8b7cca9f"><a class="self-link" href="#issue-8b7cca9f"></a>It seems like this could be done as a separate step at the end
    and applied to all types of animation effects consistently.</p>
       
</ol>
     

    <li data-md="">
     <p>If there is only one keyframe in <var>interval endpoints</var>
return the property value of <var>target property</var> on that
keyframe.</p>
     

    <li data-md="">
     <p>Let <var>start offset</var> be the <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of the
first keyframe in <var>interval endpoints</var>.</p>
     

    <li data-md="">
     <p>Let <var>end offset</var> be the <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of
last keyframe in <var>interval endpoints</var>.</p>
     

    <li data-md="">
     <p>Let <var>interval distance</var> be the result of evaluating
<code>(<var>time fraction</var> - <var>start offset</var>) /
(<var>end offset</var> - <var>start offset</var>)</code></p>
     

    <li data-md="">
     <p>Return the result of applying the <a data-link-type="dfn" href="#animation-interpolation">interpolation procedure</a> defined
by the <a data-link-type="dfn" href="#animation-behavior">animation behavior</a> of the <var>target property</var>,
to the values of the <var>target property</var> specified on the
two keyframes in <var>interval endpoints</var> taking the first such
value as <var>V</var><sub>start</sub> and the second as
<var>V</var><sub>end</sub> and using <var>interval
distance</var> as the interpolation parameter <var>p</var>.</p>
     
</ol>

   <div class="note" role="note">


    <p>Note that this procedure assumes the following about the list of
    <a data-link-type="dfn" href="#keyframe">keyframes</a> specified on the effect:</p>
    <p></p>


    <ul>
     <li data-md="">
      <p>Each <a data-link-type="dfn" href="#keyframe">keyframe</a> has a specified <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> in
the range [0, 1].</p>
      

     <li data-md="">
      <p>The list of <a data-link-type="dfn" href="#keyframe">keyframes</a> is sorted in ascending order by
<a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a>.</p>
      

     <li data-md="">
      <p>Each specified property value is a valid and supported value.</p>
      

     <li data-md="">
      <p>For a given property, there is a most one specified property
value on each keyframe.</p>
      
</ul>

    <p>It is the responsibility of the user of the model (for example,
    a declarative markup or programming interface) to ensure these
    conditions are met.</p>


    <p>For example, for the <a href="#programming-interface">programming
    interface</a> defined by this specification, these conditions are
    met by applying the normalization defined in <a href="#normalizing-a-sequence-of-keyframes">§5.17.3 Normalizing a sequence of keyframes</a>
    and resolving null <a data-link-type="dfn" href="#keyframe-offset">keyframe offsets</a> by
    applying <a href="#spacing-keyframes">spacing behavior</a>.</p>

</div>


   <p class="note" role="note">Note: this procedure permits overlapping <a data-link-type="dfn" href="#keyframe">keyframes</a>.
    The behavior is that at the point of overlap the output value jumps to
    the value of the last defined <a data-link-type="dfn" href="#keyframe">keyframe</a> at that offset.
    For overlapping frames at 0 or 1, the output value for <a data-link-type="dfn" href="#time-fraction">time fractions</a> less than 0 or greater than
    or equal to 1 is the value of the first <a data-link-type="dfn" href="#keyframe">keyframe</a> or the last
    <a data-link-type="dfn" href="#keyframe">keyframe</a> in <var>keyframes</var> respectively.</p>


   <div class="issue" id="issue-73bc0c24"><a class="self-link" href="#issue-73bc0c24"></a>
    In the presence of certain timing functions, the input time
    fraction to an animation effect is not limited to the range [0, 1].
    Currently, however, keyframe offsets <em>are</em> limited to the
    range [0, 1] and property values are simply extrapolated for input
    time fractions outside this range.


    <p>We have considered removing this restriction since some cases exist
    where it is useful to be able to specify non-linear
    changes in property values at time fractions outside the range
    [0, 1].
    One example is an animation that interpolates from green to yellow
    but has an overshoot timing function that makes it temporarily
    interpolate ‘beyond’ yellow to red before settling back
    to yellow.</p>


    <p>While this effect could be achieved by modification of the keyframes
    and timing function, this approach seems to break the model’s
    separation of timing concerns from animation effects.</p>


    <p>It is not clear how this effect should be achieved but we note that
    allowing keyframe offsets outside [0, 1] may make the currently
    specified behavior where keyframes at offset 0 and 1 are synthesized
    as necessary, inconsistent.</p>


    <p>See <a href="http://lists.w3.org/Archives/Public/public-fx/2013AprJun/0184.html">section
    4 (Keyframe offsets outside [0, 1]) of minuted discussion from Tokyo
      2013 F2F</a>.</p>
</div>


   <h3 class="heading settled" data-level="4.4" id="custom-effects"><span class="secno">4.4. </span><span class="content">Custom effects</span><a class="self-link" href="#custom-effects"></a></h3>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>In some situations the <a data-link-type="dfn" href="#animation-effect">animation
effects</a> provided by Web Animations may be insufficient.
For example, the <a data-link-type="dfn" href="#animation-effect">animation effects</a>
defined here are only able to target certain CSS properties.
They are unable, therefore, to modify the <a href="http://www.w3.org/TR/SVG11/struct.html#__svg__SVGSVGElement__currentScale"><code>currentScale</code></a>
property of an SVG element to smoothly zoom the viewport without
affecting the document content.</p>


    <p>In such cases, where the provided <a data-link-type="dfn" href="#animation-effect">animation
effects</a> do not provide needed functionality, an effect defined by
script may be used.
Such <a data-link-type="dfn" href="#custom-effect">custom effects</a> receive a <a data-link-type="dfn" href="#time-fraction">time
fraction</a> and <a data-link-type="dfn" href="#current-iteration">current iteration</a> from the timing model and
are responsible for producing an effect corresponding to the specified
time.</p>


    <p>Using an effect defined in script it is possible to animate not only
otherwise un-animatable attributes and properties, but potentially
anything that is accessible via script, including even producing audio
or creating vibrations.</p>


    <p>For example, using a <a data-link-type="dfn" href="#custom-effect">custom effect</a> that draws to a <a href="http://www.w3.org/TR/html5/scripting-1.html#the-canvas-element"><code>canvas</code></a>
element, it is possible to produce a complex animated effect
featuring patterns that may be difficult to create using CSS or
SVG.
Compared to using <a href="http://www.w3.org/TR/animation-timing/">Timing control for
script-based animations</a>,
this approach ensures the animation is frame-rate
independent and can be paused, reversed, eased with timing effects,
accelerated, synchronized with other animations, and be controlled
in the same manner as any other Web Animations animation without any
additional programming.</p>

</div>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="custom-effect">custom effect<a class="self-link" href="#custom-effect"></a></dfn> is an author-defined programming callback
that is passed timing information when <a data-link-type="dfn" href="#sampling">sampling</a> is performed.</p>


   <h4 class="heading settled" data-level="4.4.1" id="sampling-custom-effects"><span class="secno">4.4.1. </span><span class="content">Sampling custom effects</span><a class="self-link" href="#sampling-custom-effects"></a></h4>


   <p><a data-link-type="dfn" href="#custom-effect">Custom effects</a> are called for each referencing <a data-link-type="dfn" href="#concept-animation">animation</a>
when a <a data-link-type="dfn" href="#single_sample">sample</a> is performed based on the 
following criteria.</p>


   <ol>
    <li data-md="">
     <p>If, on the previous sample, the <a data-link-type="dfn" href="#concept-animation">animation</a>
referencing the <a data-link-type="dfn" href="#custom-effect">custom effect</a>:</p>
     


     <ul>
      <li data-md="">
       <p>was <a data-link-type="dfn" href="#in-effect">in effect</a>, and</p>
       

      <li data-md="">
       <p>referenced this same <a data-link-type="dfn" href="#custom-effect">custom effect</a>, and</p>
       

      <li data-md="">
       <p>had a different <a data-link-type="dfn" href="#animation-target">animation target</a></p>
       
</ul>
     

     <p>Call the callback passing an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-fraction">time fraction</a> and
the <a data-link-type="dfn" href="#animation-target">animation target</a> from the previous sample as parameters to
the callback.</p>
     

    <li data-md="">
     <p>Call the callback for the current <a data-link-type="dfn" href="#animation-target">animation target</a> based on
the first matching condition from the following:</p>
     


     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If the <a data-link-type="dfn" href="#concept-animation">animation</a> referencing the custom
effect is not <a data-link-type="dfn" href="#in-effect">in effect</a> but was <a data-link-type="dfn" href="#in-effect">in effect</a> in the previous
sample,</p>
        

       <dd data-md="">
        <p>Call the callback passing an <a data-link-type="dfn" href="#unresolved">unresolved</a> <a data-link-type="dfn" href="#time-fraction">time fraction</a> and
the current <a data-link-type="dfn" href="#animation-target">animation target</a> as parameters to the callback.</p>
        

       <dt data-md="">
        <p>Otherwise, if the <a data-link-type="dfn" href="#concept-animation">animation</a> referencing
the custom effect:</p>
        

       <dd data-md="">


        <ul>
         <li data-md="">
          <p><strong>is <a data-link-type="dfn" href="#in-effect">in effect</a>, and</strong></p>
          

         <li data-md="">
          <p><strong>was not <a data-link-type="dfn" href="#in-effect">in effect</a> in the previous
<a data-link-type="dfn" href="#single_sample">sample</a>, or
  was <a data-link-type="dfn" href="#in-effect">in effect</a> but with a different <a data-link-type="dfn" href="#time-fraction">time
  fraction</a> or <a data-link-type="dfn" href="#current-iteration">current iteration</a>,</strong></p>
          
</ul>
        

       <dd data-md="">
        <p>Call the callback passing with the referencing
<a data-link-type="dfn" href="#concept-animation">animation</a>’s current <a data-link-type="dfn" href="#time-fraction">time
fraction</a> and <a data-link-type="dfn" href="#animation-target">animation target</a> as parameters to the callback.</p>
        
</dl>
</div>
     
</ol>

   <div class="issue" id="issue-466de4cb"><a class="self-link" href="#issue-466de4cb"></a>
There may be use cases where an action needs to be triggered at
a specific point in an animation tree.
In many cases this can be achieved by inserting a custom effect with
a step-start easing that spans the period during which the action
should be triggered.
However, this can impose additional layout requirements on the
content which might be cumbersome to accomodate.


    <p>Some alternatives under consideration:</p>


    <ul>
     <li data-md="">
      <p>Additional calling conditions could be defined to accommodate
zero-width custom effects. For example, it could be required
that the callback be called if (given infinite precision) there
was a time between the previous and current sample times that
aligned with the custom effect.</p>
      

     <li data-md="">
      <p>Instead of adding special calling conditions to custom effects,
a new type of animation node, Trigger, could be introduced. The
trigger would only ever act as a zero-width custom effect as
described above, its constructor would take a callback function,
but not require a target or timing. It could also specify other
calling conventions, for example whether it should only trigger
in a specific playback direction.</p>
      
</ul>
</div>


   <h4 class="heading settled" data-level="4.4.2" id="execution-order-of-custom-effects"><span class="secno">4.4.2. </span><span class="content">Execution order of custom effects</span><a class="self-link" href="#execution-order-of-custom-effects"></a></h4>


   <p>Since <a data-link-type="dfn" href="#custom-effect">custom effects</a>, unlike <a data-link-type="dfn" href="#animation-effect">animation effects</a>, are not limited to
a single <a data-link-type="dfn" href="#target-property">target property</a>, the steps for assessing their
order of execution differs from <a data-link-type="dfn" href="#animation-effect">animation effects</a>.f</p>


   <p><a data-link-type="dfn" href="#custom-effect">Custom effects</a> are executed after all
<a data-link-type="dfn" href="#animation-effect">animation effects</a> have completed and
applied their result to their targets (see <a href="#applying-the-composited-result">§4.2.4 Applying the composited result</a>).</p>


   <p class="issue" id="issue-8b46f38c"><a class="self-link" href="#issue-8b46f38c"></a>Need to define this more precisely.
    Are styles flushed?
    Presumably they are.
    Can we suspend reflow for the duration of executing the script-based
    animation effects and just do it once afterwards?</p>


   <p>Within the set of <a data-link-type="dfn" href="#custom-effect">custom effects</a>, the
order of execution is the same as that defined for <a data-link-type="dfn" href="#animation-effect">animation effects</a> in <a href="#the-animation-stack">§4.2.1 The animation stack</a>.
Items sorted earlier are executed before those sorted later.</p>




   <h2 class="heading settled" data-level="5" id="programming-interface"><span class="secno">5. </span><span class="content">Programming interface</span><a class="self-link" href="#programming-interface"></a></h2>


   <div class="informative-bg"><em>This section is non-normative</em>


    <p>In addition to the abstract model described above, Web Animations also
defines a programming interface to the model.
This interface can be used to inspect and extend animations produced
by declarative means or for directly producing animations when
a procedural approach is more suitable.</p>

</div>


   <h3 class="heading settled" data-level="5.1" id="time-values-in-the-programming-interface"><span class="secno">5.1. </span><span class="content">
Time values in the programming interface</span><a class="self-link" href="#time-values-in-the-programming-interface"></a></h3>


   <p><a data-link-type="dfn" href="#time-value">Time values</a> are represented in the programming interface with
the type <code>double</code>. <a data-link-type="dfn" href="#unresolved">Unresolved</a> time values are
represented by the value <code>null</code>.</p>


   <h3 class="heading settled" data-level="5.2" id="the-animationtimeline-interface"><span class="secno">5.2. </span><span class="content">The <code>AnimationTimeline</code> interface</span><a class="self-link" href="#the-animationtimeline-interface"></a></h3>


   <p><a data-link-type="dfn" href="#timeline">Timelines</a>, including the <a data-link-type="dfn" href="#document-timeline">document
timeline</a> are represented in the Web Animations API by the
<code class="idl"><a data-link-type="idl" href="#animationtimeline">AnimationTimeline</a></code> interface.</p>


   <pre class="idl">interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationtimeline">AnimationTimeline<a class="self-link" href="#animationtimeline"></a></dfn> {
    readonly attribute double? <a class="idl-code" data-global-name="AnimationTimeline<interface>/currentTime<attribute>" data-link-type="attribute" data-readonly="" data-type="double? " href="#dom-animationtimeline-currenttime">currentTime</a>;
    <a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>           <a class="idl-code" data-global-name="AnimationTimeline<interface>/play(source)<method>/play()<method>" data-link-type="method" href="#dom-animationtimeline-play">play</a> (optional <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>? <dfn class="idl-code" data-dfn-for="AnimationTimeline/play" data-dfn-type="argument" data-export="" data-global-name="AnimationTimeline/play/source<argument>" id="dom-animationtimeline-play-source">source<a class="self-link" href="#dom-animationtimeline-play-source"></a></dfn> = null);
    sequence&lt;<a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>> <a class="idl-code" data-global-name="AnimationTimeline<interface>/getAnimationPlayers()<method>" data-link-type="method" href="#dom-animationtimeline-getanimationplayers">getAnimationPlayers</a> ();
};
</pre>


   <div class="attributes">


    <dl>
     <dt data-md="">
      <p><dfn class="idl-code" data-dfn-for="AnimationTimeline" data-dfn-type="attribute" data-export="" id="dom-animationtimeline-currenttime">currentTime<a class="self-link" href="#dom-animationtimeline-currenttime"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, readonly, nullable</span></p>
      

     <dd data-md="">
      <p>Returns the <a data-link-type="dfn" href="#time-value">time value</a> for this timeline or <code>null</code>
if this timeline is <a data-link-type="dfn" href="#inactive-timeline">inactive</a>.</p>
      
</dl>
</div>


   <div class="methods">


    <dl>
     <dt data-md="">
      <p><dfn class="idl-code" data-dfn-for="AnimationTimeline" data-dfn-type="method" data-export="" data-lt="play()" id="dom-animationtimeline-play">
AnimationPlayer play(optional AnimationNodeReadonly? source = null)<a class="self-link" href="#dom-animationtimeline-play"></a></dfn></p>
      

     <dd data-md="">
      <p>Creates a new <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code> object associated with
this <a data-link-type="dfn" href="#timeline">timeline</a> that begins playback as soon as it is
<a data-link-type="dfn" href="#ready">ready</a>.</p>
      


      <p>If <var>source</var> is specified, it will be used as the player’s <a data-link-type="dfn" href="#source-content">source
content</a>.</p>
      


      <p class="issue" id="issue-c794ed35"><a class="self-link" href="#issue-c794ed35"></a>Need to define the start behavior when <var>source</var> is null.</p>
      


      <p>The new <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code> object is created using the
<code class="idl"><a data-link-type="idl" href="#dom-animationplayer-animationplayersource-timeline">AnimationPlayer()</a></code> constructor passing this
<code class="idl"><a data-link-type="idl" href="#animationtimeline">AnimationTimeline</a></code> object as the <var>timeline</var> parameter and
<var>source</var> as the <var>source</var> parameter.</p>
      


      <p>Following construction of the <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code> object, the procedure to
<a data-link-type="dfn" href="#play-a-player">play a player</a> is performed on the newly constructed object.</p>
      


      <div class="parameters">


       <dl>
        <dt data-md="">
         <p>source</p>
         

        <dd data-md="">
         <p>the <a data-link-type="dfn" href="#source-content">source content</a> to assign to the newly-created
<code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code> object.</p>
         
</dl>
</div>
      


     <dt data-md="">
      <p><dfn class="idl-code" data-dfn-for="AnimationTimeline" data-dfn-type="method" data-export="" data-lt="getAnimationPlayers()" id="dom-animationtimeline-getanimationplayers">
sequence&lt;AnimationPlayer> getAnimationPlayers()<a class="self-link" href="#dom-animationtimeline-getanimationplayers"></a></dfn></p>
      

     <dd data-md="">
      <p>Returns the set of <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code> objects
associated with this <a data-link-type="dfn" href="#timeline">timeline</a> that have associated
<a data-link-type="dfn" href="#source-content">source content</a> which is <a data-link-type="dfn" href="#current">current</a> or <a data-link-type="dfn" href="#in-effect">in effect</a>.</p>
      


      <p>The returned list is sorted in increasing order by <a data-link-type="dfn" href="#player-sequence-number">player
sequence number</a>.</p>
      


      <p>The returned list reflects the state <em>after</em> applying any pending
changes to animation such as changes to animation-related style properties
that have yet to be processed.</p>
      


      <p class="issue" id="issue-fb580d44"><a class="self-link" href="#issue-fb580d44"></a>Both this method and <code class="idl"><a data-link-type="idl" href="#dom-animatable-getanimationplayers">getAnimationPlayers()</a></code> on the
       <code class="idl"><a data-link-type="idl" href="#animatable">Animatable</a></code> interface require retaining forwards-filling
       <a data-link-type="dfn" href="#concept-animation">animations</a> and their <a data-link-type="dfn" href="#player">players</a>
       such that a document that
       repeatedly produces forwards-filling animations will consume memory
       in an unbounded fashion.
       We may need to revise this definition (previously these methods
       only returned players whose <a data-link-type="dfn" href="#source-content">source content</a> was <a data-link-type="dfn" href="#current">current</a>)
       or provide a loophole for implementations to discard old players in
       such conditions.</p>
      
</dl>

    <h3 class="heading settled" data-level="5.3" id="the-animationplayer-interface"><span class="secno">5.3. </span><span class="content">The <code>AnimationPlayer</code> interface</span><a class="self-link" href="#the-animationplayer-interface"></a></h3>


    <p><a data-link-type="dfn" href="#player">Players</a> are represented in the Web Animations
API by the <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code> interface.</p>


    <pre class="idl">[<a class="idl-code" data-global-name="AnimationPlayer<interface>/AnimationPlayer(source, timeline)<constructor>" data-link-type="constructor" href="#dom-animationplayer-animationplayersource-timeline">Constructor</a> (optional <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>? <dfn class="idl-code" data-dfn-for="AnimationPlayer/AnimationPlayer(source, timeline)" data-dfn-type="argument" data-export="" data-global-name="AnimationPlayer<interface>/AnimationPlayer(source, timeline)<method>/source<argument>" id="dom-animationplayer-animationplayersource-timeline-source">source<a class="self-link" href="#dom-animationplayer-animationplayersource-timeline-source"></a></dfn> = null,
              optional <a data-link-type="idl-name" href="#animationtimeline">AnimationTimeline</a>? <dfn class="idl-code" data-dfn-for="AnimationPlayer/AnimationPlayer(source, timeline)" data-dfn-type="argument" data-export="" data-global-name="AnimationPlayer<interface>/AnimationPlayer(source, timeline)<method>/timeline<argument>" id="dom-animationplayer-animationplayersource-timeline-timeline">timeline<a class="self-link" href="#dom-animationplayer-animationplayersource-timeline-timeline"></a></dfn> = null)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationplayer">AnimationPlayer<a class="self-link" href="#animationplayer"></a></dfn> {
             attribute <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>?   <a class="idl-code" data-global-name="AnimationPlayer<interface>/source<attribute>" data-link-type="attribute" data-type="AnimationNodeReadonly?   " href="#dom-animationplayer-source">source</a>;
             attribute <a data-link-type="idl-name" href="#animationtimeline">AnimationTimeline</a>?       <a class="idl-code" data-global-name="AnimationPlayer<interface>/timeline<attribute>" data-link-type="attribute" data-type="AnimationTimeline?       " href="#dom-animationplayer-timeline">timeline</a>;
             attribute double?                  <a class="idl-code" data-global-name="AnimationPlayer<interface>/startTime<attribute>" data-link-type="attribute" data-type="double?                  " href="#dom-animationplayer-starttime">startTime</a>;
             attribute double?                  <a class="idl-code" data-global-name="AnimationPlayer<interface>/currentTime<attribute>" data-link-type="attribute" data-type="double?                  " href="#dom-animationplayer-currenttime">currentTime</a>;
             attribute double                   <a class="idl-code" data-global-name="AnimationPlayer<interface>/playbackRate<attribute>" data-link-type="attribute" data-type="double                   " href="#dom-animationplayer-playbackrate">playbackRate</a>;
    readonly attribute <a data-link-type="idl-name" href="#enumdef-animationplaystate">AnimationPlayState</a>       <a class="idl-code" data-global-name="AnimationPlayer<interface>/playState<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationPlayState       " href="#dom-animationplayer-playstate">playState</a>;
    readonly attribute Promise&lt;<a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>> <a class="idl-code" data-global-name="AnimationPlayer<interface>/ready<attribute>" data-link-type="attribute" data-readonly="" data-type="Promise<AnimationPlayer> " href="#dom-animationplayer-ready">ready</a>;
    readonly attribute Promise&lt;<a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>> <a class="idl-code" data-global-name="AnimationPlayer<interface>/finished<attribute>" data-link-type="attribute" data-readonly="" data-type="Promise<AnimationPlayer> " href="#dom-animationplayer-finished">finished</a>;
    void <a class="idl-code" data-global-name="AnimationPlayer<interface>/cancel()<method>" data-link-type="method" href="#dom-animationplayer-cancel">cancel</a> ();
    void <a class="idl-code" data-global-name="AnimationPlayer<interface>/finish()<method>" data-link-type="method" href="#dom-animationplayer-finish">finish</a> ();
    void <a class="idl-code" data-global-name="AnimationPlayer<interface>/play()<method>" data-link-type="method" href="#dom-animationplayer-play">play</a> ();
    void <a class="idl-code" data-global-name="AnimationPlayer<interface>/pause()<method>" data-link-type="method" href="#dom-animationplayer-pause">pause</a> ();
    void <a class="idl-code" data-global-name="AnimationPlayer<interface>/reverse()<method>" data-link-type="method" href="#dom-animationplayer-reverse">reverse</a> ();
};
</pre>


    <div class="constructors">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="constructor" data-export="" data-lt="AnimationPlayer(source, timeline)" id="dom-animationplayer-animationplayersource-timeline">AnimationPlayer ()<a class="self-link" href="#dom-animationplayer-animationplayersource-timeline"></a></dfn></p>
       

      <dd data-md="">
       <p>Creates a new <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code> object using the following procedure.</p>
       


       <ol>
        <li data-md="">
         <p>Let <var>player</var> be a new <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code> object.</p>
         

        <li data-md="">
         <p>Run the procedure to <a data-link-type="dfn" href="#set-the-timeline-of-a-player">set the timeline of a player</a> on
<var>player</var> passing <var>timeline</var> as the <var>new
timeline</var>.</p>
         

        <li data-md="">
         <p>Run the procedure to <a data-link-type="dfn" href="#set-the-source-content-of-a-player">set the source content of a player</a> on
<var>player</var> passing <var>source</var> as the <var>new
content</var>.</p>
         
</ol>
       

       <div class="parameters">


        <dl>
         <dt data-md="">
          <p>source</p>
          

         <dd data-md="">
          <p>An optional value which, if not null, specifies the <a data-link-type="dfn" href="#source-content">source
content</a> to assign to the newly created <a data-link-type="dfn" href="#player">player</a>.</p>
          


         <dt data-md="">
          <p>timeline</p>
          

         <dd data-md="">
          <p>An optional value which, if not null, specifies the <a data-link-type="dfn" href="#timeline">timeline</a>
with which to associate the newly created <a data-link-type="dfn" href="#player">player</a>.</p>
          
</dl>
</div>
       
</dl>
</div>


    <div class="attributes">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="attribute" data-export="" id="dom-animationplayer-source">source<a class="self-link" href="#dom-animationplayer-source"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#source-content">source content</a> associated with this player.
Setting this attribute updates the object’s <a data-link-type="dfn" href="#source-content">source content</a> using
the procedure to <a data-link-type="dfn" href="#set-the-source-content-of-a-player">set the source content of a player</a>.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="attribute" data-export="" id="dom-animationplayer-timeline">timeline<a class="self-link" href="#dom-animationplayer-timeline"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animationtimeline">AnimationTimeline</a>, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#timeline">timeline</a> associated with this player.
Setting this attribute updates the object’s <a data-link-type="dfn" href="#timeline">timeline</a> using
the procedure to <a data-link-type="dfn" href="#set-the-timeline-of-a-player">set the timeline of a player</a>.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="attribute" data-export="" id="dom-animationplayer-starttime">startTime<a class="self-link" href="#dom-animationplayer-starttime"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, nullable</span></p>
       

      <dd data-md="">
       <p>Returns the <a data-link-type="dfn" href="#player-start-time">start time</a> of this
player.
Setting this attribute updates the <a data-link-type="dfn" href="#player-start-time">player start time</a> using
the procedure to <a data-link-type="dfn" href="#update-the-player-start-time">update the player start time</a> of this object
to the new value.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="attribute" data-export="" id="dom-animationplayer-currenttime">currentTime<a class="self-link" href="#dom-animationplayer-currenttime"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#current-time">current time</a> of this player unless
this player has a <a data-link-type="dfn" href="#pending-pause-task">pending pause task</a>, in which case
this attribute returns <code>null</code>.</p>
       


       <p class="issue" id="issue-df52ec70"><a class="self-link" href="#issue-df52ec70"></a>This behavior is intended to prevent authors for relying
on the <code>currentTime</code> while a player is waiting to pause
but is also somewhat confusing.</p>
       


       <p>Setting this attribute follows the procedure to <a data-link-type="dfn" href="#set-the-current-time">set the current time</a>
of this object to the new value.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="attribute" data-export="" id="dom-animationplayer-playbackrate">playbackRate<a class="self-link" href="#dom-animationplayer-playbackrate"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a></span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#player-playback-rate">playback rate</a> of this
player.
Setting this attribute follows the procedure to <a data-link-type="dfn" href="#update-the-player-playback-rate">update the player
playback rate</a> of this object to the new value.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="attribute" data-export="" id="dom-animationplayer-playstate">playState<a class="self-link" href="#dom-animationplayer-playstate"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-animationplaystate">AnimationPlayState</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#play-state">play state</a> of this player.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="attribute" data-export="" id="dom-animationplayer-ready">ready<a class="self-link" href="#dom-animationplayer-ready"></a></dfn>, <span> of type Promise&lt;<a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>>, readonly</span></p>
       

      <dd data-md="">
       <p>Returns the <a data-link-type="dfn" href="#current-ready-promise">current ready promise</a> for this object.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="attribute" data-export="" id="dom-animationplayer-finished">finished<a class="self-link" href="#dom-animationplayer-finished"></a></dfn>, <span> of type Promise&lt;<a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>>, readonly</span></p>
       

      <dd data-md="">
       <p>Returns the <a data-link-type="dfn" href="#current-finished-promise">current finished promise</a> for this object.</p>
       
</dl>
</div>


    <div class="methods">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="method" data-export="" data-lt="cancel()" id="dom-animationplayer-cancel">void cancel()<a class="self-link" href="#dom-animationplayer-cancel"></a></dfn></p>
       

      <dd data-md="">
       <p>Clears all effects caused by this player and aborts its playback
by running the <a data-link-type="dfn" href="#cancel-a-player">cancel a player</a> procedure for this object.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="method" data-export="" data-lt="finish()" id="dom-animationplayer-finish">void finish()<a class="self-link" href="#dom-animationplayer-finish"></a></dfn></p>
       

      <dd data-md="">
       <p>Seeks the player to the end of the <a data-link-type="dfn" href="#source-content">source content</a> in the
current direction by running the <a data-link-type="dfn" href="#finish-a-player">finish a player</a> procedure
for this object.</p>
       


       <div class="exceptions">


        <dl>
         <dt data-md="">
          <p>DOMException of type <code>InvalidStateError</code></p>
          

         <dd data-md="">
          <p>Raised if this player’s <a data-link-type="dfn" href="#player-playback-rate">playback
rate</a> is zero, or if this player’s <a data-link-type="dfn" href="#player-playback-rate">playback rate</a> is > zero and the
<a data-link-type="dfn" href="#end-time">end time</a> of this player’s <a data-link-type="dfn" href="#source-content">source content</a> is infinity.</p>
          
</dl>
</div>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="method" data-export="" data-lt="play()" id="dom-animationplayer-play">void play()<a class="self-link" href="#dom-animationplayer-play"></a></dfn></p>
       

      <dd data-md="">
       <p>Unpauses the player and rewinds if it has finished playing using
the procedure to <a data-link-type="dfn" href="#play-a-player">play a player</a> for this object.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="method" data-export="" data-lt="pause()" id="dom-animationplayer-pause">void pause()<a class="self-link" href="#dom-animationplayer-pause"></a></dfn></p>
       

      <dd data-md="">
       <p>Suspends the playback of this player by running the procedure to
<a data-link-type="dfn" href="#pause-a-player">pause a player</a> for this object.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationPlayer" data-dfn-type="method" data-export="" data-lt="reverse()" id="dom-animationplayer-reverse">void reverse()<a class="self-link" href="#dom-animationplayer-reverse"></a></dfn></p>
       

      <dd data-md="">
       <p>Inverts the <a data-link-type="dfn" href="#player-playback-rate">playback rate</a> of
this player and plays it using the <a data-link-type="dfn" href="#reverse-a-player">reverse a player</a> procedure for
this object.
As with <a class="idl-code" data-link-type="method" href="#dom-animationplayer-play">play()</a>, this
method unpauses the player and, if the player has already finished playing
in the reversed direction, seeks to the start of the <a data-link-type="dfn" href="#source-content">source content</a>.</p>
       
</dl>
</div>


    <h4 class="heading settled" data-level="5.3.1" id="the-animationplaystate-enumeration"><span class="secno">5.3.1. </span><span class="content">The <code>AnimationPlayState</code> enumeration</span><a class="self-link" href="#the-animationplaystate-enumeration"></a></h4>


    <pre class="idl">enum <dfn class="idl-code" data-dfn-type="enum" data-export="" data-global-name="" id="enumdef-animationplaystate">AnimationPlayState<a class="self-link" href="#enumdef-animationplaystate"></a></dfn> { "idle", "pending", "running", "paused", "finished" };
</pre>


    <dl>
     <dt data-md="">
      <p><code>idle</code></p>
      

     <dd data-md="">
      <p>Corresponds to the <a data-link-type="dfn" href="#idle-play-state">idle play state</a>.</p>
      

     <dt data-md="">
      <p><code>pending</code></p>
      

     <dd data-md="">
      <p>Corresponds to the <a data-link-type="dfn" href="#pending-play-state">pending play state</a>.</p>
      

     <dt data-md="">
      <p><code>running</code></p>
      

     <dd data-md="">
      <p>Corresponds to the <a data-link-type="dfn" href="#running-play-state">running play state</a>.</p>
      

     <dt data-md="">
      <p><code>paused</code></p>
      

     <dd data-md="">
      <p>Corresponds to the <a data-link-type="dfn" href="#paused-play-state">paused play state</a>.</p>
      

     <dt data-md="">
      <p><code>finished</code></p>
      

     <dd data-md="">
      <p>Corresponds to the <a data-link-type="dfn" href="#finished-play-state">finished play state</a>.</p>
      
</dl>

    <h3 class="heading settled" data-level="5.4" id="the-animationnode-interface"><span class="secno">5.4. </span><span class="content">The <code>AnimationNodeReadonly</code> interface</span><a class="self-link" href="#the-animationnode-interface"></a></h3>


    <p><a data-link-type="dfn" href="#animation-node">Animation nodes</a> are represented in the Web
Animations API by the <code class="idl"><a data-link-type="idl" href="#animationnodereadonly">AnimationNodeReadonly</a></code> interface.</p>


    <p>Interfaces that inherit from <code class="idl"><a data-link-type="idl" href="#animationnodereadonly">AnimationNodeReadonly</a></code> that are intended
to be mutable must also implement the additional <code class="idl"><a data-link-type="idl" href="#animationnodemutable">AnimationNodeMutable</a></code>
interface.</p>

    <pre class="idl">interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationnodereadonly">AnimationNodeReadonly<a class="self-link" href="#animationnodereadonly"></a></dfn> {
    // Timing
    readonly attribute <a data-link-type="idl-name" href="#animationtimingreadonly">AnimationTimingReadonly</a>  <a class="idl-code" data-global-name="AnimationNodeReadonly<interface>/timing<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationTimingReadonly  " href="#dom-animationnodereadonly-timing">timing</a>;
    readonly attribute <a data-link-type="idl-name" href="#dictdef-computedtimingproperties">ComputedTimingProperties</a> <a class="idl-code" data-global-name="AnimationNodeReadonly<interface>/computedTiming<attribute>" data-link-type="attribute" data-readonly="" data-type="ComputedTimingProperties " href="#dom-animationnodereadonly-computedtiming">computedTiming</a>;
    // Timing hierarchy
    readonly attribute <a data-link-type="idl-name" href="#animationgroupreadonly">AnimationGroupReadonly</a>?  <a class="idl-code" data-global-name="AnimationNodeReadonly<interface>/parent<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationGroupReadonly?  " href="#dom-animationnodereadonly-parent">parent</a>;
    readonly attribute <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>?   <a class="idl-code" data-global-name="AnimationNodeReadonly<interface>/previousSibling<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationNodeReadonly?   " href="#dom-animationnodereadonly-previoussibling">previousSibling</a>;
    readonly attribute <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>?   <a class="idl-code" data-global-name="AnimationNodeReadonly<interface>/nextSibling<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationNodeReadonly?   " href="#dom-animationnodereadonly-nextsibling">nextSibling</a>;
};

[NoInterfaceObject]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationnodemutable">AnimationNodeMutable<a class="self-link" href="#animationnodemutable"></a></dfn> {
    void <a class="idl-code" data-global-name="AnimationNodeMutable<interface>/before(nodes...)<method>/before()<method>" data-link-type="method" href="#dom-animationnodemutable-before">before</a> (<a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>... <dfn class="idl-code" data-dfn-for="AnimationNodeMutable/before" data-dfn-type="argument" data-export="" data-global-name="AnimationNodeMutable/before/nodes<argument>" id="dom-animationnodemutable-before-nodes">nodes<a class="self-link" href="#dom-animationnodemutable-before-nodes"></a></dfn>);
    void <a class="idl-code" data-global-name="AnimationNodeMutable<interface>/after(nodes...)<method>/after()<method>" data-link-type="method" href="#dom-animationnodemutable-after">after</a> (<a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>... <dfn class="idl-code" data-dfn-for="AnimationNodeMutable/after" data-dfn-type="argument" data-export="" data-global-name="AnimationNodeMutable/after/nodes<argument>" id="dom-animationnodemutable-after-nodes">nodes<a class="self-link" href="#dom-animationnodemutable-after-nodes"></a></dfn>);
    void <a class="idl-code" data-global-name="AnimationNodeMutable<interface>/replace(nodes...)<method>/replace()<method>" data-link-type="method" href="#dom-animationnodemutable-replace">replace</a> (<a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>... <dfn class="idl-code" data-dfn-for="AnimationNodeMutable/replace" data-dfn-type="argument" data-export="" data-global-name="AnimationNodeMutable/replace/nodes<argument>" id="dom-animationnodemutable-replace-nodes">nodes<a class="self-link" href="#dom-animationnodemutable-replace-nodes"></a></dfn>);
    void <a class="idl-code" data-global-name="AnimationNodeMutable<interface>/remove()<method>" data-link-type="method" href="#dom-animationnodemutable-remove">remove</a> ();
};
</pre>


    <div class="attributes">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeReadonly" data-dfn-type="attribute" data-export="" id="dom-animationnodereadonly-timing">timing<a class="self-link" href="#dom-animationnodereadonly-timing"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animationtimingreadonly">AnimationTimingReadonly</a>, readonly</span></p>
       

      <dd data-md="">
       <p>Returns the input timing properties specified for this
<a data-link-type="dfn" href="#animation-node">animation node</a>.
This is comparable to the specified style on an Element,
<code>elem.style</code>.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeReadonly" data-dfn-type="attribute" data-export="" id="dom-animationnodereadonly-computedtiming">computedTiming<a class="self-link" href="#dom-animationnodereadonly-computedtiming"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#dictdef-computedtimingproperties">ComputedTimingProperties</a>, readonly</span></p>
       

      <dd data-md="">
       <p>Returns the calculated timing properties for this <a data-link-type="dfn" href="#animation-node">animation
node</a>.
This is comparable to the computed style of an Element,
<code>window.getComputedStyle(elem)</code>.</p>
       


       <p>Although several of the attributes of the this object are common
to the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> object returned by the
<code class="idl"><a data-link-type="idl" href="#dom-animationnodereadonly-timing">timing</a></code>
attribute, the values of this object represent the values <em>after</em>
applying the adjustments described by the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface as
being <cite>“for the purpose of timing model
calculations”</cite>.</p>
       


       <p><code>auto</code> values are also expanded as follows:</p>
       


       <ul>
        <li data-md="">
         <p><code>duration</code> – returns the calculated value of
the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a>. If <code>timing.duration</code>
is the string <code>auto</code> or any unsupported value, this
attribute will return the current calculated value of the
<a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration duration</a>.</p>
         

        <li data-md="">
         <p><code>fill</code> – the <code>auto</code> value is
replaced with the specific <a class="idl-code" data-link-type="enum" href="#enumdef-fillmode">FillMode</a> depending on the type
of <a data-link-type="dfn" href="#animation-node">animation node</a> (see <a href="#the-fillmode-enumeration">§5.8.1 The FillMode enumeration</a>).</p>
         
</ul>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeReadonly" data-dfn-type="attribute" data-export="" id="dom-animationnodereadonly-parent">parent<a class="self-link" href="#dom-animationnodereadonly-parent"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animationgroupreadonly">AnimationGroupReadonly</a>, readonly, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a> of this <a data-link-type="dfn" href="#animation-node">animation node</a> or
<code>null</code> if this <a data-link-type="dfn" href="#animation-node">animation node</a> does not have
a <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>.</p>
       


       <p class="issue" id="issue-894adfa6"><a class="self-link" href="#issue-894adfa6"></a>Should this be <code>parentGroup</code>?</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeReadonly" data-dfn-type="attribute" data-export="" id="dom-animationnodereadonly-previoussibling">previousSibling<a class="self-link" href="#dom-animationnodereadonly-previoussibling"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>, readonly, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#previous-sibling">previous sibling</a> of this <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeReadonly" data-dfn-type="attribute" data-export="" id="dom-animationnodereadonly-nextsibling">nextSibling<a class="self-link" href="#dom-animationnodereadonly-nextsibling"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>, readonly, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#next-sibling">next sibling</a> of this <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>
       
</dl>
</div>


    <div class="methods">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeMutable" data-dfn-type="method" data-export="" data-lt="before()" id="dom-animationnodemutable-before">
void before (AnimationNodeReadonly... nodes)<a class="self-link" href="#dom-animationnodemutable-before"></a></dfn></p>
       

      <dd data-md="">
       <p>Inserts <var>nodes</var> before this <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>
       


       <ol>
        <li data-md="">
         <p>If there is no <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>, terminate these
steps.</p>
         

        <li data-md="">
         <p>If any of the <a data-link-type="dfn" href="#animation-node">animation nodes</a> in <var>nodes</var> is an
<a data-link-type="dfn" href="#inclusive-ancestor">inclusive ancestor</a> of this <a data-link-type="dfn" href="#animation-node">animation node</a>
throw a <code>HierarchyRequestError</code> exception and
terminate these steps.</p>
         

        <li data-md="">
         <p><a data-link-type="dfn" href="#insert-children">Insert</a> <var>nodes</var> before
this <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>
         
</ol>
       

       <div class="note" role="note">
    Note that this definition precludes the following usage since
    <code>node</code> is an <a data-link-type="dfn" href="#inclusive-ancestor">inclusive ancestor</a> of itself:

        
        <div>
         <pre class="example lang-javascript">node.before(node); // throws HierarchyRequestError</pre>
        </div>
</div>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeMutable" data-dfn-type="method" data-export="" data-lt="after()" id="dom-animationnodemutable-after">
void after(AnimationNodeReadonly... nodes)<a class="self-link" href="#dom-animationnodemutable-after"></a></dfn></p>
       

      <dd data-md="">
       <p>Inserts <var>nodes</var> after this <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>
       


       <ol>
        <li data-md="">
         <p>If there is no <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>, terminate these
steps.</p>
         

        <li data-md="">
         <p>If any of the <a data-link-type="dfn" href="#animation-node">animation nodes</a> in <var>nodes</var> is an
<a data-link-type="dfn" href="#inclusive-ancestor">inclusive ancestor</a> of this <a data-link-type="dfn" href="#animation-node">animation node</a>
throw a <code>HierarchyRequestError</code> exception and
terminate these steps.</p>
         

        <li data-md="">
         <p>Let <var>reference child</var> be the <a data-link-type="dfn" href="#next-sibling-not-included">next sibling of
this animation node not in <var>nodes</var></a>.</p>
         

        <li data-md="">
         <p><a data-link-type="dfn" href="#insert-children">Insert</a> <var>nodes</var> before
<var>reference child</var>.</p>
         
</ol>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeMutable" data-dfn-type="method" data-export="" data-lt="replace()" id="dom-animationnodemutable-replace">
void replace(AnimationNodeReadonly... nodes)<a class="self-link" href="#dom-animationnodemutable-replace"></a></dfn></p>
       

      <dd data-md="">
       <p>Replaces this <code class="idl"><a data-link-type="idl" href="#animationnodereadonly">AnimationNodeReadonly</a></code> with the passed in
<var>nodes</var>.</p>
       


       <ol>
        <li data-md="">
         <p>If there is no <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>, terminate these
steps.</p>
         

        <li data-md="">
         <p>If any of the <a data-link-type="dfn" href="#animation-node">animation nodes</a> in <var>nodes</var> is an
<a data-link-type="dfn" href="#inclusive-ancestor">inclusive ancestor</a> of the <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>
throw a <code>HierarchyRequestError</code> exception and
terminate these steps.</p>
         

        <li data-md="">
         <p>Let <var>reference child</var> be the <a data-link-type="dfn" href="#next-sibling-not-included">next sibling of
this animation node not in <var>nodes</var></a>.</p>
         

        <li data-md="">
         <p><a data-link-type="dfn" href="#remove-an-animation-node">Remove</a> this
<a data-link-type="dfn" href="#animation-node">animation node</a> from its <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>.</p>
         

        <li data-md="">
         <p><a data-link-type="dfn" href="#insert-children">Insert</a> <var>nodes</var> before
<var>reference child</var>.</p>
         
</ol>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeMutable" data-dfn-type="method" data-export="" data-lt="remove()" id="dom-animationnodemutable-remove">void remove()<a class="self-link" href="#dom-animationnodemutable-remove"></a></dfn></p>
       

      <dd data-md="">
       <p><a data-link-type="dfn" href="#remove-an-animation-node">Removes</a> this <a data-link-type="dfn" href="#animation-node">animation
node</a> from its <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a> or <a data-link-type="dfn" href="#player">player</a>.</p>
       
</dl>
</div>

    <h3 class="heading settled" data-level="5.5" id="the-animationtimingreadonly-interface"><span class="secno">5.5. </span><span class="content">The <code>AnimationTimingReadonly</code> interface</span><a class="self-link" href="#the-animationtimingreadonly-interface"></a></h3>


    <pre class="idl">interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationtimingreadonly">AnimationTimingReadonly<a class="self-link" href="#animationtimingreadonly"></a></dfn> {
    readonly attribute double                             <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/delay<attribute>" data-link-type="attribute" data-readonly="" data-type="double                             " href="#dom-animationtimingreadonly-delay">delay</a>;
    readonly attribute double                             <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/endDelay<attribute>" data-link-type="attribute" data-readonly="" data-type="double                             " href="#dom-animationtimingreadonly-enddelay">endDelay</a>;
    readonly attribute <a data-link-type="idl-name" href="#enumdef-fillmode">FillMode</a>                           <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/fill<attribute>" data-link-type="attribute" data-readonly="" data-type="FillMode                           " href="#dom-animationtimingreadonly-fill">fill</a>;
    readonly attribute double                             <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/iterationStart<attribute>" data-link-type="attribute" data-readonly="" data-type="double                             " href="#dom-animationtimingreadonly-iterationstart">iterationStart</a>;
    readonly attribute unrestricted double                <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/iterations<attribute>" data-link-type="attribute" data-readonly="" data-type="unrestricted double                " href="#dom-animationtimingreadonly-iterations">iterations</a>;
    readonly attribute (unrestricted double or DOMString) <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/duration<attribute>" data-link-type="attribute" data-readonly="" data-type="(unrestricted double or DOMString) " href="#dom-animationtimingreadonly-duration">duration</a>;
    readonly attribute double                             <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/playbackRate<attribute>" data-link-type="attribute" data-readonly="" data-type="double                             " href="#dom-animationtimingreadonly-playbackrate">playbackRate</a>;
    readonly attribute <a data-link-type="idl-name" href="#enumdef-playbackdirection">PlaybackDirection</a>                  <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/direction<attribute>" data-link-type="attribute" data-readonly="" data-type="PlaybackDirection                  " href="#dom-animationtimingreadonly-direction">direction</a>;
    readonly attribute DOMString                          <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/easing<attribute>" data-link-type="attribute" data-readonly="" data-type="DOMString                          " href="#dom-animationtimingreadonly-easing">easing</a>;
};
</pre>


    <div class="attributes">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingReadonly" data-dfn-type="attribute" data-export="" id="dom-animationtimingreadonly-delay">delay<a class="self-link" href="#dom-animationtimingreadonly-delay"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#start-delay">start delay</a> which represents the number of milliseconds
from an <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#animation-node-start-time">start
time</a> to the start of the <a data-link-type="dfn" href="#active-interval">active interval</a>.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingReadonly" data-dfn-type="attribute" data-export="" id="dom-animationtimingreadonly-enddelay">endDelay<a class="self-link" href="#dom-animationtimingreadonly-enddelay"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#end-delay">end delay</a> which represents the number of milliseconds
from the end of an <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#active-interval">active interval</a>
until the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of any
<a data-link-type="dfn" href="#animation-node">animation node</a> that may
follow, for example, in an <a data-link-type="dfn" href="#animation-sequence">animation sequence</a>.
until its <a data-link-type="dfn" href="#end-time">end time</a>.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingReadonly" data-dfn-type="attribute" data-export="" id="dom-animationtimingreadonly-fill">fill<a class="self-link" href="#dom-animationtimingreadonly-fill"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-fillmode">FillMode</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#fill-mode">fill mode</a> which defines the behavior of the <a data-link-type="dfn" href="#animation-node">animation node</a>
outside its <a data-link-type="dfn" href="#active-interval">active interval</a>.</p>
       


       <p>When performing timing calculations the special value <span class="enum-value">auto</span> is expanded
to one of the <a data-link-type="dfn" href="#fill-mode">fill modes</a> recognized by the timing model as
follows,</p>
       


       <div class="switch">


        <dl>
         <dt data-md="">
          <p>If the <a data-link-type="dfn" href="#animation-node">animation node</a> to which the fill mode is being is
applied is an <a data-link-type="dfn" href="#concept-animation">animation</a>,</p>
          

         <dd data-md="">
          <p>Use <span class="enum-value">none</span> as the <a data-link-type="dfn" href="#fill-mode">fill
mode</a>.</p>
          

         <dt data-md="">
          <p>Otherwise,</p>
          

         <dd data-md="">
          <p>Use <span class="enum-value">both</span> as the <a data-link-type="dfn" href="#fill-mode">fill
mode</a>.</p>
          
</dl>
</div>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingReadonly" data-dfn-type="attribute" data-export="" id="dom-animationtimingreadonly-iterationstart">iterationStart<a class="self-link" href="#dom-animationtimingreadonly-iterationstart"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#iteration-start">iteration start</a> property which is a
finite real number greater than or equal to zero representing the iteration
index at which the animation node begins and its progress through that
iteration.</p>
       


       <p>For example, a value of 0.5 indicates that the animation node begins half
way through its first iteration. A value of 1.2 indicates the animation node
begins 20% of the way through its second iteration.</p>
       


       <div class="note" role="note">
Note that the value of <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-iterations">iterations</a></code> is effectively
<em>added</em> to the <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-iterationstart">iterationStart</a></code> such that
an animation node with an <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-iterationstart">iterationStart</a></code> of
‘0.5’ and <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-iterations">iterations</a></code> of
‘2’ will still repeat twice however it will begin
and end half-way through the its <a data-link-type="dfn" href="#iteration-interval">iteration interval</a>.


        <p><code class="idl"><a data-link-type="idl" href="#dom-animationtiming-iterationstart">iterationStart</a></code> values greater than
or equal to one are typically only useful in combination with an
animation effect that has an <a data-link-type="dfn" href="#iteration-composite-operation">iteration composite
operation</a> of <span class="enum-value">accumulate</span> or when the
<a data-link-type="dfn" href="#current-iteration">current iteration</a> index is otherwise significant.</p>
</div>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingReadonly" data-dfn-type="attribute" data-export="" id="dom-animationtimingreadonly-iterations">iterations<a class="self-link" href="#dom-animationtimingreadonly-iterations"></a></dfn>, <span> of type <a data-link-type="idl-name">unrestricted double</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#iteration-count">iteration count</a> property which is
a real number greater than or equal to zero (including positive
infinity) representing the number of times to the animation node repeats.</p>
       


       <p>A value of positive infinity indicates that the animation node repeats
forever.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingReadonly" data-dfn-type="attribute" data-export="" id="dom-animationtimingreadonly-duration">duration<a class="self-link" href="#dom-animationtimingreadonly-duration"></a></dfn>, <span> of type <a data-link-type="idl-name">(unrestricted double or DOMString)</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> which is a real number greater than
or equal to zero (including positive infinity) representing the
time taken to complete a single iteration of the <a data-link-type="dfn" href="#animation-node">animation
node</a>.</p>
       


       <p>The string value <code>auto</code> is used to indicate that the
<a data-link-type="dfn" href="#iteration-duration">iteration duration</a> reflects the animation node’s
<a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration duration</a>.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingReadonly" data-dfn-type="attribute" data-export="" id="dom-animationtimingreadonly-playbackrate">playbackRate<a class="self-link" href="#dom-animationtimingreadonly-playbackrate"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#animation-node-playback-rate">playback rate</a> property
which is a multiplier applied to the <a data-link-type="dfn" href="#local-time">local time</a> potentially
causing the node to run at a different rate to its natural speed.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingReadonly" data-dfn-type="attribute" data-export="" id="dom-animationtimingreadonly-direction">direction<a class="self-link" href="#dom-animationtimingreadonly-direction"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-playbackdirection">PlaybackDirection</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#playback-direction">playback direction</a> of the <a data-link-type="dfn" href="#animation-node">animation node</a> which
defines whether playback proceeds forwards, backwards, or alternates
on each iteration.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingReadonly" data-dfn-type="attribute" data-export="" id="dom-animationtimingreadonly-easing">easing<a class="self-link" href="#dom-animationtimingreadonly-easing"></a></dfn>, <span> of type <a data-link-type="idl-name">DOMString</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#timing-function">timing function</a> used to scale the time to
produce easing effects.</p>
       


       <p>The syntax of the string is defined by the following production:</p>
       

       <blockquote>
  
        <div class="production">
    "linear"
      | <a class="css" data-link-type="type" href="#typedef-cubic-bezier-timing-function">&lt;cubic-bezier-timing-function></a>
      | <a class="css" data-link-type="type" href="#typedef-step-timing-function">&lt;step-timing-function></a>
  </div>
</blockquote>
       


       <div class="annotation">
  In future we may extend this so that it is possible to query the
  individual functions in the string.
  It may be possible to do this by extending this attribute using
  some stringifier magic, or else we could just add
  <code>easingList</code> similar to HTML’s <code>classList</code>.
</div>
       
</dl>
</div>


    <h3 class="heading settled" data-level="5.6" id="the-animationtiming-interface"><span class="secno">5.6. </span><span class="content">The <code>AnimationTiming</code> interface</span><a class="self-link" href="#the-animationtiming-interface"></a></h3>


    <p>The <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface is a mutable subclass of
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> returned for the <code>timing</code> attribute of a
mutable <a data-link-type="dfn" href="#animation-node">animation node</a> such as
<code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code>, <code class="idl"><a data-link-type="idl" href="#animationgroup">AnimationGroup</a></code>, or <code class="idl"><a data-link-type="idl" href="#animationsequence">AnimationSequence</a></code>.</p>

    <pre class="idl">interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationtiming">AnimationTiming<a class="self-link" href="#animationtiming"></a></dfn> : <a data-link-type="idl-name" href="#animationtimingreadonly">AnimationTimingReadonly</a> {
    inherit attribute double                             <a class="idl-code" data-global-name="AnimationTiming<interface>/delay<attribute>" data-link-type="attribute" data-type="double                             " href="#dom-animationtiming-delay">delay</a>;
    inherit attribute double                             <a class="idl-code" data-global-name="AnimationTiming<interface>/endDelay<attribute>" data-link-type="attribute" data-type="double                             " href="#dom-animationtiming-enddelay">endDelay</a>;
    inherit attribute <a data-link-type="idl-name" href="#enumdef-fillmode">FillMode</a>                           <a class="idl-code" data-global-name="AnimationTiming<interface>/fill<attribute>" data-link-type="attribute" data-type="FillMode                           " href="#dom-animationtiming-fill">fill</a>;
    inherit attribute double                             <a class="idl-code" data-global-name="AnimationTiming<interface>/iterationStart<attribute>" data-link-type="attribute" data-type="double                             " href="#dom-animationtiming-iterationstart">iterationStart</a>;
    inherit attribute unrestricted double                <a class="idl-code" data-global-name="AnimationTiming<interface>/iterations<attribute>" data-link-type="attribute" data-type="unrestricted double                " href="#dom-animationtiming-iterations">iterations</a>;
    inherit attribute (unrestricted double or DOMString) <a class="idl-code" data-global-name="AnimationTiming<interface>/duration<attribute>" data-link-type="attribute" data-type="(unrestricted double or DOMString) " href="#dom-animationtiming-duration">duration</a>;
    inherit attribute double                             <a class="idl-code" data-global-name="AnimationTiming<interface>/playbackRate<attribute>" data-link-type="attribute" data-type="double                             " href="#dom-animationtiming-playbackrate">playbackRate</a>;
    inherit attribute <a data-link-type="idl-name" href="#enumdef-playbackdirection">PlaybackDirection</a>                  <a class="idl-code" data-global-name="AnimationTiming<interface>/direction<attribute>" data-link-type="attribute" data-type="PlaybackDirection                  " href="#dom-animationtiming-direction">direction</a>;
    inherit attribute DOMString                          <a class="idl-code" data-global-name="AnimationTiming<interface>/easing<attribute>" data-link-type="attribute" data-type="DOMString                          " href="#dom-animationtiming-easing">easing</a>;
};
</pre>


    <div class="attributes">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTiming" data-dfn-type="attribute" data-export="" id="dom-animationtiming-delay">delay<a class="self-link" href="#dom-animationtiming-delay"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-delay">delay</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> interface.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTiming" data-dfn-type="attribute" data-export="" id="dom-animationtiming-enddelay">endDelay<a class="self-link" href="#dom-animationtiming-enddelay"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-enddelay">endDelay</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> interface.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTiming" data-dfn-type="attribute" data-export="" id="dom-animationtiming-fill">fill<a class="self-link" href="#dom-animationtiming-fill"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-fillmode">FillMode</a></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-fill">fill</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> interface.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTiming" data-dfn-type="attribute" data-export="" id="dom-animationtiming-iterationstart">iterationStart<a class="self-link" href="#dom-animationtiming-iterationstart"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-iterationstart">iterationStart</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> interface.</p>
       


       <p>Values less than zero are clamped to zero for the purpose of timing model
calculations.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTiming" data-dfn-type="attribute" data-export="" id="dom-animationtiming-iterations">iterations<a class="self-link" href="#dom-animationtiming-iterations"></a></dfn>, <span> of type <a data-link-type="idl-name">unrestricted double</a></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-iterations">iterations</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> interface.</p>
       


       <p>This may be set to <code class="esvalue">+Infinity</code> to cause
the <a data-link-type="dfn" href="#animation-node">animation node</a> to repeat indefinitely.</p>
       


       <p>Values less than zero and <code class="esvalue">NaN</code> values are
treated as the value 1.0 for the purpose of timing model calculations.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTiming" data-dfn-type="attribute" data-export="" id="dom-animationtiming-duration">duration<a class="self-link" href="#dom-animationtiming-duration"></a></dfn>, <span> of type <a data-link-type="idl-name">(unrestricted double or DOMString)</a></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-duration">duration</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> interface.</p>
       


       <p>Real numbers less than zero, <code>NaN</code> values, and strings
other than the lowercase value <code>auto</code> are treated
the same as <code>auto</code> for the purpose of timing model
calculations.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTiming" data-dfn-type="attribute" data-export="" id="dom-animationtiming-playbackrate">playbackRate<a class="self-link" href="#dom-animationtiming-playbackrate"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-playbackrate">playbackRate</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> interface.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTiming" data-dfn-type="attribute" data-export="" id="dom-animationtiming-direction">direction<a class="self-link" href="#dom-animationtiming-direction"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-playbackdirection">PlaybackDirection</a></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-direction">direction</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> interface.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTiming" data-dfn-type="attribute" data-export="" id="dom-animationtiming-easing">easing<a class="self-link" href="#dom-animationtiming-easing"></a></dfn>, <span> of type <a data-link-type="idl-name">DOMString</a></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtimingreadonly-easing">easing</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> interface.</p>
       


       <p>Unrecognized string values or values that correspond to
a <a data-link-type="dfn" href="#timing-function">timing function</a> that is not supported for the type of
<a data-link-type="dfn" href="#animation-node">animation node</a> to which this property is applied
are treated as if the <code>linear</code> keyword was specified
for the purpose of timing model calculations.</p>
       
</dl>
</div>


    <h3 class="heading settled" data-level="5.7" id="the-animationtiminginput-dictionary"><span class="secno">5.7. </span><span class="content">The <code>AnimationTimingProperties</code> dictionary</span><a class="self-link" href="#the-animationtiminginput-dictionary"></a></h3>


    <p>The <code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> dictionary encapsulates the timing
properties of an <code class="idl"><a data-link-type="idl" href="#animationnodereadonly">AnimationNodeReadonly</a></code> so that they can be set in bulk (as
with the <code class="idl"><a data-link-type="idl" href="#dom-animation-animationtarget-effect-timing">Animation()</a></code> constructor) or returned as a readonly snapshot (as
with the <code class="idl"><a data-link-type="idl" href="#dom-animationnodereadonly-computedtiming">computedTiming</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#animationnodereadonly">AnimationNodeReadonly</a></code> interface).</p>


    <p><code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> is simply a dictionary-equivalent of the
<code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.
The meaning and acceptable values for each of its members are identical.</p>


    <pre class="idl">dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" data-global-name="" id="dictdef-animationtimingproperties">AnimationTimingProperties<a class="self-link" href="#dictdef-animationtimingproperties"></a></dfn> {
    double                             <a class="idl-code" data-default="0" data-global-name="AnimationTimingProperties<dictionary>/delay<dict-member>" data-link-type="dict-member" data-type="double                             " href="#dom-animationtimingproperties-delay">delay</a> = 0;
    double                             <a class="idl-code" data-default="0" data-global-name="AnimationTimingProperties<dictionary>/endDelay<dict-member>" data-link-type="dict-member" data-type="double                             " href="#dom-animationtimingproperties-enddelay">endDelay</a> = 0;
    <a data-link-type="idl-name" href="#enumdef-fillmode">FillMode</a>                           <a class="idl-code" data-default="&quot;auto&quot;" data-global-name="AnimationTimingProperties<dictionary>/fill<dict-member>" data-link-type="dict-member" data-type="FillMode                           " href="#dom-animationtimingproperties-fill">fill</a> = "auto";
    double                             <a class="idl-code" data-default="0.0" data-global-name="AnimationTimingProperties<dictionary>/iterationStart<dict-member>" data-link-type="dict-member" data-type="double                             " href="#dom-animationtimingproperties-iterationstart">iterationStart</a> = 0.0;
    unrestricted double                <a class="idl-code" data-default="1.0" data-global-name="AnimationTimingProperties<dictionary>/iterations<dict-member>" data-link-type="dict-member" data-type="unrestricted double                " href="#dom-animationtimingproperties-iterations">iterations</a> = 1.0;
    (unrestricted double or DOMString) <a class="idl-code" data-default="&quot;auto&quot;" data-global-name="AnimationTimingProperties<dictionary>/duration<dict-member>" data-link-type="dict-member" data-type="(unrestricted double or DOMString) " href="#dom-animationtimingproperties-duration">duration</a> = "auto";
    double                             <a class="idl-code" data-default="1.0" data-global-name="AnimationTimingProperties<dictionary>/playbackRate<dict-member>" data-link-type="dict-member" data-type="double                             " href="#dom-animationtimingproperties-playbackrate">playbackRate</a> = 1.0;
    <a data-link-type="idl-name" href="#enumdef-playbackdirection">PlaybackDirection</a>                  <a class="idl-code" data-default="&quot;normal&quot;" data-global-name="AnimationTimingProperties<dictionary>/direction<dict-member>" data-link-type="dict-member" data-type="PlaybackDirection                  " href="#dom-animationtimingproperties-direction">direction</a> = "normal";
    DOMString                          <a class="idl-code" data-default="&quot;linear&quot;" data-global-name="AnimationTimingProperties<dictionary>/easing<dict-member>" data-link-type="dict-member" data-type="DOMString                          " href="#dom-animationtimingproperties-easing">easing</a> = "linear";
};
</pre>


    <div class="attributes">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-animationtimingproperties-delay">delay<a class="self-link" href="#dom-animationtimingproperties-delay"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, defaulting to <code>0</code></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-delay">delay</a></code> attribute of
the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-animationtimingproperties-enddelay">endDelay<a class="self-link" href="#dom-animationtimingproperties-enddelay"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, defaulting to <code>0</code></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-enddelay">endDelay</a></code> attribute of
the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-animationtimingproperties-fill">fill<a class="self-link" href="#dom-animationtimingproperties-fill"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-fillmode">FillMode</a>, defaulting to <code>"auto"</code></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-fill">fill</a></code> attribute of
the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-animationtimingproperties-iterationstart">iterationStart<a class="self-link" href="#dom-animationtimingproperties-iterationstart"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, defaulting to <code>0.0</code></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-iterationstart">iterationStart</a></code> attribute
of the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-animationtimingproperties-iterations">iterations<a class="self-link" href="#dom-animationtimingproperties-iterations"></a></dfn>, <span> of type <a data-link-type="idl-name">unrestricted double</a>, defaulting to <code>1.0</code></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-iterations">iterations</a></code> attribute
of the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-animationtimingproperties-duration">duration<a class="self-link" href="#dom-animationtimingproperties-duration"></a></dfn>, <span> of type <a data-link-type="idl-name">(unrestricted double or DOMString)</a>, defaulting to <code>"auto"</code></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-duration">duration</a></code>
attribute of the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-animationtimingproperties-playbackrate">playbackRate<a class="self-link" href="#dom-animationtimingproperties-playbackrate"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, defaulting to <code>1.0</code></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-playbackrate">playbackRate</a></code> attribute
of the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-animationtimingproperties-direction">direction<a class="self-link" href="#dom-animationtimingproperties-direction"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-playbackdirection">PlaybackDirection</a>, defaulting to <code>"normal"</code></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-direction">direction</a></code> attribute
of the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-animationtimingproperties-easing">easing<a class="self-link" href="#dom-animationtimingproperties-easing"></a></dfn>, <span> of type <a data-link-type="idl-name">DOMString</a>, defaulting to <code>"linear"</code></span></p>
       

      <dd data-md="">
       <p>See the <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-easing">easing</a></code> attribute
of the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.</p>
       
</dl>
</div>


    <h3 class="heading settled" data-level="5.8" id="the-computedanimationtiming-interface"><span class="secno">5.8. </span><span class="content">The
  <code>ComputedTimingProperties</code> dictionary</span><a class="self-link" href="#the-computedanimationtiming-interface"></a></h3>


    <p>Timing parameters calculated by the timing model are exposed using
<code class="idl"><a data-link-type="idl" href="#dictdef-computedtimingproperties">ComputedTimingProperties</a></code> dictionary objects.</p>


    <pre class="idl">dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" data-global-name="" id="dictdef-computedtimingproperties">ComputedTimingProperties<a class="self-link" href="#dictdef-computedtimingproperties"></a></dfn> : <a data-link-type="idl-name" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a> {
    double              <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/startTime<dict-member>" data-link-type="dict-member" data-type="double              " href="#dom-computedtimingproperties-starttime">startTime</a>;
    unrestricted double <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/endTime<dict-member>" data-link-type="dict-member" data-type="unrestricted double " href="#dom-computedtimingproperties-endtime">endTime</a>;
    unrestricted double <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/activeDuration<dict-member>" data-link-type="dict-member" data-type="unrestricted double " href="#dom-computedtimingproperties-activeduration">activeDuration</a>;
    double?             <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/localTime<dict-member>" data-link-type="dict-member" data-type="double?             " href="#dom-computedtimingproperties-localtime">localTime</a>;
    unrestricted double <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/timeFraction<dict-member>" data-link-type="dict-member" data-type="unrestricted double " href="#dom-computedtimingproperties-timefraction">timeFraction</a>;
    unsigned long?      <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/currentIteration<dict-member>" data-link-type="dict-member" data-type="unsigned long?      " href="#dom-computedtimingproperties-currentiteration">currentIteration</a>;
};
</pre>


    <div class="attributes">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="ComputedTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-computedtimingproperties-starttime">startTime<a class="self-link" href="#dom-computedtimingproperties-starttime"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a></span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#animation-node-start-time">start time</a> of this
<a data-link-type="dfn" href="#animation-node">animation node</a> in milliseconds.    This is the time at which the <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>, if
any, has scheduled this child to run within its <a data-link-type="dfn" href="#transformed-time">transformed time space</a>, that is, the
<a data-link-type="dfn" href="#animation-node">animation node</a>’s <a data-link-type="dfn" href="#inherited-time">inherited time
space</a>.    The start of the <a data-link-type="dfn" href="#active-interval">active interval</a> is based on the sum of
the <a data-link-type="dfn" href="#animation-node-start-time">start time</a> and
<a data-link-type="dfn" href="#start-delay">start delay</a>.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="ComputedTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-computedtimingproperties-endtime">endTime<a class="self-link" href="#dom-computedtimingproperties-endtime"></a></dfn>, <span> of type <a data-link-type="idl-name">unrestricted double</a></span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#end-time">end time</a> of the <a data-link-type="dfn" href="#animation-node">animation node</a> expressed in
milliseconds in <a data-link-type="dfn" href="#inherited-time">inherited time
space</a>.
This corresponds to the end of the <a data-link-type="dfn" href="#animation-node">animation node</a>’s active
interval plus any <a data-link-type="dfn" href="#end-delay">end delay</a>.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="ComputedTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-computedtimingproperties-activeduration">activeDuration<a class="self-link" href="#dom-computedtimingproperties-activeduration"></a></dfn>, <span> of type <a data-link-type="idl-name">unrestricted double</a></span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#active-duration">active duration</a> of this <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="ComputedTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-computedtimingproperties-localtime">localTime<a class="self-link" href="#dom-computedtimingproperties-localtime"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#local-time">local time</a> of this <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>
       


       <p>This will be <code>null</code> if this
<a data-link-type="dfn" href="#animation-node">animation node</a> is not    <a data-link-type="dfn" href="#associated-with-a-player">associated with a player</a> or if it has a
<a data-link-type="dfn" href="#parent-animation-group">parent animation group</a> that is not <a data-link-type="dfn" href="#in-effect">in effect</a>.</p>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="ComputedTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-computedtimingproperties-timefraction">timeFraction<a class="self-link" href="#dom-computedtimingproperties-timefraction"></a></dfn>, <span> of type <a data-link-type="idl-name">unrestricted double</a></span></p>
       

      <dd data-md="">
       <p>The current <a data-link-type="dfn" href="#time-fraction">time fraction</a> of this <a data-link-type="dfn" href="#animation-node">animation node</a>.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="ComputedTimingProperties" data-dfn-type="dict-member" data-export="" id="dom-computedtimingproperties-currentiteration">currentIteration<a class="self-link" href="#dom-computedtimingproperties-currentiteration"></a></dfn>, <span> of type <a data-link-type="idl-name">unsigned long</a>, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#current-iteration">current iteration</a> index beginning with zero for the first
iteration.</p>
       


       <p>In the case where the <a data-link-type="dfn" href="#current-iteration">current iteration</a> index is infinity,
(as can happen with a zero-duration animation that repeats infinite times),
the return value to be used in ECMAScript is <code>Infinity</code>.
The value for other language bindings is undefined.</p>
       
</dl>
</div>


    <h4 class="heading settled" data-level="5.8.1" id="the-fillmode-enumeration"><span class="secno">5.8.1. </span><span class="content">The <code>FillMode</code> enumeration</span><a class="self-link" href="#the-fillmode-enumeration"></a></h4>


    <pre class="idl">enum <dfn class="idl-code" data-dfn-type="enum" data-export="" data-global-name="" id="enumdef-fillmode">FillMode<a class="self-link" href="#enumdef-fillmode"></a></dfn> { "none", "forwards", "backwards", "both", "auto" };
</pre>


    <dl>
     <dt data-md="">
      <p><code>none</code></p>
      

     <dd data-md="">
      <p>No fill.</p>
      


     <dt data-md="">
      <p><code>forwards</code></p>
      

     <dd data-md="">
      <p>Fill forwards.</p>
      


     <dt data-md="">
      <p><code>backwards</code></p>
      

     <dd data-md="">
      <p>Fill backwards.</p>
      


     <dt data-md="">
      <p><code>both</code></p>
      

     <dd data-md="">
      <p>Fill backwards and forwards.</p>
      


     <dt data-md="">
      <p><code>auto</code></p>
      

     <dd data-md="">
      <p>Fill backwards and forwards when applied to an
<code class="idl"><a data-link-type="idl" href="#animationgroupreadonly">AnimationGroupReadonly</a></code> and no fill when applied to an
<code class="idl"><a data-link-type="idl" href="#animationreadonly">AnimationReadonly</a></code>.</p>
      
</dl>

    <h4 class="heading settled" data-level="5.8.2" id="the-playbackdirection-enumeration"><span class="secno">5.8.2. </span><span class="content">The <code>PlaybackDirection</code> enumeration</span><a class="self-link" href="#the-playbackdirection-enumeration"></a></h4>


    <pre class="idl">enum <dfn class="idl-code" data-dfn-type="enum" data-export="" data-global-name="" id="enumdef-playbackdirection">PlaybackDirection<a class="self-link" href="#enumdef-playbackdirection"></a></dfn> { "normal", "reverse", "alternate", "alternate-reverse" };
</pre>


    <dl>
     <dt data-md="">
      <p><code>normal</code></p>
      

     <dd data-md="">
      <p>All iterations are played as specified.</p>
      


     <dt data-md="">
      <p><code>reverse</code></p>
      

     <dd data-md="">
      <p>All iterations are played in the reverse direction from the way
they are specified.</p>
      


     <dt data-md="">
      <p><code>alternate</code></p>
      

     <dd data-md="">
      <p>Even iterations are played as specified, odd iterations are played
in the reverse direction from the way they are specified.</p>
      


     <dt data-md="">
      <p><code>alternate-reverse</code></p>
      

     <dd data-md="">
      <p>Even iterations are played in the reverse direction from the way
they are specified, odd iterations are played as specified.</p>
      
</dl>

    <h3 class="heading settled" data-level="5.9" id="the-animationgroup-interfaces"><span class="secno">5.9. </span><span class="content">The <code>AnimationGroupReadonly</code>
  and <code>AnimationGroup</code> interfaces</span><a class="self-link" href="#the-animationgroup-interfaces"></a></h3>


    <p><a data-link-type="dfn" href="#animation-group">Animation groups</a> are represented by the <code class="idl"><a data-link-type="idl" href="#animationgroupreadonly">AnimationGroupReadonly</a></code>
interface.
Mutable <a data-link-type="dfn" href="#animation-group">animation groups</a> are represented by the <code class="idl"><a data-link-type="idl" href="#animationgroup">AnimationGroup</a></code>
interface.</p>


    <pre class="idl">[Constructor (sequence? children,
              optional (unrestricted double or AnimationTimingProperties) timing)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationgroupreadonly">AnimationGroupReadonly<a class="self-link" href="#animationgroupreadonly"></a></dfn> : <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a> {
    readonly attribute <a data-link-type="idl-name" href="#animationnodelist">AnimationNodeList</a>      <a class="idl-code" data-global-name="AnimationGroupReadonly<interface>/children<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationNodeList      " href="#dom-animationgroupreadonly-children">children</a>;
    readonly attribute <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>? <a class="idl-code" data-global-name="AnimationGroupReadonly<interface>/firstChild<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationNodeReadonly? " href="#dom-animationgroupreadonly-firstchild">firstChild</a>;
    readonly attribute <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>? <a class="idl-code" data-global-name="AnimationGroupReadonly<interface>/lastChild<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationNodeReadonly? " href="#dom-animationgroupreadonly-lastchild">lastChild</a>;
    <a data-link-type="idl-name" href="#animationgroup">AnimationGroup</a> <a class="idl-code" data-global-name="AnimationGroupReadonly<interface>/clone()<method>" data-link-type="method" href="#dom-animationgroupreadonly-clone">clone</a> ();
};

[NoInterfaceObject]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationgroupmutable">AnimationGroupMutable<a class="self-link" href="#animationgroupmutable"></a></dfn> {
  void <a class="idl-code" data-global-name="AnimationGroupMutable<interface>/prepend(nodes...)<method>/prepend()<method>" data-link-type="method" href="#dom-animationgroupmutable-prepend">prepend</a> (<a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>... <dfn class="idl-code" data-dfn-for="AnimationGroupMutable/prepend" data-dfn-type="argument" data-export="" data-global-name="AnimationGroupMutable/prepend/nodes<argument>" id="dom-animationgroupmutable-prepend-nodes">nodes<a class="self-link" href="#dom-animationgroupmutable-prepend-nodes"></a></dfn>);
  void <a class="idl-code" data-global-name="AnimationGroupMutable<interface>/append(nodes...)<method>/append()<method>" data-link-type="method" href="#dom-animationgroupmutable-append">append</a> (<a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>... <dfn class="idl-code" data-dfn-for="AnimationGroupMutable/append" data-dfn-type="argument" data-export="" data-global-name="AnimationGroupMutable/append/nodes<argument>" id="dom-animationgroupmutable-append-nodes">nodes<a class="self-link" href="#dom-animationgroupmutable-append-nodes"></a></dfn>);
};

[Constructor (sequence? children,
              optional (unrestricted double or AnimationTimingProperties) timing)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationgroup">AnimationGroup<a class="self-link" href="#animationgroup"></a></dfn> : <a data-link-type="idl-name" href="#animationgroupreadonly">AnimationGroupReadonly</a> {
};
<a data-link-type="idl-name" href="#animationgroup">AnimationGroup</a> implements <a data-link-type="idl-name" href="#animationnodemutable">AnimationNodeMutable</a>;
<a data-link-type="idl-name" href="#animationgroup">AnimationGroup</a> implements <a data-link-type="idl-name" href="#animationgroupmutable">AnimationGroupMutable</a>;
</pre>


    <div class="constructors">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationGroupReadonly" data-dfn-type="constructor" data-export="" data-lt="AnimationGroupReadonly(children, timing)" id="dom-animationgroupreadonly-animationgroupreadonlychildren-timing">
AnimationGroupReadonly ()<a class="self-link" href="#dom-animationgroupreadonly-animationgroupreadonlychildren-timing"></a></dfn></p>
       

      <dd data-md="">
       <p>Creates a new <code class="idl"><a data-link-type="idl" href="#animationgroup">AnimationGroup</a></code> object using the following
procedure:</p>
       


       <ol>
        <li data-md="">
         <p>Create a new <code class="idl"><a data-link-type="idl" href="#animationgroup">AnimationGroup</a></code> object, <var>group</var>.</p>
         


        <li data-md="">
         <p>Let <var>timing input</var> be the result of applying the
<a data-link-type="dfn" href="#procedure-for-processing-a-timing-argument">procedure for processing a timing argument</a> to <var>timing.</var></p>
         


        <li data-md="">
         <p>Set <code><var>group</var>.timing</code> to a new
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> object whose attributes are assigned the
value of the member of the same name on <var>timing input</var>.</p>
         


        <li data-md="">
         <p><a data-link-type="dfn" href="#insert-children">Insert</a> <var>children</var>
before <code>null</code>.</p>
         
</ol>
       

       <div class="parameters">


        <dl>
         <dt data-md="">
          <p><dfn class="idl-code" data-dfn-for="AnimationGroupReadonly/AnimationGroupReadonly(children, timing)" data-dfn-type="argument" data-export="" id="dom-animationgroupreadonly-animationgroupreadonlychildren-timing-children">children<a class="self-link" href="#dom-animationgroupreadonly-animationgroupreadonlychildren-timing-children"></a></dfn></p>
          

         <dd data-md="">
          <p>A sequence of animation nodes to add as children of this group.</p>
          


          <p>These children are appended in sequence using the same
semantics as the <code class="idl"><a data-link-type="idl" href="#dom-animationgroupmutable-append">append()</a></code> method of the
<code class="idl"><a data-link-type="idl" href="#animationgroupmutable">AnimationGroupMutable</a></code> interface.</p>
          


         <dt data-md="">
          <p><dfn class="idl-code" data-dfn-for="AnimationGroupReadonly/AnimationGroupReadonly(children, timing)" data-dfn-type="argument" data-export="" id="dom-animationgroupreadonly-animationgroupreadonlychildren-timing-timing">timing<a class="self-link" href="#dom-animationgroupreadonly-animationgroupreadonlychildren-timing-timing"></a></dfn></p>
          

         <dd data-md="">
          <p>The timing properties or <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> of the new
animation group.</p>
          
</dl>
</div>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationGroup" data-dfn-type="constructor" data-export="" data-lt="AnimationGroup(children, timing)" id="dom-animationgroup-animationgroupchildren-timing">
AnimationGroup ()<a class="self-link" href="#dom-animationgroup-animationgroupchildren-timing"></a></dfn></p>
       

      <dd data-md="">
       <p>Creates a new <code class="idl"><a data-link-type="idl" href="#animationgroup">AnimationGroup</a></code> object using the same procedure as with
the <code class="idl"><a data-link-type="idl" href="#dom-animationgroupreadonly-animationgroupreadonlychildren-timing">AnimationGroupReadonly()</a></code> constructor with the following differences:</p>
       


       <ul>
        <li data-md="">
         <p><var>group</var> is initialized to a new <code class="idl"><a data-link-type="idl" href="#animationgroup">AnimationGroup</a></code> object
rather than a new <code class="idl"><a data-link-type="idl" href="#animationgroupreadonly">AnimationGroupReadonly</a></code> object.</p>
         

        <li data-md="">
         <p><code><var>group</var>.timing</code> is set to a new
<code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> object rather than a new <code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code>
object.</p>
         
</ul></dl>
</div>


    <div class="attributes">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationGroupReadonly" data-dfn-type="attribute" data-export="" id="dom-animationgroupreadonly-children">children<a class="self-link" href="#dom-animationgroupreadonly-children"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animationnodelist">AnimationNodeList</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The list of <a data-link-type="dfn" href="#child-animation-node">child animation nodes</a> in the group.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationGroupReadonly" data-dfn-type="attribute" data-export="" id="dom-animationgroupreadonly-firstchild">firstChild<a class="self-link" href="#dom-animationgroupreadonly-firstchild"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>, readonly, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#first-child">first child</a> of this <a data-link-type="dfn" href="#animation-group">animation group</a>.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationGroupReadonly" data-dfn-type="attribute" data-export="" id="dom-animationgroupreadonly-lastchild">lastChild<a class="self-link" href="#dom-animationgroupreadonly-lastchild"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>, readonly, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#last-child">last child</a> of this <a data-link-type="dfn" href="#animation-group">animation group</a>.</p>
       
</dl>
</div>


    <div class="methods">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationGroupMutable" data-dfn-type="method" data-export="" data-lt="prepend()" id="dom-animationgroupmutable-prepend"><a class="self-link" href="#dom-animationgroupmutable-prepend"></a></dfn></p>
       

      <dt data-md="">
       <p>void prepend (AnimationNodeReadonly... nodes)</p>
       

      <dd data-md="">


       <ol>
        <li data-md="">
         <p>If any of the <a data-link-type="dfn" href="#animation-node">animation nodes</a> in <var>nodes</var> is an
<a data-link-type="dfn" href="#inclusive-ancestor">inclusive ancestor</a> of this <a data-link-type="dfn" href="#animation-node">animation node</a>
throw a <code>HierarchyRequestError</code> exception and
terminate these steps.</p>
         

        <li data-md="">
         <p><a data-link-type="dfn" href="#insert-children">Insert</a> <var>nodes</var> before
the <a data-link-type="dfn" href="#first-child">first child</a>.</p>
         
</ol>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationGroupMutable" data-dfn-type="method" data-export="" data-lt="append()" id="dom-animationgroupmutable-append">
void append (AnimationNodeReadonly... nodes)<a class="self-link" href="#dom-animationgroupmutable-append"></a></dfn></p>
       

      <dd data-md="">


       <ol>
        <li data-md="">
         <p>If any of the <a data-link-type="dfn" href="#animation-node">animation nodes</a> in <var>nodes</var> is an
<a data-link-type="dfn" href="#inclusive-ancestor">inclusive ancestor</a> of this <a data-link-type="dfn" href="#animation-node">animation node</a>
throw a <code>HierarchyRequestError</code> exception and
terminate these steps.</p>
         

        <li data-md="">
         <p><a data-link-type="dfn" href="#insert-children">Insert</a> <var>nodes</var> before
<code>null</code>.</p>
         
</ol>
       

      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationGroupReadonly" data-dfn-type="method" data-export="" data-lt="clone()" id="dom-animationgroupreadonly-clone">
AnimationGroup clone ()<a class="self-link" href="#dom-animationgroupreadonly-clone"></a></dfn></p>
       

      <dd data-md="">
       <p>Creates a deep copy of this <code class="idl"><a data-link-type="idl" href="#animationgroupreadonly">AnimationGroupReadonly</a></code> object using the
following procedure.</p>
       


       <ol>
        <li data-md="">
         <p>Let <var>source</var> be this <code class="idl"><a data-link-type="idl" href="#animationgroupreadonly">AnimationGroupReadonly</a></code> object,
the object to be cloned.</p>
         


        <li data-md="">
         <p>Let <var>cloned timing</var> be a new
<code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> object whose members are assigned
the value of the attribute with the same name on
<code><var>source</var>.timing</code>.</p>
         


        <li data-md="">
         <p>Let <var>cloned children</var> be an empty sequence of
<code class="idl"><a data-link-type="idl" href="#animationnodereadonly">AnimationNodeReadonly</a></code> objects.</p>
         


        <li data-md="">
         <p>For each <var>child</var> in
<code><var>source</var>.children</code>, append the result
of calling <code><var>child</var>.clone()</code>
to <var>cloned children</var>.</p>
         


        <li data-md="">
         <p>Return a new <code class="idl"><a data-link-type="idl" href="#animationgroup">AnimationGroup</a></code> object created by
calling the <code class="idl"><a data-link-type="idl" href="#dom-animationgroup-animationgroupchildren-timing">AnimationGroup()</a></code> constructor with parameters
<code>AnimationGroup(<var>cloned children</var>,
<var>cloned timing</var>)</code>.</p>
         
</ol></dl>
</div>


    <h4 class="heading settled" data-level="5.9.1" id="processing-a-timing-argument"><span class="secno">5.9.1. </span><span class="content">Processing a <var>timing</var> argument</span><a class="self-link" href="#processing-a-timing-argument"></a></h4>


    <p>The <var>timing</var> parameter passed to the <code class="idl"><a data-link-type="idl" href="#dom-animationgroupreadonly-animationgroupreadonlychildren-timing">AnimationGroupReadonly()</a></code>,
<code class="idl"><a data-link-type="idl" href="#dom-animationgroup-animationgroupchildren-timing">AnimationGroup()</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-animationreadonly-animationreadonlytarget-effect-timing">AnimationReadonly()</a></code>, or <code class="idl"><a data-link-type="idl" href="#dom-animation-animationtarget-effect-timing">Animation()</a></code> constructor
may be an <code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> object, a double representing the
duration of the <a data-link-type="dfn" href="#animation-node">animation node</a> in milliseconds, or undefined.</p>


    <p>The following <dfn data-dfn-type="dfn" data-noexport="" id="procedure-for-processing-a-timing-argument">procedure for processing a timing argument<a class="self-link" href="#procedure-for-processing-a-timing-argument"></a></dfn>,
<var>timing</var>, normalizes the above inputs into
a <code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> object.</p>


    <dl>
     <dt data-md="">
      <p>If <var>timing</var> is an <code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> object,</p>
      

     <dd data-md="">
      <p>Return <var>timing</var>.</p>
      


     <dt data-md="">
      <p>If <var>timing</var> is a <code>double</code>,</p>
      

     <dd data-md="">
      <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> object with all members set
to their default values and <code class="idl"><a data-link-type="idl" href="#dom-animationtimingproperties-duration">duration</a></code> set
to <var>timing</var>.</p>
      


     <dt data-md="">
      <p>Otherwise (<var>timing</var> is undefined),</p>
      

     <dd data-md="">
      <p>Return a new <code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> object with all members set
to their default values.</p>
      
</dl>

    <div class="note" role="note">


     <p>Note that since <code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> objects have the same
member names as <code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> dictionaries, it is
also possible to pass the <code class="idl"><a data-link-type="idl" href="#dom-animationnodereadonly-timing">timing</a></code> member of another
<code class="idl"><a data-link-type="idl" href="#animationnodereadonly">AnimationNodeReadonly</a></code> to the any of the methods that invoke this method
as the <var>timing</var> parameter.</p>


     <p>Doing so will cause the <code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> object to be
treated as an <code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> dictionary and thus it
will effectively be cloned, not shared.</p>


     <div class="example">


      <p>For example, the timing of two animations may be aligned as follows:</p>


      <pre class="lang-javascript">var animA = elem.animate({ opacity: 0 }, 1000).source;
var animB = elem.animate({ width: '0px' }, animA.timing).source;
alert(animA.timing !== animB.timing); // Displays 'true'
alert(animA.timing.duration === animB.timing.duration); // Displays 'true'</pre>
</div>

</div>


    <h4 class="heading settled" data-level="5.9.2" id="definitions-for-manipulating-hierarchies"><span class="secno">5.9.2. </span><span class="content">Definitions for manipulating hierarchies</span><a class="self-link" href="#definitions-for-manipulating-hierarchies"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-lt="next sibling not included" data-noexport="" id="next-sibling-not-included">next sibling of
<var>node</var> not included<a class="self-link" href="#next-sibling-not-included"></a></dfn> in a set of <a data-link-type="dfn" href="#animation-node">animation
nodes</a>, <var>nodes</var> is determined using the following
teps:</p>
    <p></p>


    <ol>
     <li data-md="">
      <p>Let <var>context node</var> be <var>node</var>.</p>
      

     <li data-md="">
      <p>While the <a data-link-type="dfn" href="#next-sibling">next sibling</a> of <var>context node</var> is not
<code>null</code> perform the following steps:</p>
      


      <ol>
       <li data-md="">
        <p>Let <var>context node</var> be the <a data-link-type="dfn" href="#next-sibling">next sibling</a> of
<var>context node</var>.</p>
        

       <li data-md="">
        <p>If <var>context node</var> is not in <var>nodes</var> return
<var>context node</var> and terminate these steps.</p>
        
</ol>
      

     <li data-md="">
      <p>Return <code>null</code>.</p>
      
</ol>

    <p>To <dfn data-dfn-type="dfn" data-lt="remove an animation node" data-noexport="" id="remove-an-animation-node">remove<a class="self-link" href="#remove-an-animation-node"></a></dfn> a
<var>node</var> from its <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a> or
<a data-link-type="dfn" href="#player">player</a>, perform the steps corresponding to the first
matching condition from below, if any:</p>


    <div class="switch">


     <dl>
      <dt data-md="">
       <p>If <var>node</var> has a <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>,</p>
       

      <dd data-md="">
       <p>Remove <var>node</var> from the <a data-link-type="dfn" href="#parent-animation-group">parent animation group</a>’s
list of <a data-link-type="dfn" href="#child-animation-node">child animation nodes</a>.</p>
       


      <dt data-md="">
       <p>If <var>node</var> is <a data-link-type="dfn" href="#directly-associated-with-a-player">directly associated with
a player</a>,</p>
       

      <dd data-md="">
       <p>Disassociate <var>node</var> from the <a data-link-type="dfn" href="#player">player</a>.</p>
       
</dl>
</div>



    <p>To <dfn data-dfn-type="dfn" data-lt="insert children" data-noexport="" id="insert-children">insert<a class="self-link" href="#insert-children"></a></dfn> a series of zero or
more <a data-link-type="dfn" href="#animation-node">animation nodes</a>, <var>nodes</var>, to
<var>parent</var>’s list of <a data-link-type="dfn" href="#child-animation-node">child animation nodes</a> before
<var>reference child</var> perform the following steps for each
<var>node</var> in <var>nodes</var>:</p>
    <p></p>


    <ol>
     <li data-md="">
      <p><a data-link-type="dfn" href="#remove-an-animation-node">Remove</a> <var>node</var>
from its parent.</p>
      

     <li data-md="">
      <p>Insert <var>node</var> to <var>parent</var>’s list of <a data-link-type="dfn" href="#child-animation-node">child
animation nodes</a> before <var>reference child</var></p>
      
</ol>

    <h3 class="heading settled" data-level="5.10" id="the-animationnodelist-interface"><span class="secno">5.10. </span><span class="content">The <code>AnimationNodeList</code> interface</span><a class="self-link" href="#the-animationnodelist-interface"></a></h3>


    <p>A list of <a data-link-type="dfn" href="#animation-node">animation nodes</a> may be represented by
an <code class="idl"><a data-link-type="idl" href="#animationnodelist">AnimationNodeList</a></code>.</p>


    <p>The <code>AnimationNodeList</code> interface supports indexed
properties with indices in the range 0 ≤ <var>index</var> &lt;
<code>length</code>.</p>


    <p class="annotation">
The only reason this interface exists is to provide a familiar
experience for authors familiar with DOM interfaces where child nodes
are accessed via a <code>children</code> member.
</p>


    <pre class="idl">interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationnodelist">AnimationNodeList<a class="self-link" href="#animationnodelist"></a></dfn> {
    readonly attribute unsigned long <a class="idl-code" data-global-name="AnimationNodeList<interface>/length<attribute>" data-link-type="attribute" data-readonly="" data-type="unsigned long " href="#dom-animationnodelist-length">length</a>;
    getter <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>? <dfn class="idl-code" data-dfn-for="AnimationNodeList" data-dfn-type="method" data-export="" data-global-name="AnimationNodeList<interface>/item(index)<method>" data-lt="item(index)" id="dom-animationnodelist-itemindex">item<a class="self-link" href="#dom-animationnodelist-itemindex"></a></dfn> (unsigned long <dfn class="idl-code" data-dfn-for="AnimationNodeList/item" data-dfn-type="argument" data-export="" data-global-name="AnimationNodeList/item/index<argument>" id="dom-animationnodelist-item-index">index<a class="self-link" href="#dom-animationnodelist-item-index"></a></dfn>);
};
</pre>


    <div class="attributes">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeList" data-dfn-type="attribute" data-export="" id="dom-animationnodelist-length">length<a class="self-link" href="#dom-animationnodelist-length"></a></dfn>, <span> of type <a data-link-type="idl-name">unsigned long</a>, readonly</span></p>
       

      <dd data-md="">
       <p>The number of <a data-link-type="dfn" href="#animation-node">animation nodes</a> in the list.</p>
       
</dl>
</div>


    <div class="methods">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationNodeList" data-dfn-type="method" data-export="" data-lt="item()" id="dom-animationnodelist-item">
getter AnimationNodeReadonly? item(unsigned long index)<a class="self-link" href="#dom-animationnodelist-item"></a></dfn></p>
       

      <dd data-md="">
       <p>Returns the <a data-link-type="dfn" href="#animation-node">animation node</a> at <code>index</code>.
If <code>index</code> is greater than or equal to
<code>length</code> returns <code>null</code>.</p>
       
</dl>
</div>


    <h3 class="heading settled" data-level="5.11" id="the-animationsequence-interfaces"><span class="secno">5.11. </span><span class="content">The
<code>AnimationSequenceReadonly</code> and <code>AnimationSequence</code>
interfaces</span><a class="self-link" href="#the-animationsequence-interfaces"></a></h3>


    <p><a data-link-type="dfn" href="#animation-sequence">Animation sequences</a> are represented by the <code class="idl"><a data-link-type="idl" href="#animationsequencereadonly">AnimationSequenceReadonly</a></code>
interface.
Mutable <a data-link-type="dfn" href="#animation-sequence">animation sequences</a> are represented by the <code class="idl"><a data-link-type="idl" href="#animationsequence">AnimationSequence</a></code>
interface.</p>


    <pre class="idl">[Constructor (sequence? children,
              optional (unrestricted double or AnimationTimingProperties) timing)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationsequencereadonly">AnimationSequenceReadonly<a class="self-link" href="#animationsequencereadonly"></a></dfn> : <a data-link-type="idl-name" href="#animationgroupreadonly">AnimationGroupReadonly</a> {
    <a data-link-type="idl-name" href="#animationsequence">AnimationSequence</a> <a class="idl-code" data-global-name="AnimationSequenceReadonly<interface>/clone()<method>" data-link-type="method" href="#dom-animationsequencereadonly-clone">clone</a> ();
};

[Constructor (sequence? children,
              optional (unrestricted double or AnimationTimingProperties) timing)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationsequence">AnimationSequence<a class="self-link" href="#animationsequence"></a></dfn> : <a data-link-type="idl-name" href="#animationsequencereadonly">AnimationSequenceReadonly</a> {
};
<a data-link-type="idl-name" href="#animationsequence">AnimationSequence</a> implements <a data-link-type="idl-name" href="#animationnodemutable">AnimationNodeMutable</a>;
<a data-link-type="idl-name" href="#animationsequence">AnimationSequence</a> implements <a data-link-type="idl-name" href="#animationgroupmutable">AnimationGroupMutable</a>;
</pre>


    <div class="contructors">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationSequence" data-dfn-type="constructor" data-export="" data-lt="AnimationSequence()" id="dom-animationsequence-animationsequence">
Constructor (sequence&lt;AnimationNodeReadonly>? children,
optional (unrestricted double or AnimationTimingProperties) timing)<a class="self-link" href="#dom-animationsequence-animationsequence"></a></dfn></p>
       

      <dd data-md="">
       <p>The meaning and handling of each of the parameters in this
constructor is identical to the <code class="idl"><a data-link-type="idl" href="#dom-animationgroup-animationgroupchildren-timing">AnimationGroup()</a></code> constructor.</p>
       
</dl>
</div>


    <div class="methods">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationSequenceReadonly" data-dfn-type="method" data-export="" data-lt="clone()" id="dom-animationsequencereadonly-clone">
AnimationSequence clone ()<a class="self-link" href="#dom-animationsequencereadonly-clone"></a></dfn></p>
       

      <dd data-md="">
       <p>Creates a deep copy of this <code class="idl"><a data-link-type="idl" href="#animationsequencereadonly">AnimationSequenceReadonly</a></code> object using
the same procedure as defined for the <code class="idl"><a data-link-type="idl" href="#dom-animationgroupreadonly-clone">clone()</a></code>
method of the <code class="idl"><a data-link-type="idl" href="#animationgroupreadonly">AnimationGroupReadonly</a></code> interface except that a new
<code class="idl"><a data-link-type="idl" href="#animationsequence">AnimationSequence</a></code> object is created.</p>
       
</dl>
</div>

    <h3 class="heading settled" data-level="5.12" id="the-animation-interfaces"><span class="secno">5.12. </span><span class="content">The <code>AnimationReadonly</code> and
<code>Animation</code> interfaces</span><a class="self-link" href="#the-animation-interfaces"></a></h3>


    <p><a data-link-type="dfn" href="#concept-animation">Animations</a> are represented by the <code class="idl"><a data-link-type="idl" href="#animationreadonly">AnimationReadonly</a></code> interface.
Mutable <a data-link-type="dfn" href="#concept-animation">animations</a> are represented by the <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> interface.</p>


    <pre class="idl">[<a class="idl-code" data-global-name="AnimationReadonly<interface>/AnimationReadonly(target, effect, timing)<constructor>" data-link-type="constructor" href="#dom-animationreadonly-animationreadonlytarget-effect-timing">Constructor</a> (<a data-link-type="idl-name" href="#animatable">Animatable</a>? <dfn class="idl-code" data-dfn-for="AnimationReadonly/AnimationReadonly(target, effect, timing)" data-dfn-type="argument" data-export="" data-global-name="AnimationReadonly<interface>/AnimationReadonly(target, effect, timing)<method>/target<argument>" id="dom-animationreadonly-animationreadonlytarget-effect-timing-target">target<a class="self-link" href="#dom-animationreadonly-animationreadonlytarget-effect-timing-target"></a></dfn>, object? <dfn class="idl-code" data-dfn-for="AnimationReadonly/AnimationReadonly(target, effect, timing)" data-dfn-type="argument" data-export="" data-global-name="AnimationReadonly<interface>/AnimationReadonly(target, effect, timing)<method>/effect<argument>" id="dom-animationreadonly-animationreadonlytarget-effect-timing-effect">effect<a class="self-link" href="#dom-animationreadonly-animationreadonlytarget-effect-timing-effect"></a></dfn>,
              optional (unrestricted double or <a data-link-type="idl-name" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a>) <dfn class="idl-code" data-dfn-for="AnimationReadonly/AnimationReadonly(target, effect, timing)" data-dfn-type="argument" data-export="" data-global-name="AnimationReadonly<interface>/AnimationReadonly(target, effect, timing)<method>/timing<argument>" id="dom-animationreadonly-animationreadonlytarget-effect-timing-timing">timing<a class="self-link" href="#dom-animationreadonly-animationreadonlytarget-effect-timing-timing"></a></dfn>)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationreadonly">AnimationReadonly<a class="self-link" href="#animationreadonly"></a></dfn> : <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a> {
    readonly attribute (<a data-link-type="idl-name" href="#animationeffectreadonly">AnimationEffectReadonly</a> or <a data-link-type="idl-name" href="#callbackdef-effectcallback">EffectCallback</a>)? <dfn class="idl-code" data-dfn-for="AnimationReadonly" data-dfn-type="attribute" data-export="" data-global-name="AnimationReadonly<interface>/effect<attribute>" data-readonly="" data-type="(AnimationEffectReadonly or EffectCallback)? " id="dom-animationreadonly-effect">effect<a class="self-link" href="#dom-animationreadonly-effect"></a></dfn>;
    readonly attribute <a data-link-type="idl-name" href="#animatable">Animatable</a>? <dfn class="idl-code" data-dfn-for="AnimationReadonly" data-dfn-type="attribute" data-export="" data-global-name="AnimationReadonly<interface>/target<attribute>" data-readonly="" data-type="Animatable? " id="dom-animationreadonly-target">target<a class="self-link" href="#dom-animationreadonly-target"></a></dfn>;
    <a data-link-type="idl-name" href="#animation">Animation</a> <a class="idl-code" data-global-name="AnimationReadonly<interface>/clone()<method>" data-link-type="method" href="#dom-animationreadonly-clone">clone</a> ();
};

[<a class="idl-code" data-global-name="Animation<interface>/Animation(target, effect, timing)<constructor>" data-link-type="constructor" href="#dom-animation-animationtarget-effect-timing">Constructor</a> (<a data-link-type="idl-name" href="#animatable">Animatable</a>? <dfn class="idl-code" data-dfn-for="Animation/Animation(target, effect, timing)" data-dfn-type="argument" data-export="" data-global-name="Animation<interface>/Animation(target, effect, timing)<method>/target<argument>" id="dom-animation-animationtarget-effect-timing-target">target<a class="self-link" href="#dom-animation-animationtarget-effect-timing-target"></a></dfn>, object? <dfn class="idl-code" data-dfn-for="Animation/Animation(target, effect, timing)" data-dfn-type="argument" data-export="" data-global-name="Animation<interface>/Animation(target, effect, timing)<method>/effect<argument>" id="dom-animation-animationtarget-effect-timing-effect">effect<a class="self-link" href="#dom-animation-animationtarget-effect-timing-effect"></a></dfn>,
              optional (unrestricted double or <a data-link-type="idl-name" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a>) <dfn class="idl-code" data-dfn-for="Animation/Animation(target, effect, timing)" data-dfn-type="argument" data-export="" data-global-name="Animation<interface>/Animation(target, effect, timing)<method>/timing<argument>" id="dom-animation-animationtarget-effect-timing-timing">timing<a class="self-link" href="#dom-animation-animationtarget-effect-timing-timing"></a></dfn>)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animation">Animation<a class="self-link" href="#animation"></a></dfn> : <a data-link-type="idl-name" href="#animationreadonly">AnimationReadonly</a> {
    inherit attribute (<a data-link-type="idl-name" href="#animationeffectreadonly">AnimationEffectReadonly</a> or <a data-link-type="idl-name" href="#callbackdef-effectcallback">EffectCallback</a>)? <a class="idl-code" data-global-name="Animation<interface>/effect<attribute>" data-link-type="attribute" data-type="(AnimationEffectReadonly or EffectCallback)? " href="#dom-animation-effect">effect</a>;
    inherit attribute <a data-link-type="idl-name" href="#animatable">Animatable</a>? <a class="idl-code" data-global-name="Animation<interface>/target<attribute>" data-link-type="attribute" data-type="Animatable? " href="#dom-animation-target">target</a>;
};
<a data-link-type="idl-name" href="#animation">Animation</a> implements <a data-link-type="idl-name" href="#animationnodemutable">AnimationNodeMutable</a>;
</pre>


    <div class="constructors">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationReadonly" data-dfn-type="constructor" data-export="" data-lt="AnimationReadonly(target, effect, timing)" id="dom-animationreadonly-animationreadonlytarget-effect-timing">
AnimationReadonly ()<a class="self-link" href="#dom-animationreadonly-animationreadonlytarget-effect-timing"></a></dfn></p>
       

      <dd data-md="">
       <p>Creates a new <code class="idl"><a data-link-type="idl" href="#animationreadonly">AnimationReadonly</a></code> object
using the following procedure:</p>
       


       <ol>
        <li data-md="">
         <p>Create a new <code class="idl"><a data-link-type="idl" href="#animationreadonly">AnimationReadonly</a></code> object, <var>animation</var>.</p>
        <p></p>


        <li data-md="">
         <p>Let <var>timing input</var> be the result of applying the
<a data-link-type="dfn" href="#procedure-for-processing-a-timing-argument">procedure for processing a timing argument</a> to <var>timing.</var></p>

        <li data-md="">
         <p>Set <code><var>animation</var>.timing</code> to a new
<code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code> object whose attributes are assigned the
value of the member of the same name on <var>timing input</var>.</p>


        <li data-md="">
         <p>Set <code><var>animation</var>.effect</code> to
the result of applying the <a data-link-type="dfn" href="#procedure-for-converting-an-effect-to-an-idl-value">procedure for converting an effect
to an IDL value</a> to <var>effect</var>.</p>
</ol>
       

       <div class="parameters">


        <dl>
         <dt data-md="">
          <p>Animatable? target</p>
          

         <dd data-md="">
          <p>The <a data-link-type="dfn" href="#animation-target">animation target</a> or target pseudo-element.
This may be <code>null</code> for animations that do not target
a specific element.</p>
          


         <dt data-md="">
          <p>object? effect</p>
          

         <dd data-md="">
          <p>The animation effect used to set the <code>effect</code>
attribute of the newly-created <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> object.</p>
          


          <p>The processing of this parameter is defined normatively in <a href="#processing-the-effect-parameter">§5.12.1 Processing the effect parameter</a>.
Following is a non-normative summary of this handing.</p>
          


          <p><var>effect</var> may be one of the following:</p>
          


          <ul>
           <li data-md="">
            <p>An <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> object,</p>
            

           <li data-md="">
            <p>An <code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code> function,</p>
            

           <li data-md="">
            <p>A single <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> object,</p>
            

           <li data-md="">
            <p>A sequence of <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> objects, or</p>
            

           <li data-md="">
            <p>null</p>
            
</ul>
          

          <p>If this parameter is an <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> object or
<code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code> object, it will be shared with any
other <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> objects referring to the same
<code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> or <code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code> object.
It will <em>not</em> be copied.</p>
          


          <p>If this parameter is of type <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> or
<code>sequence&lt;<a class="idl-code" data-link-type="dictionary" href="#dictdef-keyframe">Keyframe</a>></code>,
the <a data-link-type="dfn" href="#animation-effect">animation effect</a> of the newly-created <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> will be
a newly-created <code class="idl"><a data-link-type="idl" href="#keyframeeffect">KeyframeEffect</a></code> object
initialized by using this object as the list of
<a data-link-type="dfn" href="#keyframe">keyframes</a> and with all other parameters set to their
default values.</p>
          


          <p>If this parameter is <code>null</code>, the newly-created
<code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> will also have a <code>null</code> animation effect.</p>
          

         <dt data-md="">
          <p>optional (unrestricted double or AnimationTimingProperties)
timing</p>
          

         <dd data-md="">
          <p>The timing properties or <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> of the new
animation.</p>
          
</dl>
</div>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="Animation" data-dfn-type="constructor" data-export="" data-lt="Animation(target, effect, timing)" id="dom-animation-animationtarget-effect-timing">
Animation ()<a class="self-link" href="#dom-animation-animationtarget-effect-timing"></a></dfn></p>
       

      <dd data-md="">
       <p>Creates a new <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> object using the same procedure as with
the <code class="idl"><a data-link-type="idl" href="#dom-animationreadonly-animationreadonlytarget-effect-timing">AnimationReadonly()</a></code> constructor with the following differences:</p>
       


       <ul>
        <li data-md="">
         <p><var>animation</var> is initialized to a new <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> object rather
than a new <code class="idl"><a data-link-type="idl" href="#animationreadonly">AnimationReadonly</a></code> object.</p>
         

        <li data-md="">
         <p><code><var>animation</var>.timing</code> is set to a new
<code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> object rather than a new <code class="idl"><a data-link-type="idl" href="#animationtimingreadonly">AnimationTimingReadonly</a></code>
object.</p>
         
</ul>
       

       <p>Examples of the usage of this constructor are given in <a href="#creating-a-new-animation-object">§5.12.2 Creating a new Animation object</a>.</p>
       
</dl>
</div>


    <div class="attributes">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="Animation" data-dfn-type="attribute" data-export="" id="dom-animation-effect">effect<a class="self-link" href="#dom-animation-effect"></a></dfn>, <span> of type <a data-link-type="idl-name">(AnimationEffectReadonly or EffectCallback)</a>, nullable</span></p>
       

      <dd data-md="">
       <p>The <a data-link-type="dfn" href="#animation-effect">animation effect</a> or <a data-link-type="dfn" href="#custom-effect">custom effect</a> to apply.
May be <code>null</code> in which case the animation will produce
no observable effect.</p>
       


       <p class="issue" id="issue-67055717"><a class="self-link" href="#issue-67055717"></a>On setting, if the previous value was an <code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code>, we
    should call the old callback with a null time fraction so it can
    clear its result.</p>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="Animation" data-dfn-type="attribute" data-export="" id="dom-animation-target">target<a class="self-link" href="#dom-animation-target"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animatable">Animatable</a>, nullable</span></p>
       

      <dd data-md="">
       <p>The element or pseudo-element being animated by this object.
This may be <code>null</code> for animations that do not target
a specific element such as an animation that produces a sound
using an audio API.</p>
       
</dl>
</div>


    <div class="methods">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="AnimationReadonly" data-dfn-type="method" data-export="" data-lt="clone()" id="dom-animationreadonly-clone">
Animation clone ()<a class="self-link" href="#dom-animationreadonly-clone"></a></dfn></p>
       

      <dd data-md="">
       <p>Creates a new <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> object by copying the properties of the
<code class="idl"><a data-link-type="idl" href="#animationreadonly">AnimationReadonly</a></code> object on which it is called as follows:</p>
       


       <ol>
        <li data-md="">
         <p>Let <var>source</var> be the <code class="idl"><a data-link-type="idl" href="#animationreadonly">AnimationReadonly</a></code> object to
clone, that is, this object.</p>
        <p></p>

        <li data-md="">
         <p>Let <var>cloned timing</var> be a new
<code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> object whose members are assigned
the value of the attribute with the same name on
<code><var>source</var>.timing</code>.</p>
        <p></p>

        <li data-md="">
         <p>The <a data-link-type="dfn" href="#animation-effect">animation effect</a> is cloned depending on the type of
<code><var>source</var>.effect</code> as follows,</p>


         <div class="switch">


          <dl>
           <dt data-md="">
            <p>If <code><var>source</var>.effect</code> is an
<code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> object,</p>
            

           <dd data-md="">
            <p>Let <var>cloned effect</var> be the result of calling
<code><var>source</var>.effect.clone()</code>.</p>
            

           <dt data-md="">
            <p>If <code><var>source</var>.effect</code> is an
<code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code> object,</p>
            

           <dd data-md="">
            <p>Let <var>cloned effect</var> be
<code><var>source</var>.effect</code>.</p>
            

           <dt data-md="">
            <p>Otherwise,</p>
            

           <dd data-md="">
            <p>Let <var>cloned effect</var> be <code>null</code>.</p>
            
</dl>
</div>


        <li data-md="">
         <p>Return a new <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> object created by
calling the <code class="idl"><a data-link-type="idl" href="#dom-animation-animationtarget-effect-timing">Animation()</a></code> constructor with parameters
<code>Animation(<var>source</var>.target, <var>cloned
effect</var>, <var>cloned timing</var>)</code>.</p>
        <p></p>
</ol></dl>
</div>


    <h4 class="heading settled" data-level="5.12.1" id="processing-the-effect-parameter"><span class="secno">5.12.1. </span><span class="content">Processing the <var>effect</var> parameter</span><a class="self-link" href="#processing-the-effect-parameter"></a></h4>


    <p>The <var>effect</var> parameter, an ECMAScript value passed to the
<code class="idl"><a data-link-type="idl" href="#dom-animationreadonly-animationreadonlytarget-effect-timing">AnimationReadonly()</a></code> constructor, the <code class="idl"><a data-link-type="idl" href="#dom-animation-animationtarget-effect-timing">Animation()</a></code> constructor, or to
the <code class="idl"><a data-link-type="idl" href="#dom-animatable-animate">animate()</a></code> operation of the <code class="idl"><a data-link-type="idl" href="#animatable">Animatable</a></code> interface,
may specify an <code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code>, an <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code>,
a <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code>, a sequence of <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code>s, or <span class="esvalue">null</span>.
However, since callback functions and dictionaries are not
distinguishable in WebIDL, we define the processing of this
parameter for ECMAScript here in prose.</p>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="procedure-for-converting-an-effect-to-an-idl-value">procedure for converting an effect to an IDL value<a class="self-link" href="#procedure-for-converting-an-effect-to-an-idl-value"></a></dfn>
with parameter <var>effect</var> is as follows:</p>


    <div class="switch">


     <dl>
      <dt data-md="">
       <p>If <var>effect</var> is <span class="esvalue">null</span>,</p>
       

      <dd data-md="">
       <p>Return <span class="idlvalue">null</span>.</p>
       


      <dt data-md="">
       <p>If <var>effect</var> is a <a data-link-type="dfn" href="http://www.w3.org/TR/WebIDL/#dfn-platform-object">platform
object</a> that implements <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code>,</p>
       

      <dd data-md="">
       <p>return the IDL value that is a reference to the that platform
object.</p>
       


      <dt data-md="">
       <p>If IsCallable(<var>effect</var>) is true,</p>
       

      <dd data-md="">
       <p>Return the result of applying the <a href="http://www.w3.org/TR/WebIDL/#es-callback-function">procedure
for converting an ECMAScript value to an IDL callback function
type</a> to <var>effect</var> using <code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code> as the
callback function type.</p>
       


      <dt data-md="">
       <p>Otherwise,</p>
       

      <dd data-md="">
       <p>Return a new <code class="idl"><a data-link-type="idl" href="#keyframeeffect">KeyframeEffect</a></code> object constructed passing
<var>effect</var> as the <var>frames</var> parameter.</p>
       
</dl>
</div>


    <p class="note" role="note">Note: since the processing of this parameter is defined in prose, the
    above steps will take place after any coercion is applied to other
    parameters passed to the same operation.</p>


    <h4 class="heading settled" data-level="5.12.2" id="creating-a-new-animation-object"><span class="secno">5.12.2. </span><span class="content">Creating a new <code>Animation</code> object</span><a class="self-link" href="#creating-a-new-animation-object"></a></h4>


    <div class="informative-bg"><em>This section is non-normative</em>


     <p>The <code class="idl"><a data-link-type="idl" href="#dom-animationreadonly-animationreadonlytarget-effect-timing">AnimationReadonly()</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-animation-animationtarget-effect-timing">Animation()</a></code> constructors offer a number of
approaches to creating a new <code class="idl"><a data-link-type="idl" href="#animationreadonly">AnimationReadonly</a></code> and <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> objects.
At its simplest, an <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> object that changes the
‘left’ property of <var>elem</var> to 100px over three
seconds can be constructed as follows:</p>


     <pre class="example lang-javascript">var anim = new Animation(elem, { left: '100px' }, 3000);</pre>


     <p>The second parameter, representing the <a data-link-type="dfn" href="#animation-effect">animation effect</a>, may
specify multiple properties, an <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> object, or
even a callback function.</p>


     <pre class="example lang-javascript">// Specify multiple properties at once
var animA = new Animation(elem, { left: '100px', top: '300px' }, 3000);

// Specify multiple frames
var animB = new Animation(elem, [ { left: '100px' }, { left: '300px' } ], 3000);

// Share the animation effect of another animation
var animC = new Animation(elem, animB.effect, 3000);

// Supply a custom script-based animation effect
var animD = new Animation(elem, function(time) {
    // (Normally we should check for time===null, but in this case it produces
    //  the correct result anyway)
    document.documentElement.currentScale = 1.0 + time * 2.0;
  }, 3000);</pre>


     <p>The third parameter representing the animation’s timing, may
simply be a number representing the <a data-link-type="dfn" href="#iteration-duration">iteration duration</a> in
milliseconds as above, or, to specify further timing properties such
as the <a data-link-type="dfn" href="#start-delay">start delay</a>, an <code class="idl"><a data-link-type="idl" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a></code> object can
be used, as follows:</p>


     <pre class="example lang-javascript">var anim =
  new Animation(elem, { left: '100px' }, { duration: 3000, delay: 2000 });</pre>


     <p>If the duration is not specified, the <a data-link-type="dfn" href="#intrinsic-iteration-duration">intrinsic iteration
duration</a> is used which, for an <a data-link-type="dfn" href="#concept-animation">animation</a>, is zero.
It is possible to create an animation that simply sets a property
without any interpolation as follows:</p>


     <pre class="example lang-javascript">new Animation(elem, { display: 'none' }, { fill: 'forwards' });</pre>


     <p>This is particularly useful in combination with other <a data-link-type="dfn" href="#concept-animation">animations</a> or
<a data-link-type="dfn" href="#animation-node">animation nodes</a>.
For example, fading an element before switching
‘display’ to ‘none’ can be achieved as
follows,</p>


     <pre class="example lang-javascript">new AnimationSequence(
  [
    new Animation(elem, { opacity: 0 }, 1000),
    new Animation(elem, { display: 'none' }, { fill: 'forwards' })
  ]
);</pre>


     <p>Having created an <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code>, it can be played using
<code>document.timeline.play(<var>anim</var>)</code>.
For simple effects, however, the <a href="#extensions-to-the-element-interface"><code>Element.animate</code></a>
shortcut is more convenient since it performs this last step
automatically. For example,</p>


     <pre class="example lang-javascript">elem.animate({ left: '100px' }, 3000);</pre>

</div>


    <h3 class="heading settled" data-level="5.13" id="the-animatable-interface"><span class="secno">5.13. </span><span class="content">The <code>Animatable</code> interface</span><a class="self-link" href="#the-animatable-interface"></a></h3>


    <p>Objects that may be the target of an <code class="idl"><a data-link-type="idl" href="#animationreadonly">AnimationReadonly</a></code> object implement the
<code class="idl"><a data-link-type="idl" href="#animatable">Animatable</a></code> interface.</p>


    <pre class="idl">[NoInterfaceObject]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animatable">Animatable<a class="self-link" href="#animatable"></a></dfn> {
    <a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>                <dfn class="idl-code" data-dfn-for="Animatable" data-dfn-type="method" data-export="" data-global-name="Animatable<interface>/animate(effect, timing)<method>/animate(effect)<method>" data-lt="animate(effect, timing)|animate(effect)" id="dom-animatable-animateeffect-timing">animate<a class="self-link" href="#dom-animatable-animateeffect-timing"></a></dfn> (object? <dfn class="idl-code" data-dfn-for="Animatable/animate" data-dfn-type="argument" data-export="" data-global-name="Animatable/animate/effect<argument>" id="dom-animatable-animate-effect">effect<a class="self-link" href="#dom-animatable-animate-effect"></a></dfn>,
                                            optional (double or <a data-link-type="idl-name" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a>) <dfn class="idl-code" data-dfn-for="Animatable/animate" data-dfn-type="argument" data-export="" data-global-name="Animatable/animate/timing<argument>" id="dom-animatable-animate-timing">timing<a class="self-link" href="#dom-animatable-animate-timing"></a></dfn>);
    sequence&lt;<a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>> <a class="idl-code" data-global-name="Animatable<interface>/getAnimationPlayers()<method>" data-link-type="method" href="#dom-animatable-getanimationplayers">getAnimationPlayers</a> ();
};
</pre>


    <div class="methods">


     <dl>
      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="Animatable" data-dfn-type="method" data-export="" data-lt="animate()" id="dom-animatable-animate">
AnimationPlayer animate(object? effect,
    optional (double or AnimationTimingProperties) timing)<a class="self-link" href="#dom-animatable-animate"></a></dfn></p>
       

      <dd data-md="">
       <p>Creates a new <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> object
whose <a data-link-type="dfn" href="#animation-target">animation target</a> is the object on which the method is
called, and calls the <code class="idl"><a data-link-type="idl" href="#dom-animationtimeline-play">play()</a></code> method of the
<code class="idl"><a data-link-type="idl" href="#animationtimeline">AnimationTimeline</a></code> object of the <a data-link-type="dfn" href="#document-timeline">document timeline</a> of the <a href="http://www.w3.org/TR/dom/#concept-node-document">node
document</a> <a data-link-type="biblio" href="#biblio-dom">[DOM]</a> of the element, passing the newly created
<code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> as the argument to the method.</p>
       


       <p>The following code fragment:</p>
       

    
       <div>
        <pre class="example lang-javascript">var anim = elem.animate({ opacity: 0 }, 2000);</pre>
       </div>
       


       <p>is equivalent to:</p>
       

    
       <div>
        <pre class="example lang-javascript">var anim = new Animation(elem, { opacity: 0 }, 2000);
elem.ownerDocument.timeline.play(anim);</pre>
       </div>
       


       <p>Returns the <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code> object returned by the
<code class="idl"><a data-link-type="idl" href="#dom-animationtimeline-play">play()</a></code> method of the <code class="idl"><a data-link-type="idl" href="#animationtimeline">AnimationTimeline</a></code>.</p>
       


       <div class="parameters">


        <dl>
         <dt data-md="">
          <p>object? effect</p>
          

         <dd data-md="">
          <p>The effect to apply.
This value is passed to the <code class="idl"><a data-link-type="idl" href="#dom-animation-animationtarget-effect-timing">Animation()</a></code> constructor 
as the <var>effect</var> parameter and has the
same interpretation as defined for that constructor.</p>
          

         <dt data-md="">
          <p>optional (double or AnimationTimingProperties) timing</p>
          

         <dd data-md="">
          <p>The timing parameters of the animation.
This value is passed to the <code class="idl"><a data-link-type="idl" href="#dom-animation-animationtarget-effect-timing">Animation()</a></code> constructor
as the <var>timing</var> parameter and has the
same interpretation as defined for that constructor.</p>
          
</dl>
</div>
       


      <dt data-md="">
       <p><dfn class="idl-code" data-dfn-for="Animatable" data-dfn-type="method" data-export="" data-lt="getAnimationPlayers()" id="dom-animatable-getanimationplayers">
sequence&lt;AnimationPlayer> getAnimationPlayers()<a class="self-link" href="#dom-animatable-getanimationplayers"></a></dfn></p>
       

      <dd data-md="">
       <p>Returns the set of <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code> objects
whose <a data-link-type="dfn" href="#source-content">source content</a> is <a data-link-type="dfn" href="#current">current</a> or <a data-link-type="dfn" href="#in-effect">in effect</a> and
contains at least one <a data-link-type="dfn" href="#concept-animation">animation</a> whose
<a data-link-type="dfn" href="#animation-target">animation target</a> is this
object.</p>
       


       <p>If this object is the <a data-link-type="dfn" href="#animation-target">animation target</a> of two or more
<a data-link-type="dfn" href="#concept-animation">animations</a> which are associated with the
same <a data-link-type="dfn" href="#player">player</a>, the corresponding <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code>
object will still only appear in the returned list once.</p>
       


       <p>The returned list is sorted in increasing order by <a data-link-type="dfn" href="#player-sequence-number">player
sequence number</a>.</p>
       


       <p>The returned list reflects the state <em>after</em> applying any pending
changes to animation such as changes to animation-related style properties
that have yet to be processed.</p>
       
</dl>

     <h3 class="heading settled" data-level="5.14" id="the-animationeffectreadonly-interface"><span class="secno">5.14. </span><span class="content">The <code>AnimationEffectReadonly</code> interface</span><a class="self-link" href="#the-animationeffectreadonly-interface"></a></h3>


     <p><a data-link-type="dfn" href="#animation-effect">Animation effects</a> are represented by
the <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> interface.</p>


     <p><code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> is an abstract interface inherited by
<code class="idl"><a data-link-type="idl" href="#keyframeeffectreadonly">KeyframeEffectReadonly</a></code>.</p>


     <p>All members of <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> are read-only.
Interfaces that inherit from <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> that are intended to
be mutable must provide the equivalent setter for each member.</p>


     <pre class="idl">interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="animationeffectreadonly">AnimationEffectReadonly<a class="self-link" href="#animationeffectreadonly"></a></dfn> {
    readonly attribute DOMString                   <a class="idl-code" data-global-name="AnimationEffectReadonly<interface>/name<attribute>" data-link-type="attribute" data-readonly="" data-type="DOMString                   " href="#dom-animationeffectreadonly-name">name</a>;
    readonly attribute <a data-link-type="idl-name" href="#enumdef-iterationcompositeoperation">IterationCompositeOperation</a> <a class="idl-code" data-global-name="AnimationEffectReadonly<interface>/iterationComposite<attribute>" data-link-type="attribute" data-readonly="" data-type="IterationCompositeOperation " href="#dom-animationeffectreadonly-iterationcomposite">iterationComposite</a>;
    readonly attribute <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>          <a class="idl-code" data-global-name="AnimationEffectReadonly<interface>/composite<attribute>" data-link-type="attribute" data-readonly="" data-type="CompositeOperation          " href="#dom-animationeffectreadonly-composite">composite</a>;
};
</pre>


     <div class="attributes">


      <dl>
       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="AnimationEffectReadonly" data-dfn-type="attribute" data-export="" id="dom-animationeffectreadonly-name">name<a class="self-link" href="#dom-animationeffectreadonly-name"></a></dfn>, <span> of type <a data-link-type="idl-name">DOMString</a>, readonly</span></p>
        

       <dd data-md="">
        <p>A string used to identify the effect.</p>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="AnimationEffectReadonly" data-dfn-type="attribute" data-export="" id="dom-animationeffectreadonly-iterationcomposite">iterationComposite<a class="self-link" href="#dom-animationeffectreadonly-iterationcomposite"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-iterationcompositeoperation">IterationCompositeOperation</a>, readonly</span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#iteration-composite-operation">iteration composite operation</a> property of this
<a data-link-type="dfn" href="#animation-effect">animation effect</a> as specified by one of the
<a data-link-type="dfn" href="#iterationcompositeoperation">IterationCompositeOperation</a> enumeration values.</p>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="AnimationEffectReadonly" data-dfn-type="attribute" data-export="" id="dom-animationeffectreadonly-composite">composite<a class="self-link" href="#dom-animationeffectreadonly-composite"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>, readonly</span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#composite-operation">composite operation</a> used to composite this
<a data-link-type="dfn" href="#animation-effect">animation effect</a> with the <a data-link-type="dfn" href="#animation-stack">animation stack</a>, as
specified by one of the <a data-link-type="dfn" href="#compositeoperation">CompositeOperation</a> enumeration
values.</p>
        
</dl>
</div>


     <div class="annotation">
In future, we may expose <code>any sample (double?  timeFraction,
double currentIteration, Animatable? target, any
underlyingValue)</code> so that the animation effects can be driven
apart from the timing model.
</div>


     <h3 class="heading settled" data-level="5.15" id="the-iterationcompositeoperation-enumeration"><span class="secno">5.15. </span><span class="content">The <code>IterationCompositeOperation</code> enumeration</span><a class="self-link" href="#the-iterationcompositeoperation-enumeration"></a></h3>


     <p>The possible values of an <a data-link-type="dfn" href="#animation-effect">animation effect</a>’s
<a data-link-type="dfn" href="#iteration-composite-operation">iteration composite operation</a> are represented by the
<dfn data-dfn-type="dfn" data-noexport="" id="iterationcompositeoperation">IterationCompositeOperation<a class="self-link" href="#iterationcompositeoperation"></a></dfn> enumeration.</p>


     <pre class="idl">enum <dfn class="idl-code" data-dfn-type="enum" data-export="" data-global-name="" id="enumdef-iterationcompositeoperation">IterationCompositeOperation<a class="self-link" href="#enumdef-iterationcompositeoperation"></a></dfn> {"replace", "accumulate"};
</pre>


     <dl>
      <dt data-md="">
       <p><code>replace</code></p>
       

      <dd data-md="">
       <p>Corresponds to the <a data-link-type="dfn" href="#iteration-composite-operation-replace">replace</a>
<a data-link-type="dfn" href="#iteration-composite-operation">iteration composite operation</a> value such that the
<a data-link-type="dfn" href="#intermediate-animation-value">intermediate animation value</a> produced is independent of the
<a data-link-type="dfn" href="#current-iteration">current iteration</a>.</p>
       

      <dt data-md="">
       <p><code>accumulate</code></p>
       

      <dd data-md="">
       <p>Corresponds to the <a data-link-type="dfn" href="#iteration-composite-operation-accumulate">accumulate</a>
iteration composite operation value such that
subsequent iterations of an <a data-link-type="dfn" href="#concept-animation">animation</a> build
on the final value of the previous iteration.</p>
       
</dl>

     <h3 class="heading settled" data-level="5.16" id="the-compositeoperation-enumeration"><span class="secno">5.16. </span><span class="content">The <code>CompositeOperation</code> enumeration</span><a class="self-link" href="#the-compositeoperation-enumeration"></a></h3>


     <p>The possible values of an <a data-link-type="dfn" href="#animation-effect">animation effect</a>’s
composition behavior are represented by the
<dfn data-dfn-type="dfn" data-noexport="" id="compositeoperation">CompositeOperation<a class="self-link" href="#compositeoperation"></a></dfn> enumeration.</p>


     <pre class="idl">enum <dfn class="idl-code" data-dfn-type="enum" data-export="" data-global-name="" id="enumdef-compositeoperation">CompositeOperation<a class="self-link" href="#enumdef-compositeoperation"></a></dfn> {"replace", "add", "accumulate"};
</pre>


     <dl>
      <dt data-md="">
       <p><code>replace</code></p>
       

      <dd data-md="">
       <p>Corresponds to the <a data-link-type="dfn" href="#composite-operation-replace">replace</a>
<a data-link-type="dfn" href="#composite-operation">composite operation</a> value such that
the <a data-link-type="dfn" href="#animation-effect">animation effect</a> overrides the <a data-link-type="dfn" href="#underlying-value">underlying value</a> it
is combined with.</p>
       


      <dt data-md="">
       <p><code>add</code></p>
       

      <dd data-md="">
       <p>Corresponds to the <a data-link-type="dfn" href="#composite-operation-add">add</a>
<a data-link-type="dfn" href="#composite-operation">composite operation</a> value such that
the <a data-link-type="dfn" href="#animation-effect">animation effect</a> is <a data-link-type="dfn" href="#animation-addition">added</a> to the <a data-link-type="dfn" href="#underlying-value">underlying value</a>
with which it is combined.</p>
       


      <dt data-md="">
       <p><code>accumulate</code></p>
       

      <dd data-md="">
       <p>Corresponds to the <a data-link-type="dfn" href="#composite-operation-accumulate">accumulate</a>
<a data-link-type="dfn" href="#composite-operation">composite operation</a> value such that
the <a data-link-type="dfn" href="#animation-effect">animation effect</a> is <a data-link-type="dfn" href="#animation-accumulation">accumulated</a> on to the
<a data-link-type="dfn" href="#underlying-value">underlying value</a>.</p>
       
</dl>

     <h3 class="heading settled" data-level="5.17" id="the-keyframeeffect-interfaces"><span class="secno">5.17. </span><span class="content">The <code>KeyframeEffectReadonly</code>
  and <code>KeyframeEffect</code> interfaces</span><a class="self-link" href="#the-keyframeeffect-interfaces"></a></h3>


     <p><a data-link-type="dfn" href="#keyframe-animation-effect">Keyframe animation effects</a> are represented by the
<code class="idl"><a data-link-type="idl" href="#keyframeeffectreadonly">KeyframeEffectReadonly</a></code> interface.
Mutable <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation effects</a> are represented by the
<code class="idl"><a data-link-type="idl" href="#keyframeeffect">KeyframeEffect</a></code> interface.</p>


     <pre class="idl">[<a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/KeyframeEffectReadonly(frames, options)<constructor>" data-link-type="constructor" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options">Constructor</a> (object <a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/KeyframeEffectReadonly(frames, options)<method>/frames<argument>" data-link-type="argument" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options-frames">frames</a>, optional <a data-link-type="idl-name" href="#dictdef-keyframeeffectoptions">KeyframeEffectOptions</a> <a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/KeyframeEffectReadonly(frames, options)<method>/options<argument>" data-link-type="argument" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options-options">options</a>)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="keyframeeffectreadonly">KeyframeEffectReadonly<a class="self-link" href="#keyframeeffectreadonly"></a></dfn> : <a data-link-type="idl-name" href="#animationeffectreadonly">AnimationEffectReadonly</a> {
    readonly attribute DOMString <a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/spacing<attribute>" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-keyframeeffectreadonly-spacing">spacing</a>;
    <a data-link-type="idl-name" href="#keyframeeffect">KeyframeEffect</a>               <a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/clone()<method>" data-link-type="method" href="#dom-keyframeeffectreadonly-clone">clone</a>();
    sequence&lt;<a data-link-type="idl-name" href="#dictdef-computedkeyframe">ComputedKeyframe</a>>   <a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/getFrames()<method>" data-link-type="method" href="#dom-keyframeeffectreadonly-getframes">getFrames</a> ();
};

[<a class="idl-code" data-global-name="KeyframeEffect<interface>/KeyframeEffect(frames, options)<constructor>" data-link-type="constructor" href="#dom-keyframeeffect-keyframeeffectframes-options">Constructor</a> (object <a class="idl-code" data-global-name="KeyframeEffect<interface>/KeyframeEffect(frames, options)<method>/frames<argument>" data-link-type="argument" href="#dom-keyframeeffect-keyframeeffectframes-options-frames">frames</a>, optional <a data-link-type="idl-name" href="#dictdef-keyframeeffectoptions">KeyframeEffectOptions</a> <a class="idl-code" data-global-name="KeyframeEffect<interface>/KeyframeEffect(frames, options)<method>/options<argument>" data-link-type="argument" href="#dom-keyframeeffect-keyframeeffectframes-options-options">options</a>)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" data-global-name="" id="keyframeeffect">KeyframeEffect<a class="self-link" href="#keyframeeffect"></a></dfn> : <a data-link-type="idl-name" href="#keyframeeffectreadonly">KeyframeEffectReadonly</a> {
    // Mutable overrides of AnimationEffectReadonly members
    inherit attribute DOMString                   <a class="idl-code" data-global-name="KeyframeEffect<interface>/name<attribute>" data-link-type="attribute" data-type="DOMString                   " href="#dom-keyframeeffect-name">name</a>;
    inherit attribute <a data-link-type="idl-name" href="#enumdef-iterationcompositeoperation">IterationCompositeOperation</a> <a class="idl-code" data-global-name="KeyframeEffect<interface>/iterationComposite<attribute>" data-link-type="attribute" data-type="IterationCompositeOperation " href="#dom-keyframeeffect-iterationcomposite">iterationComposite</a>;
    inherit attribute <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>          <a class="idl-code" data-global-name="KeyframeEffect<interface>/composite<attribute>" data-link-type="attribute" data-type="CompositeOperation          " href="#dom-keyframeeffect-composite">composite</a>;

    // Mutable additions to KeyframeEffectReadonly interface
    inherit attribute DOMString <a class="idl-code" data-global-name="KeyframeEffect<interface>/spacing<attribute>" data-link-type="attribute" data-type="DOMString " href="#dom-keyframeeffect-spacing">spacing</a>;
    void                        <a class="idl-code" data-global-name="KeyframeEffect<interface>/setFrames(frames)<method>" data-link-type="method" href="#dom-keyframeeffect-setframesframes">setFrames</a> (object <a class="idl-code" data-global-name="KeyframeEffect/setFrames/frames<argument>" data-link-type="argument" href="#dom-keyframeeffect-setframes-frames">frames</a>);
};
</pre>


     <div class="constructors">


      <dl>
       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffectReadonly" data-dfn-type="constructor" data-export="" data-lt="KeyframeEffectReadonly(frames, options)" id="dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options">
KeyframeEffectReadonly ()<a class="self-link" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options"></a></dfn></p>
        

       <dd data-md="">
        <p>Creates a new <code class="idl"><a data-link-type="idl" href="#keyframeeffectreadonly">KeyframeEffectReadonly</a></code> object for the given set of
keyframes.</p>
        


        <div class="parameters">


         <dl>
          <dt data-md="">
           <p><dfn class="idl-code" data-dfn-for="KeyframeEffectReadonly/KeyframeEffectReadonly(frames, options)" data-dfn-type="argument" data-export="" data-lt="frames" id="dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options-frames"><dfn class="idl-code" data-dfn-for="KeyframeEffect/KeyframeEffect(frames, options)" data-dfn-type="argument" data-export="" data-lt="frames" id="dom-keyframeeffect-keyframeeffectframes-options-frames">object frames<a class="self-link" href="#dom-keyframeeffect-keyframeeffectframes-options-frames"></a></dfn><a class="self-link" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options-frames"></a></dfn></p>
           

          <dd data-md="">
           <p>A <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> object or sequence of <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> objects used for
calculating animation values for this <a data-link-type="dfn" href="#animation-effect">animation effect</a>.
The constraints on this parameter and its processing are
identical to those specified for the
<code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-setframes-frames">frames</a></code> argument to
<code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-setframesframes">setFrames()</a></code>.</p>
           


          <dt data-md="">
           <p><dfn class="idl-code" data-dfn-for="KeyframeEffectReadonly/KeyframeEffectReadonly(frames, options)" data-dfn-type="argument" data-export="" data-lt="options" id="dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options-options"><dfn class="idl-code" data-dfn-for="KeyframeEffect/KeyframeEffect(frames, options)" data-dfn-type="argument" data-export="" data-lt="options" id="dom-keyframeeffect-keyframeeffectframes-options-options">optional KeyframeEffect options<a class="self-link" href="#dom-keyframeeffect-keyframeeffectframes-options-options"></a></dfn><a class="self-link" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options-options"></a></dfn></p>
           

          <dd data-md="">
           <p>A <code class="idl"><a data-link-type="idl" href="#dictdef-keyframeeffectoptions">KeyframeEffectOptions</a></code> dictionary defining other aspects
of the <a data-link-type="dfn" href="#animation-effect">animation effect</a>’s behavior.
If this parameter is not provided, the default values of the
dictionary are used.</p>
           
</dl>
</div>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffect" data-dfn-type="constructor" data-export="" data-lt="KeyframeEffect(frames, options)" id="dom-keyframeeffect-keyframeeffectframes-options">
KeyframeEffect ()<a class="self-link" href="#dom-keyframeeffect-keyframeeffectframes-options"></a></dfn></p>
        

       <dd data-md="">
        <p>Creates a new <code class="idl"><a data-link-type="idl" href="#keyframeeffect">KeyframeEffect</a></code> object for the given set of keyframes.
The meaning and processing of the
<code>frames</code> and <code>options</code> arguments is identical to that
defined for the <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options">KeyframeEffectReadonly()</a></code> constructor.</p>
        
</dl>
</div>


     <div class="attributes">


      <dl>
       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffectReadonly" data-dfn-type="attribute" data-export="" id="dom-keyframeeffectreadonly-spacing">spacing<a class="self-link" href="#dom-keyframeeffectreadonly-spacing"></a></dfn>, <span> of type <a data-link-type="idl-name">DOMString</a>, readonly</span></p>
        

       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffect" data-dfn-type="attribute" data-export="" id="dom-keyframeeffect-spacing">spacing<a class="self-link" href="#dom-keyframeeffect-spacing"></a></dfn>, <span> of type <a data-link-type="idl-name">DOMString</a></span></p>
        

       <dd data-md="">
        <p>On getting, returns the <a data-link-type="dfn" href="#keyframe-spacing-mode">spacing mode</a> to
use for this <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation effect</a>.</p>
        


        <p>On setting, sets the <a data-link-type="dfn" href="#keyframe-spacing-mode">spacing mode</a>
property of this <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation effect</a> to the provided value.</p>
        


        <p>Recognized values are defined by the following grammar:</p>
        


        <blockquote>
  
         <div class="production">distribute | paced({ident})</div>
</blockquote>
        


        <p><code>{ident}</code> here is an <a href="http://www.w3.org/TR/css3-values/#identifier">identifier</a>
as defined by CSS3 Values <a data-link-type="biblio" href="#biblio-css3val">[CSS3VAL]</a>.</p>
        


        <p>The meaning of each value is as follows:</p>
        


        <dl>
         <dt data-md="">
          <p>distribute</p>
          

         <dd data-md="">
          <p>Use the <a data-link-type="dfn" href="#distribute-keyframe-spacing-mode">distribute keyframe spacing mode</a>.</p>
          

         <dt data-md="">
          <p>paced({ident})</p>
          

         <dd data-md="">
          <p>Use the <a data-link-type="dfn" href="#paced-keyframe-spacing-mode">paced keyframe spacing mode</a> with the property
name indicated by <code>{ident}</code> as the <a data-link-type="dfn" href="#paced-property">paced
property</a>.</p>
          


          <p>For example, <code>paced(transform)</code> would indicate that
the keyframes should be spaced such that changes to the <span class="prop-name">transform</span> property occur at
a constant rate.</p>
          
</dl>
        

        <p>All other values are treated as "distribute" for the purpose of
animation model calculations.</p>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffect" data-dfn-type="attribute" data-export="" id="dom-keyframeeffect-name">name<a class="self-link" href="#dom-keyframeeffect-name"></a></dfn>, <span> of type <a data-link-type="idl-name">DOMString</a></span></p>
        

       <dd data-md="">
        <p>A string used to identify this effect.
The getter for this attribute is inherited from the
<code class="idl"><a data-link-type="idl" href="#dom-animationeffectreadonly-name">name</a></code> attribute on <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code>
interface.</p>
        


        <p>On setting, replaces the string with the provided DOMString.</p>
        


        <p class="issue" id="issue-d42a6a0c"><a class="self-link" href="#issue-d42a6a0c"></a>We should define the name as an internal member in the model and
reference that here.</p>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffect" data-dfn-type="attribute" data-export="" id="dom-keyframeeffect-iterationcomposite">iterationComposite<a class="self-link" href="#dom-keyframeeffect-iterationcomposite"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-iterationcompositeoperation">IterationCompositeOperation</a></span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#iteration-composite-operation">iteration composite operation</a> of this <a data-link-type="dfn" href="#animation-effect">animation effect</a>.
The getter for this attribute is inherited from the
<code class="idl"><a data-link-type="idl" href="#dom-animationeffectreadonly-iterationcomposite">iterationComposite</a></code> attribute on
<code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> interface.</p>
        


        <p>On setting, sets the <a data-link-type="dfn" href="#iteration-composite-operation">iteration composite operation</a> property of this
<a data-link-type="dfn" href="#animation-effect">animation effect</a> to the provided value.</p>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffect" data-dfn-type="attribute" data-export="" id="dom-keyframeeffect-composite">composite<a class="self-link" href="#dom-keyframeeffect-composite"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a></span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#composite-operation">composite operation</a> of this <a data-link-type="dfn" href="#animation-effect">animation effect</a>.
The getter for this attribute is inherited from the
<code class="idl"><a data-link-type="idl" href="#dom-animationeffectreadonly-composite">composite</a></code> attribute on
<code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> interface.</p>
        


        <p>On setting, sets the <a data-link-type="dfn" href="#composite-operation">composite operation</a> property of this
<a data-link-type="dfn" href="#animation-effect">animation effect</a> to the provided value.</p>
        
</dl>
</div>


     <div class="methods">


      <dl>
       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffectReadonly" data-dfn-type="method" data-export="" data-lt="clone()" id="dom-keyframeeffectreadonly-clone">
KeyframeEffect clone ()<a class="self-link" href="#dom-keyframeeffectreadonly-clone"></a></dfn></p>
        

       <dd data-md="">
        <p>Returns a new <code class="idl"><a data-link-type="idl" href="#keyframeeffect">KeyframeEffect</a></code> object whose members have the same values
as this object using the following procedure.</p>
        


        <ol>
         <li data-md="">
          <p>Let <var>source</var> be the <code class="idl"><a data-link-type="idl" href="#keyframeeffectreadonly">KeyframeEffectReadonly</a></code> object on which
 this method was called.</p>
          

         <li data-md="">
          <p>Let <var>dest</var> be a new <code class="idl"><a data-link-type="idl" href="#keyframeeffect">KeyframeEffect</a></code> object.</p>
          

         <li data-md="">
          <p>Set each of the <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-name">name</a></code>,
 <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-iterationcomposite">iterationComposite</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-composite">composite</a></code>,
 and <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-spacing">spacing</a></code> attributes on <var>dest</var> using
 the value returned by the getter of the corresponding attribute on
 <var>source</var>.</p>
          

         <li data-md="">
          <p>Let <var>frames</var> be the result of calling the
 <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffectreadonly-getframes">getFrames()</a></code> method on <var>source</var>.</p>
          

         <li data-md="">
          <p>Call the <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-setframesframes">setFrames()</a></code> method on <var>dest</var>
 passing <var>frames</var> as the <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-setframes-frames">frames</a></code>
 argument.</p>
          
</ol>
        

       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffectReadonly" data-dfn-type="method" data-export="" data-lt="getFrames()" id="dom-keyframeeffectreadonly-getframes">
sequence&lt;ComputedKeyframe> getFrames()<a class="self-link" href="#dom-keyframeeffectreadonly-getframes"></a></dfn></p>
        

       <dd data-md="">
        <p>Returns the <a data-link-type="dfn" href="#keyframe">keyframes</a> that make up this effect as
a sequence of <code class="idl"><a data-link-type="idl" href="#dictdef-computedkeyframe">ComputedKeyframe</a></code> objects.</p>
        


        <p>The value returned differs from the <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-setframes-frames">frames</a></code>
argument passed into <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-setframesframes">setFrames()</a></code> or the
<code class="idl"><a data-link-type="idl" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options">KeyframeEffectReadonly()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-keyframeeffectframes-options">KeyframeEffect()</a></code> constructors in
the following ways:</p>
        


        <ul>
         <li data-md="">
          <p>The normalization defined in <a href="#normalizing-a-sequence-of-keyframes">§5.17.3 Normalizing a sequence of keyframes</a> is applied to <var>frames</var> which
may result in some frames being removed or re-ordered and some
properties being removed.
This normalization will also cause a single <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code>
object to be replaced with a sequence.</p>
          

         <li data-md="">
          <p>The result of computing the <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a>
of each <a data-link-type="dfn" href="#keyframe">keyframe</a> as defined in <a href="#spacing-keyframes">§4.3.1 Spacing keyframes</a> is stored in
the <code class="idl"><a data-link-type="idl" href="#dom-computedkeyframe-computedoffset">computedOffset</a></code> member of each frame.</p>
          
</ul>
        

       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffect" data-dfn-type="method" data-export="" data-lt="setFrames(frames)" id="dom-keyframeeffect-setframesframes">
void setFrames(object frames)<a class="self-link" href="#dom-keyframeeffect-setframesframes"></a></dfn></p>
        

       <dd data-md="">
        <p>Replaces the set of <a data-link-type="dfn" href="#keyframe">keyframes</a> that make up this effect.</p>
        


        <div class="parameters">


         <dl>
          <dt data-md="">
           <p><dfn class="idl-code" data-dfn-for="KeyframeEffect/setFrames" data-dfn-type="argument" data-export="" data-lt="frames" id="dom-keyframeeffect-setframes-frames">object frames<a class="self-link" href="#dom-keyframeeffect-setframes-frames"></a></dfn></p>
           

          <dd data-md="">
           <p>A <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> object or sequence of <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> objects used to
replace the set of <a data-link-type="dfn" href="#keyframe">keyframes</a> that make up this effect.</p>
           


           <p>The processing of the <var>frames</var> parameter is defined in <a href="#processing-a-sequence-of-keyframe-objects-or-a-single-item">§5.17.1 Processing a sequence of Keyframe objects or a single item</a>.</p>
           


           <p>Subsequently, the resulting sequence of <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> objects is
normalized using the procedure in <a href="#normalizing-a-sequence-of-keyframes">§5.17.3 Normalizing a sequence of keyframes</a> before storing.</p>
           
</dl>
</div>
        
</dl>
</div>


     <h4 class="heading settled" data-level="5.17.1" id="processing-a-sequence-of-keyframe-objects-or-a-single-item"><span class="secno">5.17.1. </span><span class="content">Processing a sequence of <code>Keyframe</code> objects or a single item</span><a class="self-link" href="#processing-a-sequence-of-keyframe-objects-or-a-single-item"></a></h4>


     <p>WebIDL does not currently make a dictionary and a sequence
distinguishable but for ease of use, the <code class="idl"><a data-link-type="idl" href="#dom-animatable-animate">animate()</a></code> operation
on the <code class="idl"><a data-link-type="idl" href="#animatable">Animatable</a></code> interface allows both.
Therefore, we define the processing for handling a parameter
that may be either a single <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> dictionary object, or
a sequence of such objects.</p>


     <p>The <dfn data-dfn-type="dfn" data-noexport="" id="procedure-for-converting-an-ecmascript-value-into-an-idl-keyframe-or-sequence-of-keyframes">procedure for converting an ECMAScript value into
an IDL keyframe or sequence of keyframes<a class="self-link" href="#procedure-for-converting-an-ecmascript-value-into-an-idl-keyframe-or-sequence-of-keyframes"></a></dfn> with parameter
<var>keyframeOrKeyframeList</var> is as follows:</p>


     <div class="switch">


      <dl>
       <dt data-md="">
        <p>If, using the canonical definition of
<code>Array.isArray</code> <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a>,
Array.isArray(<var>keyframeOrKeyframeList</var>) is
true,</p>
        

       <dd data-md="">
        <p>Return the result of following the steps for <a href="http://www.w3.org/TR/WebIDL/#es-sequence">converting an
ECMAScript value into an IDL sequence</a> using the <a data-link-type="dfn" href="#procedure-for-converting-an-ecmascript-value-to-an-idl-keyframe-object">procedure
for converting an ECMAScript value to an IDL Keyframe object</a>
as the procedure for converting <var>E</var> to an IDL value of
type <var>T</var>.</p>
        

       <dt data-md="">
        <p>Otherwise,</p>
        

       <dd data-md="">
        <p>Return the result of applying the <a data-link-type="dfn" href="#procedure-for-converting-an-ecmascript-value-to-an-idl-keyframe-object">procedure for converting
an ECMAScript value to an IDL Keyframe object</a> to
<var>keyframeOrKeyframeList.</var></p>
       <dd>
        <p></p>
        
</dl>
</div>


     <p class="issue" id="issue-0a95c3b0"><a class="self-link" href="#issue-0a95c3b0"></a>Should this be defined in terms of <code>IsIterable</code> instead?</p>



     <h4 class="heading settled" data-level="5.17.2" id="the-keyframeeffectoptions-dictionary"><span class="secno">5.17.2. </span><span class="content">The <code>KeyframeEffectOptions</code> dictionary</span><a class="self-link" href="#the-keyframeeffectoptions-dictionary"></a></h4>


     <p>Additional parameters may be passed to the <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options">KeyframeEffectReadonly()</a></code> and
<code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-keyframeeffectframes-options">KeyframeEffect()</a></code> constructors by providing a <code class="idl"><a data-link-type="idl" href="#dictdef-keyframeeffectoptions">KeyframeEffectOptions</a></code>
object.</p>


     <pre class="idl">dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" data-global-name="" id="dictdef-keyframeeffectoptions">KeyframeEffectOptions<a class="self-link" href="#dictdef-keyframeeffectoptions"></a></dfn> {
    DOMString                   <a class="idl-code" data-default="&quot;&quot;" data-global-name="KeyframeEffectOptions<dictionary>/name<dict-member>" data-link-type="dict-member" data-type="DOMString                   " href="#dom-keyframeeffectoptions-name">name</a> = "";
    <a data-link-type="idl-name" href="#enumdef-iterationcompositeoperation">IterationCompositeOperation</a> <a class="idl-code" data-default="&quot;replace&quot;" data-global-name="KeyframeEffectOptions<dictionary>/iterationComposite<dict-member>" data-link-type="dict-member" data-type="IterationCompositeOperation " href="#dom-keyframeeffectoptions-iterationcomposite">iterationComposite</a> = "replace";
    <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>          <a class="idl-code" data-default="&quot;replace&quot;" data-global-name="KeyframeEffectOptions<dictionary>/composite<dict-member>" data-link-type="dict-member" data-type="CompositeOperation          " href="#dom-keyframeeffectoptions-composite">composite</a> = "replace";
    DOMString                   <a class="idl-code" data-default="&quot;distribute&quot;" data-global-name="KeyframeEffectOptions<dictionary>/spacing<dict-member>" data-link-type="dict-member" data-type="DOMString                   " href="#dom-keyframeeffectoptions-spacing">spacing</a> = "distribute";
};
</pre>


     <div class="attributes">


      <dl>
       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffectOptions" data-dfn-type="dict-member" data-export="" id="dom-keyframeeffectoptions-name">name<a class="self-link" href="#dom-keyframeeffectoptions-name"></a></dfn>, <span> of type <a data-link-type="idl-name">DOMString</a>, defaulting to <code>""</code></span></p>
        

       <dd data-md="">
        <p>The value to set for the <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code>'s
<code class="idl"><a data-link-type="idl" href="#dom-animationeffectreadonly-name">name</a></code> property.</p>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffectOptions" data-dfn-type="dict-member" data-export="" id="dom-keyframeeffectoptions-iterationcomposite">iterationComposite<a class="self-link" href="#dom-keyframeeffectoptions-iterationcomposite"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-iterationcompositeoperation">IterationCompositeOperation</a>, defaulting to <code>"replace"</code></span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#iteration-composite-operation">iteration composite operation</a> used to define the way
animation values build from iteration to iteration.</p>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffectOptions" data-dfn-type="dict-member" data-export="" id="dom-keyframeeffectoptions-composite">composite<a class="self-link" href="#dom-keyframeeffectoptions-composite"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>, defaulting to <code>"replace"</code></span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#composite-operation">composite operation</a> used to composite this
animation with the <a data-link-type="dfn" href="#animation-stack">animation stack</a>, as specified by one
of the <a data-link-type="dfn" href="#compositeoperation">CompositeOperation</a> enumeration values.
This is used for all <a data-link-type="dfn" href="#keyframe">keyframes</a> that do not specify
a <a data-link-type="dfn" href="#composite-operation">composite operation</a>.</p>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="KeyframeEffectOptions" data-dfn-type="dict-member" data-export="" id="dom-keyframeeffectoptions-spacing">spacing<a class="self-link" href="#dom-keyframeeffectoptions-spacing"></a></dfn>, <span> of type <a data-link-type="idl-name">DOMString</a>, defaulting to <code>"distribute"</code></span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#keyframe-spacing-mode">spacing mode</a> to apply
to this <a data-link-type="dfn" href="#animation-effect">animation effect</a>’s <a data-link-type="dfn" href="#keyframe">keyframes</a>.</p>
        


        <p>See the <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-spacing">spacing</a></code> attribute of the
<code class="idl"><a data-link-type="idl" href="#keyframeeffect">KeyframeEffect</a></code> interface for the recognized values and
their meanings.</p>
        


        <p>Unrecognized values are set on the created <code class="idl"><a data-link-type="idl" href="#keyframeeffectreadonly">KeyframeEffectReadonly</a></code> or
<code class="idl"><a data-link-type="idl" href="#keyframeeffect">KeyframeEffect</a></code> object, but are treated as "distribute" for the purpose
of animation model calculations.</p>
        
</dl>
</div>



     <h4 class="heading settled" data-level="5.17.3" id="normalizing-a-sequence-of-keyframes"><span class="secno">5.17.3. </span><span class="content">Normalizing a sequence of keyframes</span><a class="self-link" href="#normalizing-a-sequence-of-keyframes"></a></h4>


     <p>For each call to <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-setframesframes">setFrames()</a></code>, the
<code class="idl"><a data-link-type="idl" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options">KeyframeEffectReadonly()</a></code> constructor or the <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffect-keyframeeffectframes-options">KeyframeEffect()</a></code>
constructor, the following normalization is performed on the passed
in <var>frames</var> parameter before storing its value.</p>


     <p class="note" role="note">Note: the processing of the ECMAScript value into a suitable IDL
value defined in <a href="#processing-a-keyframe-object">§5.18.1 Processing a Keyframe object</a> is performed before this operation is
initiated.</p>


     <ol>
      <li data-md="">
       <p>If <var>frames</var> is a single <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> object, replaces
<var>frames</var> with
a new sequence with a single item that is the previous value of
<var>frames</var>.</p>
       

      <li data-md="">
       <p>If <var>frames</var> is not <a data-link-type="dfn" href="#loosely-sorted-by-offset">loosely sorted by offset</a>,
then,</p>
       


       <div class="switch">


        <dl>
         <dt data-md="">
          <p>If each <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> has a non-null <code>offset</code>,</p>
          

         <dd data-md="">
          <p>Sort <var>frames</var> in ascending order by
<code>offset</code>.</p>
          

         <dt data-md="">
          <p>Otherwise,</p>
         <p></p>

         <dd data-md="">
          <p>Throw a DOMException of type
<code>InvalidModificationError</code>.</p>
         <p></p>
</dl>
</div>
       


      <li data-md="">
       <p>If there exist any <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code>
objects in <var>frames</var> whose <code>offset</code> member is
non-null and less than zero, remove all keyframes
objects from the start of <var>frames</var> up to and including
the keyframe with the largest non-null <code>offset</code>
that is still less than zero.</p>
       

      <li data-md="">
       <p>Likewise, if there exist any <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> objects in
<var>frames</var> whose <code>offset</code> member is non-null
and greater than one, remove all <a data-link-type="dfn" href="#keyframe">keyframes</a> from
the keyframe with the smallest non-null <code>offset</code>
that is still greater than one until the end of
<var>frames</var>.</p>
       

      <li data-md="">
       <p>Remove all property values in <var>frames</var> that are invalid
or not supported by the implementation.</p>
       


       <p class="issue" id="issue-53ccb020"><a class="self-link" href="#issue-53ccb020"></a>Need to define what invalid means here.</p>
       
</ol>

     <h3 class="heading settled" data-level="5.18" id="the-keyframe-dictionary"><span class="secno">5.18. </span><span class="content">The <code>Keyframe</code> dictionary</span><a class="self-link" href="#the-keyframe-dictionary"></a></h3>


     <p>Individual <a data-link-type="dfn" href="#keyframe">keyframes</a> are represented by a special kind of
<code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> dictionary type whose
members map to the properties to be animated.
At the time of writing, this kind of open-ended dictionary cannot
be represented using WebIDL and hence special
ECMAScript-specific handling for this type is defined in
<a href="#processing-a-keyframe-object">§5.18.1 Processing a Keyframe object</a>.
No handling is defined for other languages.</p>


     <pre class="idl">dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" data-global-name="" id="dictdef-keyframe">Keyframe<a class="self-link" href="#dictdef-keyframe"></a></dfn> {
    // ... property-value pairs ...
    double?             <a class="idl-code" data-default="null" data-global-name="Keyframe<dictionary>/offset<dict-member>" data-link-type="dict-member" data-type="double?             " href="#dom-keyframe-offset">offset</a> = null;
    DOMString           <a class="idl-code" data-default="&quot;linear&quot;" data-global-name="Keyframe<dictionary>/easing<dict-member>" data-link-type="dict-member" data-type="DOMString           " href="#dom-keyframe-easing">easing</a> = "linear";
    <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>? <a class="idl-code" data-default="null" data-global-name="Keyframe<dictionary>/composite<dict-member>" data-link-type="dict-member" data-type="CompositeOperation? " href="#dom-keyframe-composite">composite</a> = null;
};
</pre>


     <div class="attributes">


      <dl>
       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="Keyframe" data-dfn-type="dict-member" data-export="" id="dom-keyframe-offset">offset<a class="self-link" href="#dom-keyframe-offset"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a>, nullable, defaulting to <code>null</code></span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> of the <a data-link-type="dfn" href="#keyframe">keyframe</a> specified as
a number between 0.0 and 1.0 inclusive or <code>null</code>.</p>
        


        <p><a data-link-type="dfn" href="#keyframe">Keyframes</a> with offsets outside the range [0.0, 1.0] are
ignored when calculating animation values as defined in
<a href="#normalizing-a-sequence-of-keyframes">§5.17.3 Normalizing a sequence of keyframes</a>.</p>
        


        <p>A <code>null</code> value indicates that the <a data-link-type="dfn" href="#keyframe">keyframe</a>
should be positioned using the <a data-link-type="dfn" href="#keyframe-animation-effect">keyframe animation effect</a>’s
<a data-link-type="dfn" href="#keyframe-spacing-mode">keyframe spacing mode</a>.</p>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="Keyframe" data-dfn-type="dict-member" data-export="" id="dom-keyframe-easing">easing<a class="self-link" href="#dom-keyframe-easing"></a></dfn>, <span> of type <a data-link-type="idl-name">DOMString</a>, defaulting to <code>"linear"</code></span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#timing-function">timing function</a> used to transform the progress of time
from this keyframe until the next keyframe in the series.</p>
        


        <p>The syntax and error-handling associated with parsing this string
is identical to that defined for the <code>easing</code> attribute
of the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface.</p>
        


       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="Keyframe" data-dfn-type="dict-member" data-export="" id="dom-keyframe-composite">composite<a class="self-link" href="#dom-keyframe-composite"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>, nullable, defaulting to <code>null</code></span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#composite-operation">composite operation</a> used to combine the values
specified in this keyframe with the <a data-link-type="dfn" href="#underlying-value">underlying value</a>.</p>
        


        <p>If <code>null</code>, the <a data-link-type="dfn" href="#composite-operation">composite operation</a>
specified on the <code class="idl"><a data-link-type="idl" href="#animationeffectreadonly">AnimationEffectReadonly</a></code> will be used.</p>
        
</dl>
</div>



     <h4 class="heading settled" data-level="5.18.1" id="processing-a-keyframe-object"><span class="secno">5.18.1. </span><span class="content">Processing a <code>Keyframe</code> object</span><a class="self-link" href="#processing-a-keyframe-object"></a></h4>


     <div class="note" role="note">


      <p>Since accessing the properties of an ECMAScript user object can
have side effects, the manner in which these properties is
accessed is important.
In light of this consideration the procedure for converting an
ECMAScript object into an IDL <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> object has the following
properties:</p>


      <ul>
       <li data-md="">
        <p>Each property that is read, is read only once.</p>
        

       <li data-md="">
        <p>Properties are read in a well-defined order.</p>
        

       <li data-md="">
        <p>Properties corresponding to unsupported target properties or
attributes are not read.</p>
        
</ul>
</div>


     <p>The <dfn data-dfn-type="dfn" data-noexport="" id="procedure-for-converting-an-ecmascript-value-to-an-idl-keyframe-object">procedure for converting an ECMAScript value to an IDL
Keyframe object<a class="self-link" href="#procedure-for-converting-an-ecmascript-value-to-an-idl-keyframe-object"></a></dfn> with parameter <var>keyframe input</var>
is as follows:</p>


     <ol>
      <li data-md="">
       <p>Let <var>keyframe result</var> be a <code class="idl"><a data-link-type="idl" href="#dictdef-keyframe">Keyframe</a></code> object with the
<code>offset</code>, <code>easing</code> and
<code>composite</code> attributes set to the default dictionary
values.</p>
       

      <li data-md="">
       <p>Create a list, <var>supported properties</var>, of property
names and attribute names that can be animated by the
implementation.</p>
       

      <li data-md="">
       <p>Convert each property name in <var>supported properties</var>
to the equivalent IDL attribute by applying the <a href="http://dev.w3.org/csswg/cssom/#css-property-to-idl-attribute">CSS
property to IDL attribute</a> algorithm <a data-link-type="biblio" href="#biblio-cssom">[CSSOM]</a>.</p>
       

      <li data-md="">
       <p>If the user agent supports animation of the <a class="property" data-link-type="propdesc" href="http://dev.w3.org/csswg/css2/visuren.html#propdef-float">float</a>
CSS property, replace "float" in
<var>supported properties</var> with "cssFloat".</p>
       

      <li data-md="">
       <p>Let <var>animation properties</var> be an empty sequence.</p>
       

      <li data-md="">
       <p>Use the internal [[Enumerate]] operation on <var>keyframe
input</var> to iterate over its properties.
For each <var>property</var> perform the step corresponding to
the first matching condition from below, if any.</p>
       


       <div class="switch">


        <dl>
         <dt data-md="">
          <p>If <var>property</var> is a case-sensitive match for
the string "offset",</p>
         <p></p>

         <dd data-md="">
          <p>Let <var>offset value</var> be the result of calling the [[Get]]
internal method on <var>keyframe input</var> with property name
"offset".
If <var>offset value</var> is null, set the <code>offset</code>
member of <var>keyframe result</var> to null.
Otherwise, set it to the result of applying the <a href="http://www.w3.org/TR/WebIDL/#es-double">procedure for
converting an ECMAScript value into an IDL double</a>
<a data-link-type="biblio" href="#biblio-webidl">[WEBIDL]</a> to <var>offset value.</var></p>


         <dt data-md="">
          <p>If <var>property</var> is a case-sensitive match for
the string "easing",</p>
         <p></p>

         <dd data-md="">
          <p>Set the <code>easing</code> member of <var>keyframe
result</var> to the result of applying the <a href="http://www.w3.org/TR/WebIDL/#es-DOMString">procedure
for converting an ECMAScript value to an IDL
DOMString value</a> <a data-link-type="biblio" href="#biblio-webidl">[WEBIDL]</a> with the <a href="http://www.w3.org/TR/WebIDL/#TreatNullAs">[TreatNullAs=EmptyString]</a>
annotation in effect, to the result of calling
the [[Get]] internal method of <var>keyframe
input</var> with property name "easing".</p>


          <p>If the resulting string does not conform to the
grammar defined for the <code class="idl"><a data-link-type="idl" href="#dom-animationtiming-easing">easing</a></code>
attribute of the <code class="idl"><a data-link-type="idl" href="#animationtiming">AnimationTiming</a></code> interface or
is not supported by the implementation, then
set the <code>easing</code> of <var>keyframe result</var>
to the string “linear”.</p>


         <dt data-md="">
          <p>If <var>property</var> is a case-sensitive match for
the string "composite",</p>
         <p></p>

         <dd data-md="">
          <p>Let <var>composite value</var> be the result of calling the [[Get]]
internal method on <var>keyframe input</var> with property name
"composite".
If <var>composite value</var> is null, set the <code>composite</code>
member of <var>keyframe result</var> to null.
Otherwise, set it to the result of applying the <a href="http://www.w3.org/TR/WebIDL/#es-enumeration">procedure for
converting an ECMAScript value to an IDL enumeration type</a>
<a data-link-type="biblio" href="#biblio-webidl">[WEBIDL]</a> with <a data-link-type="dfn" href="#compositeoperation">CompositeOperation</a> as the enumeration type,
to <var>composite value.</var></p>


         <dt data-md="">
          <p>Otherwise, if <var>property</var> also exists in
<var>supported properties</var> based on a case-sensitive
comparison,</p>
         <p></p>

         <dd data-md="">
          <p>append <var>property</var> to <var>animation
properties</var>.</p>
         <p></p>
</dl>
</div>
       


      <li data-md="">
       <p>For user agents that support both a prefixed and an
unprefixed version of some CSS properties, remove all
prefixed properties from <var>animation properties</var>
where the corresponding unprefixed version is also
present in <var>animation properties</var>.</p>
       


       <p class="note" role="note">Note: I’d like to remove this step. Prefixes are history.</p>
       


      <li data-md="">
       <p>Sort <var>animation properties</var> lexicographically by
the Unicode codepoints that define each element.</p>
       

      <li data-md="">
       <p>Iterate over <var>animation properties</var> from beginning to
end and for each <var>name</var> in <var>animation
properties</var> add a new member pair to <var>keyframe
result</var> as follows:</p>
       


       <ul>
        <li data-md="">
         <p><em>member name</em>: the result of applying the
the <a href="http://dev.w3.org/csswg/cssom/#idl-attribute-to-css-property">IDL
attribute to CSS property</a> algorithm <a data-link-type="biblio" href="#biblio-cssom">[CSSOM]</a> to
<var>name</var> unless <var>name</var> is
a case-sensitive match for the string "cssFloat" in
which case use the string "float".</p>
         

        <li data-md="">
         <p><em>member value</em>: the result of calling
<code>ToString</code> on the value returned from the
[[Get]] method of <var>keyframe input</var> with property
name, <var>name</var>.
If [[Get]] returns null or undefined, let the member
value be an empty string.</p>
         
</ul>
       

      <li data-md="">
       <p>Return <var>keyframe result</var>.</p>
       
</ol>

     <div class="issue" id="issue-7e1dd385"><a class="self-link" href="#issue-7e1dd385"></a>


      <p>The above algorithm gives special meaning to the property names
"offset", "computedOffset", "easing", and "composite".
If a CSS property called "offset" or "composite" is ever
introduced it will clash with the meaning here.</p>


      <p>We have a few options:</p>


      <ul>
       <li data-md="">
        <p>Add special handling at that time to allow addressing the
property of the same name, e.g. <code>cssOffset</code>.</p>
        

       <li data-md="">
        <p>Rename these keywords now to reduce risk of a later clash,
e.g. "keyframeOffset".</p>
        
</ul>
</div>




     <h3 class="heading settled" data-level="5.19" id="the-computedkeyframe-dictionary"><span class="secno">5.19. </span><span class="content">The <code>ComputedKeyframe</code> dictionary</span><a class="self-link" href="#the-computedkeyframe-dictionary"></a></h3>


     <p><a data-link-type="dfn" href="#keyframe">Keyframes</a> returned by the <code class="idl"><a data-link-type="idl" href="#dom-keyframeeffectreadonly-getframes">getFrames()</a></code> method
of the <code class="idl"><a data-link-type="idl" href="#keyframeeffectreadonly">KeyframeEffectReadonly</a></code> interface are represented using
<code class="idl"><a data-link-type="idl" href="#dictdef-computedkeyframe">ComputedKeyframe</a></code> dictionary objects.</p>


     <pre class="idl">dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" data-global-name="" id="dictdef-computedkeyframe">ComputedKeyframe<a class="self-link" href="#dictdef-computedkeyframe"></a></dfn> : <a data-link-type="idl-name" href="#dictdef-keyframe">Keyframe</a> {
    double <a class="idl-code" data-global-name="ComputedKeyframe<dictionary>/computedOffset<dict-member>" data-link-type="dict-member" data-type="double " href="#dom-computedkeyframe-computedoffset">computedOffset</a>;
};
</pre>


     <div class="attributes">


      <dl>
       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="ComputedKeyframe" data-dfn-type="dict-member" data-export="" id="dom-computedkeyframe-computedoffset">computedOffset<a class="self-link" href="#dom-computedkeyframe-computedoffset"></a></dfn>, <span> of type <a data-link-type="idl-name">double</a></span></p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#keyframe-offset">keyframe offset</a> calculated for this <a data-link-type="dfn" href="#keyframe">keyframe</a> as
a result of applying the spacing procedure defined in
<a href="#spacing-keyframes">§4.3.1 Spacing keyframes</a>.</p>
        
</dl>
</div>


     <h3 class="heading settled" data-level="5.20" id="the-effectcallback-callback-function"><span class="secno">5.20. </span><span class="content">The <code>EffectCallback</code> callback function</span><a class="self-link" href="#the-effectcallback-callback-function"></a></h3>


     <p><a data-link-type="dfn" href="#custom-effect">Custom effects</a> can be defined in script by providing an
<code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code> callback function.</p>


     <pre class="idl">callback <dfn class="idl-code" data-dfn-type="callback" data-export="" data-global-name="" id="callbackdef-effectcallback">EffectCallback<a class="self-link" href="#callbackdef-effectcallback"></a></dfn> = void (double? <dfn class="idl-code" data-dfn-for="EffectCallback" data-dfn-type="argument" data-export="" data-global-name="EffectCallback/timeFraction<argument>" id="dom-effectcallback-timefraction">timeFraction<a class="self-link" href="#dom-effectcallback-timefraction"></a></dfn>, <a data-link-type="idl-name" href="#animatable">Animatable</a> <dfn class="idl-code" data-dfn-for="EffectCallback" data-dfn-type="argument" data-export="" data-global-name="EffectCallback/currentTarget<argument>" id="dom-effectcallback-currenttarget">currentTarget<a class="self-link" href="#dom-effectcallback-currenttarget"></a></dfn>,
                                <a data-link-type="idl-name" href="#animation">Animation</a> <dfn class="idl-code" data-dfn-for="EffectCallback" data-dfn-type="argument" data-export="" data-global-name="EffectCallback/animationObject<argument>" id="dom-effectcallback-animationobject">animationObject<a class="self-link" href="#dom-effectcallback-animationobject"></a></dfn>);
</pre>


     <p>An <code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code> is called each time an <code class="idl"><a data-link-type="idl" href="#animationreadonly">AnimationReadonly</a></code> object
with which it is
associated is <a data-link-type="dfn" href="#sampling">sampled</a>.</p>


     <div class="parameters">


      <dl>
       <dt data-md="">
        <p>double? timeFraction</p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#time-fraction">time fraction</a> for which to produce an effect.
When this is <code>null</code>, the function SHOULD
remove the effect.</p>
        


       <dt data-md="">
        <p>Animatable currentTarget</p>
        

       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#animation-target">animation target</a> on which this callback is expected
to operate.</p>
        


        <div class="note" role="note">


         <p>Note that <var>currentTarget</var> may differ from
<code><var>animation</var>.target</code>.</p>


         <p>If the <a data-link-type="dfn" href="#animation-target">animation target</a> of <var>animation</var>
is changed between samples, this method will be
called once with a null <var>timeFraction</var> and the
previous <a data-link-type="dfn" href="#animation-target">animation target</a> as the
<var>currentTarget</var>, then again with the current
<var>timeFraction</var> and the updated <a data-link-type="dfn" href="#animation-target">animation
target</a> as the <var>currentTarget</var>.
This allows the animation effect to be removed from the old
<a data-link-type="dfn" href="#animation-target">animation target</a>.</p>

</div>
        


       <dt data-md="">
        <p>Animation animationObject</p>
        

       <dd data-md="">
        <p>The <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> object that is being sampled.</p>
        
</dl>

      <div class="issue" id="issue-6dab2e19"><a class="self-link" href="#issue-6dab2e19"></a>
  This is only named <code class="idl"><a data-link-type="idl" href="#dom-effectcallback-animationobject">animationObject</a></code> because otherwise we end
  up getting a bikeshed error:
  <code>"Multiple possible 'idl' local refs for 'animation'.
    Arbitrarily chose the one with type 'interface' and for ''."</code>
</div>

</div>


     <h3 class="heading settled" data-level="5.21" id="extensions-to-the-document-interface"><span class="secno">5.21. </span><span class="content">Extensions to the <code>Document</code> interface</span><a class="self-link" href="#extensions-to-the-document-interface"></a></h3>


     <p>The following extensions are made to the <a class="idl-code" data-link-type="interface" href="http://dom.spec.whatwg.org/#document">Document
interface</a> defined in <a data-link-type="biblio" href="#biblio-dom">[DOM]</a>.</p>




     <pre class="idl">partial interface <a class="idl-code" data-global-name="" data-link-type="interface" href="http://dom.spec.whatwg.org/#document">Document</a> {
    readonly attribute <a data-link-type="idl-name" href="#animationtimeline">AnimationTimeline</a> <a class="idl-code" data-global-name="Document<interface>/timeline<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationTimeline " href="#dom-document-timeline">timeline</a>;
};
</pre>


     <div class="attributes">


      <dl>
       <dt data-md="">
        <p><dfn class="idl-code" data-dfn-for="Document" data-dfn-type="attribute" data-export="" id="dom-document-timeline">timeline<a class="self-link" href="#dom-document-timeline"></a></dfn>, <span> of type <a data-link-type="idl-name" href="#animationtimeline">AnimationTimeline</a>, readonly</span></p>
        

       <dd data-md="">
        <p>The <code class="idl"><a data-link-type="idl" href="#animationtimeline">AnimationTimeline</a></code> object representing
the <a data-link-type="dfn" href="#document-timeline">document timeline</a>.</p>
        
</dl>
</div>


     <h3 class="heading settled" data-level="5.22" id="extensions-to-the-element-interface"><span class="secno">5.22. </span><span class="content">Extensions to the <code>Element</code> interface</span><a class="self-link" href="#extensions-to-the-element-interface"></a></h3>


     <p>Since DOM Elements may be the target of an animation,
the <a class="externalDFN" href="http://www.w3.org/TR/dom/#interface-element">Element</a>
interface <a data-link-type="biblio" href="#biblio-dom">[DOM]</a> is extended as follows:</p>


     <pre class="idl"><a data-link-type="idl-name" href="http://dom.spec.whatwg.org/#element">Element</a> implements <a data-link-type="idl-name" href="#animatable">Animatable</a>;
</pre>


     <p>This allows the following kind of usage.</p>


     <pre class="example lang-javascript">elem.animate({ color: 'red' }, 2000);</pre>



     <h3 class="heading settled" data-level="5.23" id="extensions-to-the-pseudoelement-interface"><span class="secno">5.23. </span><span class="content">Extensions to the <code>PseudoElement</code> interface</span><a class="self-link" href="#extensions-to-the-pseudoelement-interface"></a></h3>


     <p>Since <a data-link-type="dfn" href="#concept-animation">animations</a> may also target
pseudo-elements, the <a class="externalDFN" href="http://www.w3.org/TR/cssom/#the-pseudoelement-interface"><code>PseudoElement</code></a>
interface <a data-link-type="biblio" href="#biblio-cssom">[CSSOM]</a> is also defined to be animatable.</p>


     <pre class="idl"><a data-link-type="idl-name" href="http://dev.w3.org/csswg/cssom-1/#pseudoelement">PseudoElement</a> implements <a data-link-type="idl-name" href="#animatable">Animatable</a>;
</pre>


     <p class="issue" id="issue-05667543"><a class="self-link" href="#issue-05667543"></a>This interface is marked at-risk in the <a class="externalDFN" href="http://www.w3.org/TR/2013/WD-cssom-20131205/">5 December 2013 WD
    of CSSOM</a>.
    If it is removed, we will need to provide an equivalent definition
    here.</p>


     <h3 class="heading settled" data-level="5.24" id="script-execution-and-live-updates-to-the-model"><span class="secno">5.24. </span><span class="content">Script execution and live updates to the model</span><a class="self-link" href="#script-execution-and-live-updates-to-the-model"></a></h3>


     <p>The interaction between script execution and the state and effects of
the Web Animations model is as follows:</p>


     <ul>
      <li data-md="">
       <p>Changes made to the Web Animations model via the programming
interface are reflected immediately in the values returned by the
interfaces defined in this specification.</p>
       


       <p>Similarly, methods that operate on the current state of the model
such as pausing or reversing are applied to a fully-updated timing
model, that is, after all previous modifications have been
incorporated.</p>
       


       <div class="informative-bg"><em>This section is non-normative</em>


        <p>For example, if the <code class="idl"><a data-link-type="idl" href="#animationplayer">AnimationPlayer</a></code>
associated with an <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> is seeked (see <a href="#setting-the-current-time-of-a-player">§3.5.4 Setting the current time of a player</a>) via the programming
interface, the value returned when querying the
animation’s <code>startTime</code> will reflect updated state of
the model immediately.</p>

    
        <div>
         <pre class="example lang-javascript">// Initially player.source.computedTiming.localTime is 3000
player.currentTime += 2000;
alert(player.source.computedTiming.localTime); // Displays ‘5000’</pre>
        </div>


        <p>The same concept applies to more complex modifications of the
Web Animations model such as adding and removing children from
an <code class="idl"><a data-link-type="idl" href="#animationgroup">AnimationGroup</a></code>.</p>
</div>
       


      <li data-md="">
       <p>Querying the computed style of a property affected by
animation, or the value of an attribute affected by animation,
returns the value based the <em>current state</em> of the
model, that is, after incorporating any modifications made using
the programming interface.</p>
       


       <div class="informative-bg"><em>This section is non-normative</em>


        <p>For example, if the used style of an element is queried
immediately after applying a new <code class="idl"><a data-link-type="idl" href="#animation">Animation</a></code> to that
element, the result of the new animation will be
incorporated in the value returned.</p>

    
        <div>
         <pre class="example lang-javascript">// Set opacity to 0 immediately
elem.animate({ opacity: 0 }, { fill: 'forwards' });
alert(window.getComputedStyle(elem).opacity); // Displays ‘0’</pre>
        </div>


        <p>The means of querying the animated value of an attribute depends
on the interface defined for the attribute.
SVG 1.1 <a data-link-type="biblio" href="#biblio-svg11">[SVG11]</a> defines an additional interface for querying
animated values.</p>

    
        <div>
         <pre class="example lang-javascript">// Set width to 0 immediately
rect.animate({ width: '100px' }, { fill: 'forwards' });
alert(rect.width.animVal.value); // Displays ‘100’</pre>
        </div>

</div>
       


      <li data-md="">
       <p>Changes made to the model using the programming interface do
<em>not</em> cause any <code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code> functions to be
called.</p>
       


       <div class="informative-bg"><em>This section is non-normative</em>


        <p>For example, in the following code, the callback function will
not be called until <em>after</em> the script block has
completed during regular sampling.</p>

    
        <div>
         <pre class="example lang-javascript">var timesCalled = 0;
elem.animate(function() {
  timesCalled++;
}, 10000);
alert(timesCalled); // Displays ‘0’</pre>
        </div>

</div>
       



      <li data-md="">
       <p>Changes to specified style, specified attribute values, and the
state of the Web Animations model made within the same execution
block must be synchronized when rendering such that the whole set
of changes is rendered together.</p>
       


       <div class="informative-bg"><em>This section is non-normative</em>


        <p>For example, a user agent must not render only the changes to
specified style made in a script execution block whilst ignoring
changes to animations.
This guarantees that the following usage will never produce
a situation where <em>only</em> the change to specified style is
rendered without the animation.</p>

    
        <div>
         <pre class="example lang-javascript">// Fade the opacity with fallback for browsers that don’t
// support Element.animate
elem.style.opacity = '0';
elem.animate([ { opacity: 1 }, { opacity: 0 } ], 500);</pre>
        </div>


        <p>Note that a user agent may render a frame with <em>none</em> of
the changes made in a script execution block.
This might happen, for example, if rendering occurs in
a separate process that is scheduled to run shortly after
a script execution block completes but before changes made via
script can be communicated to the process.</p>

</div>
       


      <li data-md="">
       <p>The value returned by the <code>currentTime</code> attribute of
a <a data-link-type="dfn" href="#document-timeline">document timeline</a> will not change within a script block.</p>
       


       <div class="informative-bg"><em>This section is non-normative</em>


        <p>For example, querying the <code>currentTime</code> twice within
a long block of code that is executed in the same script block
will return the same value as shown in the following example.</p>

    
        <div>
         <pre class="example lang-javascript">var a = document.timeline.currentTime;
// ... many lines of code ...
var b = document.timeline.currentTime;
alert(b - a); // Displays 0</pre>
        </div>

</div>
       


      <li data-md="">
       <p>User agents that support Timing control for script-based
animations <a data-link-type="biblio" href="#biblio-animation-timing">[ANIMATION-TIMING]</a>, prior to <a class="externalDFN" href="http://www.w3.org/TR/animation-timing/#dfn-sample-all-animations">sampling animation frame request
callbacks</a> for a given <a class="externalDFN" href="http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context">top-level browsing context</a>,
must perform a <a data-link-type="dfn" href="#single_sample">sample</a> including 
executing any eligible
<a data-link-type="dfn" href="#custom-effect">custom effects</a> (see <a href="#sampling-custom-effects">§4.4.1 Sampling custom effects</a>) for all <a data-link-type="dfn" href="#animation-node">animation nodes</a>
<a data-link-type="dfn" href="#associated-with-a-timeline">associated with a timeline</a> that is the <a data-link-type="dfn" href="#document-timeline">document
timeline</a> of the
<a class="externalDFN" href="http://www.w3.org/TR/html5/browsers.html#active-document">active document</a> of the <a class="externalDFN" href="http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context">top-level browsing context</a> or
of any of its <a class="externalDFN" href="http://www.w3.org/TR/html5/browsers.html#list-of-the-descendant-browsing-contexts">descendant browsing contexts</a>.
When performing this <a data-link-type="dfn" href="#single_sample">sample</a>, the 
<a data-link-type="dfn" href="#time-value">time value</a> of
each <a data-link-type="dfn" href="#document-timeline">document timeline</a> must be equal to the <var>time</var>
passed to animation frame request callbacks for that browsing
context.</p>
       


       <div class="informative-bg"><em>This section is non-normative</em>


        <p>As a result of this definition, the time passed to
a <code>requestAnimationFrame</code> callback acts as
an alias for <code>document.timeline.currentTime</code>.</p>

    
        <div>
         <pre class="example lang-javascript">window.requestAnimationFrame(function(sampleTime) {
  // Displays ‘0’
  alert(sampleTime - document.timeline.currentTime);
});</pre>
        </div>

</div>
       

</ul>

     <h2 class="heading settled" data-level="6" id="integration-with-media-fragments"><span class="secno">6. </span><span class="content">Integration with Media Fragments</span><a class="self-link" href="#integration-with-media-fragments"></a></h2>


     <p>The Media Fragments specification <a data-link-type="biblio" href="#biblio-media-frags">[MEDIA-FRAGS]</a> defines a means
for addressing a temporal range of a media resource.
The application of media fragments depends on the MIME type of the
resource on which they are specified.
For resources with the <a class="externalDFN" href="http://www.w3.org/TR/SVG/intro.html#MIMEType">SVG MIME type</a>
<a data-link-type="biblio" href="#biblio-svg11">[SVG11]</a>, the application of temporal parameters is defined in the <a href="http://dev.w3.org/fxtf/web-animations/animation-elements.html">
Animation elements</a> specification.</p>


     <p class="note" role="note">Note: media fragments are defined to operate on resources based on
    their MIME type.
    As a result, temporal addressing may not be supported in all situations
    where Web Animations content is used.</p>


     <h2 class="heading settled" data-level="7" id="interaction-with-page-display"><span class="secno">7. </span><span class="content">Interaction with page display</span><a class="self-link" href="#interaction-with-page-display"></a></h2>


     <p>HTML permits user agents to store <a class="externalDFN" href="http://www.w3.org/TR/html51/browsers.html#an-entry-with-persisted-user-state">user-agent
  defined state</a> along with a
<a class="externalDFN" href="http://www.w3.org/TR/html51/browsers.html#session-history-entry">session
history entry</a> so that as a user navigates between pages, the
previous state of the page can be restored including state such as
scroll position <a data-link-type="biblio" href="#biblio-html5">[HTML5]</a>.</p>



     <p>User agents that pause and resume <a class="externalDFN" href="http://www.w3.org/TR/html51/embedded-content-0.html#media-element">media
elements</a> when the referencing document is
unloaded and traversed,
are encouraged to apply consistent handling to documents containing Web
Animations content.
If provided, this behavior SHOULD be achieved by adjusting the <a data-link-type="dfn" href="#time-value">time
values</a> of any <a data-link-type="dfn" href="#timeline">timelines</a> bound to the <a data-link-type="dfn" href="#global-clock">global clock</a>.</p>


     <p class="issue" id="issue-d06e8e73"><a class="self-link" href="#issue-d06e8e73"></a>Is this at odds with those <a data-link-type="dfn" href="#time-value">time values</a> being relative to
    <code>navigationStart</code> and with <code>requestAnimationFrame</code>
    using the same time as <code>document.timeline.currentTime</code>?</p>



     <h2 class="heading settled" data-level="8" id="implementation-requirements"><span class="secno">8. </span><span class="content">Implementation requirements</span><a class="self-link" href="#implementation-requirements"></a></h2>


     <h3 class="heading settled" data-level="8.1" id="precision-of-time-values"><span class="secno">8.1. </span><span class="content">Precision of time values</span><a class="self-link" href="#precision-of-time-values"></a></h3>


     <p>The internal representation of time values is implementation dependant
however, it is RECOMMENDED that user agents be able to represent input
time values with microsecond precision so that 0.000001 is
distinguishable from 0.0.</p>


     <h3 class="heading settled" data-level="8.2" id="conformance-criteria"><span class="secno">8.2. </span><span class="content">Conformance criteria</span><a class="self-link" href="#conformance-criteria"></a></h3>


     <p>This specification defines an abstract model for animation and, as
such, for user agents that do not support scripting, there are no
conformance criteria since there is no testable surface area.</p>


     <p>User agents that do not support scripting, however, may implement
additional technologies defined in terms of this specification in
which case the definitions provided in this specification will form
part of the conformance criteria of the additional technology.</p>


     <p>A <dfn data-dfn-type="dfn" data-noexport="" id="conforming-scripted-web-animations-user-agent">conforming scripted Web Animations user agent<a class="self-link" href="#conforming-scripted-web-animations-user-agent"></a></dfn> is a user
agent that implements the <abbr title="Application Programming Interface">API</abbr> defined in
<a href="#programming-interface">§5 Programming interface</a>.</p>


     <h2 class="heading settled" data-level="9" id="interface-summary"><span class="secno">9. </span><span class="content">Interface summary</span><a class="self-link" href="#interface-summary"></a></h2>


     <div idl-index=""></div>


     <h2 class="heading settled" data-level="10" id="acknowledgements"><span class="secno">10. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>


     <p>Thank you to Michiel “Pomax” Kamermans for help with the
equations for a proposed smooth timing function although this feature
has been deferred to a subsequent specification.</p>


     <p>Our deep gratitude goes out to <a href="http://www.southernstarentertainment.com.au/">Southern Star
Animation</a> for their kind generosity and patience in introducing the
editors to the processes and techniques used producing broadcast
animations.</p>


     <p>The <a href="https://github.com/w3c/web-animations/commits/master">changelog</a>
provides a more detailed history.</p>


     <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">
Conformance</span><a class="self-link" href="#conformance"></a></h2>


     <h3 class="no-ref heading settled" id="conventions"><span class="content">
Document conventions</span><a class="self-link" href="#conventions"></a></h3>

    
     <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    </p>
     <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>

    
     <p>Examples in this specification are introduced with the words "for
    example" or are set apart from the normative text with
    <code>class="example"</code>, like this:

    </p>
     <div class="example">
        
      <p>This is an example of an informative example.</p>
      
    
     </div>

    
     <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

    </p>
     <p class="note" role="note">Note, this is an informative note.</p>

    
     <p>Advisements are normative sections styled to evoke special attention and
    are set apart from other normative text with <code>&lt;strong
    class="advisement"></code>, like this:

    <strong class="advisement">
        UAs MUST provide an accessible alternative.
    </strong>

    </p>
     <p>This specification defines a number of procedures.
    User agents are not required to implement these procedures as specified but
    may alter the steps and data structures freely provided the observable
    result is equivalent.

    </p>
     <p>Some procedures <dfn data-dfn-type="dfn" data-noexport="" id="assert">assert<a class="self-link" href="#assert"></a></dfn> an invariant condition.
    Such assertions are intended to clarify the expected behavior and do not
    constitute implementation requirements.



</p></div></div></main>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css21"><a class="self-link" href="#biblio-css21"></a>[CSS21]
   <dd>Bert Bos; et al. <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607">Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</a>. 7 June 2011. W3C Recommendation. URL: <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607">http://www.w3.org/TR/2011/REC-CSS2-20110607</a>
   <dt id="biblio-css3val"><a class="self-link" href="#biblio-css3val"></a>[CSS3VAL]
   <dd>Håkon Wium Lie; Tab Atkins; Elika J. Etemad. <a href="http://www.w3.org/TR/2013/CR-css3-values-20130730/">CSS Values and Units Module Level 3</a>. 30 July 2013. W3C Candidate Recommendation. (Work in progress.) URL: <a href="http://www.w3.org/TR/2013/CR-css3-values-20130730/">http://www.w3.org/TR/2013/CR-css3-values-20130730/</a>
   <dt id="biblio-ecma-262"><a class="self-link" href="#biblio-ecma-262"></a>[ECMA-262]
   <dd>???. <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMAScript Language Specification, Edition 5.1</a>. June 2011. URL: <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">http://www.ecma-international.org/publications/standards/Ecma-262.htm</a>
   <dt id="biblio-select"><a class="self-link" href="#biblio-select"></a>[SELECT]
   <dd>Tantek Çelik; et al. <a href="http://www.w3.org/TR/2011/REC-css3-selectors-20110929/">Selectors Level 3</a>. 29 September 2011. W3C Recommendation. URL: <a href="http://www.w3.org/TR/2011/REC-css3-selectors-20110929/">http://www.w3.org/TR/2011/REC-css3-selectors-20110929/</a>
   <dt id="biblio-svg11"><a class="self-link" href="#biblio-svg11"></a>[SVG11]
   <dd>Erik Dahlström; et al. <a href="http://www.w3.org/TR/SVG11/">Scalable Vector Graphics (SVG) 1.1 (Second Edition)</a>. 16 August 2011. REC. URL: <a href="http://www.w3.org/TR/SVG11/">http://www.w3.org/TR/SVG11/</a>
   <dt id="biblio-webidl"><a class="self-link" href="#biblio-webidl"></a>[WebIDL]
   <dd>Cameron McCormack. <a href="http://www.w3.org/TR/WebIDL/">Web IDL</a>. 19 April 2012. CR. URL: <a href="http://www.w3.org/TR/WebIDL/">http://www.w3.org/TR/WebIDL/</a>
   <dt id="biblio-cssom"><a class="self-link" href="#biblio-cssom"></a>[cssom]
   <dd>Simon Pieters; Glenn Adams. <a href="http://www.w3.org/TR/cssom/">CSS Object Model (CSSOM)</a>. 5 December 2013. WD. URL: <a href="http://www.w3.org/TR/cssom/">http://www.w3.org/TR/cssom/</a>
   <dt id="biblio-dom"><a class="self-link" href="#biblio-dom"></a>[dom]
   <dd>Anne van Kesteren; et al. <a href="http://www.w3.org/TR/dom/">W3C DOM4</a>. 10 July 2014. LCWD. URL: <a href="http://www.w3.org/TR/dom/">http://www.w3.org/TR/dom/</a>
   <dt id="biblio-media-frags"><a class="self-link" href="#biblio-media-frags"></a>[media-frags]
   <dd>Raphaël Troncy; et al. <a href="http://www.w3.org/TR/media-frags/">Media Fragments URI 1.0 (basic)</a>. 25 September 2012. REC. URL: <a href="http://www.w3.org/TR/media-frags/">http://www.w3.org/TR/media-frags/</a>
   <dt id="biblio-navigation-timing"><a class="self-link" href="#biblio-navigation-timing"></a>[navigation-timing]
   <dd>Zhiheng Wang. <a href="http://www.w3.org/TR/navigation-timing/">Navigation Timing</a>. 17 December 2012. REC. URL: <a href="http://www.w3.org/TR/navigation-timing/">http://www.w3.org/TR/navigation-timing/</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[rfc2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a></dl>
  <h3 class="no-num heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-css3-transforms"><a class="self-link" href="#biblio-css3-transforms"></a>[CSS3-TRANSFORMS]
   <dd>Simon Fraser; et al. <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/">CSS Transforms</a>. 11 September 2012. W3C Working Draft. (Work in progress.) URL: <a href="http://www.w3.org/TR/2012/WD-css3-transforms-20120911/">http://www.w3.org/TR/2012/WD-css3-transforms-20120911/</a>
   <dt id="biblio-fund-comp-graphics"><a class="self-link" href="#biblio-fund-comp-graphics"></a>[FUND-COMP-GRAPHICS]
   <dd>Peter Shirley; Michael Ashikhmin; Steve Marschner. Fundamentals of Computer Graphics. 2009. 
   <dt id="biblio-svg2"><a class="self-link" href="#biblio-svg2"></a>[SVG2]
   <dd>Nikos Andronikos; et al. <a href="http://www.w3.org/TR/SVG2/">Scalable Vector Graphics (SVG) 2</a>. 11 February 2014. WD. URL: <a href="http://www.w3.org/TR/SVG2/">http://www.w3.org/TR/SVG2/</a>
   <dt id="biblio-animation-timing"><a class="self-link" href="#biblio-animation-timing"></a>[animation-timing]
   <dd>James Robinson; Cameron McCormack. <a href="http://www.w3.org/TR/animation-timing/">Timing control for script-based animations</a>. 31 October 2013. CR. URL: <a href="http://www.w3.org/TR/animation-timing/">http://www.w3.org/TR/animation-timing/</a>
   <dt id="biblio-css3-animations"><a class="self-link" href="#biblio-css3-animations"></a>[css3-animations]
   <dd>Dean Jackson; et al. <a href="http://www.w3.org/TR/css3-animations/">CSS Animations</a>. 19 February 2013. WD. URL: <a href="http://www.w3.org/TR/css3-animations/">http://www.w3.org/TR/css3-animations/</a>
   <dt id="biblio-css3-transitions"><a class="self-link" href="#biblio-css3-transitions"></a>[css3-transitions]
   <dd>Dean Jackson; et al. <a href="http://www.w3.org/TR/css3-transitions/">CSS Transitions</a>. 19 November 2013. WD. URL: <a href="http://www.w3.org/TR/css3-transitions/">http://www.w3.org/TR/css3-transitions/</a>
   <dt id="biblio-css4-images"><a class="self-link" href="#biblio-css4-images"></a>[css4-images]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="http://www.w3.org/TR/css4-images/">CSS Image Values and Replaced Content Module Level 4</a>. 11 September 2012. WD. URL: <a href="http://www.w3.org/TR/css4-images/">http://www.w3.org/TR/css4-images/</a>
   <dt id="biblio-hr-time"><a class="self-link" href="#biblio-hr-time"></a>[hr-time]
   <dd>Jatinder Mann. <a href="http://www.w3.org/TR/hr-time/">High Resolution Time</a>. 17 December 2012. REC. URL: <a href="http://www.w3.org/TR/hr-time/">http://www.w3.org/TR/hr-time/</a>
   <dt id="biblio-html5"><a class="self-link" href="#biblio-html5"></a>[html5]
   <dd>Ian Hickson; et al. <a href="http://www.w3.org/TR/html5/">HTML5</a>. 28 October 2014. REC. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
   <dt id="biblio-smil-animation"><a class="self-link" href="#biblio-smil-animation"></a>[smil-animation]
   <dd>Patrick Schmitz; Aaron Cohen. <a href="http://www.w3.org/TR/smil-animation/">SMIL Animation</a>. 4 September 2001. REC. URL: <a href="http://www.w3.org/TR/smil-animation/">http://www.w3.org/TR/smil-animation/</a></dl>
  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <ul class="indexlist">
   <li>active duration, <a href="#active-duration">3.10.2</a>
   <li>activeDuration, <a href="#dom-computedtimingproperties-activeduration">5.8</a>
   <li>active interval, <a href="#active-interval">3.6.3</a>
   <li>active phase, <a href="#active-phase">3.6.5</a>
   <li>active time, <a href="#active-time">3.10.3.1</a>
   <li>after(), <a href="#dom-animationnodemutable-after">5.4</a>
   <li>after phase, <a href="#after-phase">3.6.5</a>
   <li>ancestor, <a href="#ancestor">3.13</a>
   <li>animatable, <a href="#concept-animatable">4.1.2</a>
   <li>Animatable, <a href="#animatable">5.13</a>
   <li>animatable as color, <a href="#animatable-as-color">4.1.3.5</a>
   <li>animatable as length,
percentage, or calc, <a href="#animatable-as-length-percentage-or-calc">4.1.3.4</a>
   <li>animatable as real
number, <a href="#animatable-as-real-number">4.1.3.3</a>
   <li>animatable as string, <a href="#animatable-as-string">4.1.3.2</a>
   <li>animatable as transform
list, <a href="#animatable-as-transform-list">4.1.3.6</a>
   <li>animate(), <a href="#dom-animatable-animate">5.13</a>
   <li>animated
attribute value, <a href="#animated-attribute-value">4.2.4.2</a>
   <li>animate(effect), <a href="#dom-animatable-animateeffect-timing">5.13</a>
   <li>animate(effect, timing), <a href="#dom-animatable-animateeffect-timing">5.13</a>
   <li>Animation, <a href="#animation">5.12</a>
   <li>animation accumulation, <a href="#animation-accumulation">4.1.2</a>
   <li>animation addition, <a href="#animation-addition">4.1.2</a>
   <li>animation
behavior, <a href="#animation-behavior">4.1.3</a>
   <li>animation effect, <a href="#animation-effect">4.1</a>
   <li>AnimationEffectReadonly, <a href="#animationeffectreadonly">5.14</a>
   <li>animation group, <a href="#animation-group">3.13</a>
   <li>AnimationGroup, <a href="#animationgroup">5.9</a>
   <li>AnimationGroup(children, timing), <a href="#dom-animationgroup-animationgroupchildren-timing">5.9</a>
   <li>AnimationGroupMutable, <a href="#animationgroupmutable">5.9</a>
   <li>AnimationGroupReadonly, <a href="#animationgroupreadonly">5.9</a>
   <li>AnimationGroupReadonly(children, timing), <a href="#dom-animationgroupreadonly-animationgroupreadonlychildren-timing">5.9</a>
   <li>animation interpolation, <a href="#animation-interpolation">4.1.2</a>
   <li>animation node, <a href="#animation-node">3.6</a>
   <li>AnimationNodeList, <a href="#animationnodelist">5.10</a>
   <li>AnimationNodeMutable, <a href="#animationnodemutable">5.4</a>
   <li>animation node playback rate, <a href="#animation-node-playback-rate">3.9</a>
   <li>AnimationNodeReadonly, <a href="#animationnodereadonly">5.4</a>
   <li>animation node start time, <a href="#animation-node-start-time">3.6.3</a>
   <li>animationObject, <a href="#dom-effectcallback-animationobject">5.20</a>
   <li>AnimationPlayer, <a href="#animationplayer">5.3</a>
   <li>AnimationPlayer(source, timeline), <a href="#dom-animationplayer-animationplayersource-timeline">5.3</a>
   <li>AnimationPlayState, <a href="#enumdef-animationplaystate">5.3.1</a>
   <li>AnimationReadonly, <a href="#animationreadonly">5.12</a>
   <li>AnimationReadonly(target, effect, timing), <a href="#dom-animationreadonly-animationreadonlytarget-effect-timing">5.12</a>
   <li>Animations, <a href="#concept-animation">3.14</a>
   <li>AnimationSequence(), <a href="#dom-animationsequence-animationsequence">5.11</a>
   <li>animation sequence, <a href="#animation-sequence">3.13.4</a>
   <li>AnimationSequence, <a href="#animationsequence">5.11</a>
   <li>AnimationSequenceReadonly, <a href="#animationsequencereadonly">5.11</a>
   <li>animation
stack, <a href="#animation-stack">4.2.1</a>
   <li>animation stylesheet, <a href="#animation-stylesheet">4.2.4.1</a>
   <li>animation
target, <a href="#animation-target">3.14</a>
   <li>Animation(target, effect, timing), <a href="#dom-animation-animationtarget-effect-timing">5.12</a>
   <li>AnimationTimeline, <a href="#animationtimeline">5.2</a>
   <li>AnimationTiming, <a href="#animationtiming">5.6</a>
   <li>AnimationTimingProperties, <a href="#dictdef-animationtimingproperties">5.7</a>
   <li>AnimationTimingReadonly, <a href="#animationtimingreadonly">5.5</a>
   <li>append(), <a href="#dom-animationgroupmutable-append">5.9</a>
   <li>assert, <a href="#assert">Unnumbered section</a>
   <li>associated player of an animation effect, <a href="#associated-player-of-an-animation-effect">4.2.1</a>
   <li>associated with a player, <a href="#associated-with-a-player">3.6.1</a>
   <li>associated with
a timeline, <a href="#associated-with-a-timeline">3.6.1</a>
   <li>before(), <a href="#dom-animationnodemutable-before">5.4</a>
   <li>before flag, <a href="#before-flag">3.12.4</a>
   <li>before phase, <a href="#before-phase">3.6.5</a>
   <li>cancel(), <a href="#dom-animationplayer-cancel">5.3</a>
   <li>cancel a player, <a href="#cancel-a-player">3.5.15</a>
   <li>child animation node, <a href="#child-animation-node">3.13</a>
   <li>children
    <ul>
     <li>argument for AnimationGroupReadonly/AnimationGroupReadonly(children, timing), <a href="#dom-animationgroupreadonly-animationgroupreadonlychildren-timing-children">5.9</a>
     <li>attribute for AnimationGroupReadonly, <a href="#dom-animationgroupreadonly-children">5.9</a>
    </ul>
   <li>clone()
    <ul>
     <li>method for AnimationGroupReadonly, <a href="#dom-animationgroupreadonly-clone">5.9</a>
     <li>method for AnimationSequenceReadonly, <a href="#dom-animationsequencereadonly-clone">5.11</a>
     <li>method for AnimationReadonly, <a href="#dom-animationreadonly-clone">5.12</a>
     <li>method for KeyframeEffectReadonly, <a href="#dom-keyframeeffectreadonly-clone">5.17</a>
    </ul>
   <li>composite
    <ul>
     <li>attribute for AnimationEffectReadonly, <a href="#dom-animationeffectreadonly-composite">5.14</a>
     <li>attribute for KeyframeEffect, <a href="#dom-keyframeeffect-composite">5.17</a>
     <li>dict-member for KeyframeEffectOptions, <a href="#dom-keyframeeffectoptions-composite">5.17.2</a>
     <li>dict-member for Keyframe, <a href="#dom-keyframe-composite">5.18</a>
    </ul>
   <li>composited value, <a href="#composited-value">4.2.2</a>
   <li>composite operation, <a href="#composite-operation">4.2.3</a>
   <li>CompositeOperation
    <ul>
     <li>definition of, <a href="#compositeoperation">5.16</a>
     <li>(enum), <a href="#enumdef-compositeoperation">5.16</a>
    </ul>
   <li>composite operation accumulate, <a href="#composite-operation-accumulate">4.2.3</a>
   <li>composite operation add, <a href="#composite-operation-add">4.2.3</a>
   <li>composite operation replace, <a href="#composite-operation-replace">4.2.3</a>
   <li>composition, <a href="#composition">4.2</a>
   <li>ComputedKeyframe, <a href="#dictdef-computedkeyframe">5.19</a>
   <li>computedOffset, <a href="#dom-computedkeyframe-computedoffset">5.19</a>
   <li>computedTiming, <a href="#dom-animationnodereadonly-computedtiming">5.4</a>
   <li>ComputedTimingProperties, <a href="#dictdef-computedtimingproperties">5.8</a>
   <li>conforming scripted Web Animations user agent, <a href="#conforming-scripted-web-animations-user-agent">8.2</a>
   <li>create a new resolved Promise, <a href="#create-a-new-resolved-promise">3.5.7</a>
   <li>&lt;cubic-bezier-timing-function>, <a href="#typedef-cubic-bezier-timing-function">3.12.3</a>
   <li>cubic Bézier timing function, <a href="#cubic-bzier-timing-function">3.12.3</a>
   <li>current, <a href="#current">3.6.5</a>
   <li>current finished promise, <a href="#current-finished-promise">3.5.12</a>
   <li>current iteration, <a href="#current-iteration">3.10.4</a>
   <li>currentIteration, <a href="#dom-computedtimingproperties-currentiteration">5.8</a>
   <li>current ready promise, <a href="#current-ready-promise">3.5.8</a>
   <li>currentTarget, <a href="#dom-effectcallback-currenttarget">5.20</a>
   <li>current time, <a href="#current-time">3.5.3</a>
   <li>currentTime
    <ul>
     <li>attribute for AnimationTimeline, <a href="#dom-animationtimeline-currenttime">5.2</a>
     <li>attribute for AnimationPlayer, <a href="#dom-animationplayer-currenttime">5.3</a>
    </ul>
   <li>custom effect, <a href="#custom-effect">4.4</a>
   <li>custom player
priority, <a href="#custom-player-priority">4.2.1.1</a>
   <li>delay
    <ul>
     <li>attribute for AnimationTimingReadonly, <a href="#dom-animationtimingreadonly-delay">5.5</a>
     <li>attribute for AnimationTiming, <a href="#dom-animationtiming-delay">5.6</a>
     <li>dict-member for AnimationTimingProperties, <a href="#dom-animationtimingproperties-delay">5.7</a>
    </ul>
   <li>descendant, <a href="#descendant">3.13</a>
   <li>directed time, <a href="#directed-time">3.11.1</a>
   <li>direction
    <ul>
     <li>attribute for AnimationTimingReadonly, <a href="#dom-animationtimingreadonly-direction">5.5</a>
     <li>attribute for AnimationTiming, <a href="#dom-animationtiming-direction">5.6</a>
     <li>dict-member for AnimationTimingProperties, <a href="#dom-animationtimingproperties-direction">5.7</a>
    </ul>
   <li>directly associated with a player, <a href="#directly-associated-with-a-player">3.6.1</a>
   <li>distance computation, <a href="#distance-computation">4.1.2</a>
   <li>distk, <a href="#distk">4.3.1.1</a>
   <li>distribute keyframe spacing mode, <a href="#distribute-keyframe-spacing-mode">4.3.1</a>
   <li>document
timeline, <a href="#document-timeline">3.4.1</a>
   <li>duration
    <ul>
     <li>attribute for AnimationTimingReadonly, <a href="#dom-animationtimingreadonly-duration">5.5</a>
     <li>attribute for AnimationTiming, <a href="#dom-animationtiming-duration">5.6</a>
     <li>dict-member for AnimationTimingProperties, <a href="#dom-animationtimingproperties-duration">5.7</a>
    </ul>
   <li>easing
    <ul>
     <li>attribute for AnimationTimingReadonly, <a href="#dom-animationtimingreadonly-easing">5.5</a>
     <li>attribute for AnimationTiming, <a href="#dom-animationtiming-easing">5.6</a>
     <li>dict-member for AnimationTimingProperties, <a href="#dom-animationtimingproperties-easing">5.7</a>
     <li>dict-member for Keyframe, <a href="#dom-keyframe-easing">5.18</a>
    </ul>
   <li>effect
    <ul>
     <li>argument for AnimationReadonly/AnimationReadonly(target, effect, timing), <a href="#dom-animationreadonly-animationreadonlytarget-effect-timing-effect">5.12</a>
     <li>attribute for AnimationReadonly, <a href="#dom-animationreadonly-effect">5.12</a>
     <li>argument for Animation/Animation(target, effect, timing), <a href="#dom-animation-animationtarget-effect-timing-effect">5.12</a>
     <li>attribute for Animation, <a href="#dom-animation-effect">5.12</a>
     <li>argument for Animatable/animate, <a href="#dom-animatable-animate-effect">5.13</a>
    </ul>
   <li>EffectCallback, <a href="#callbackdef-effectcallback">5.20</a>
   <li>end delay, <a href="#end-delay">3.6.3</a>
   <li>endDelay
    <ul>
     <li>attribute for AnimationTimingReadonly, <a href="#dom-animationtimingreadonly-enddelay">5.5</a>
     <li>attribute for AnimationTiming, <a href="#dom-animationtiming-enddelay">5.6</a>
     <li>dict-member for AnimationTimingProperties, <a href="#dom-animationtimingproperties-enddelay">5.7</a>
    </ul>
   <li>endTime, <a href="#dom-computedtimingproperties-endtime">5.8</a>
   <li>end time, <a href="#end-time">3.6.3</a>
   <li>evenly distributing
a keyframe, <a href="#evenly-distributing-a-keyframe">4.3.1.1</a>
   <li>fill
    <ul>
     <li>attribute for AnimationTimingReadonly, <a href="#dom-animationtimingreadonly-fill">5.5</a>
     <li>attribute for AnimationTiming, <a href="#dom-animationtiming-fill">5.6</a>
     <li>dict-member for AnimationTimingProperties, <a href="#dom-animationtimingproperties-fill">5.7</a>
    </ul>
   <li>fill mode, <a href="#fill-mode">3.7</a>
   <li>FillMode, <a href="#enumdef-fillmode">5.8.1</a>
   <li>finish(), <a href="#dom-animationplayer-finish">5.3</a>
   <li>finish a player, <a href="#finish-a-player">3.5.14</a>
   <li>finished, <a href="#dom-animationplayer-finished">5.3</a>
   <li>finished play state, <a href="#finished-play-state">3.5.18</a>
   <li>firstChild, <a href="#dom-animationgroupreadonly-firstchild">5.9</a>
   <li>first child, <a href="#first-child">3.13</a>
   <li>frames
    <ul>
     <li>argument for KeyframeEffectReadonly/KeyframeEffectReadonly(frames, options), <a href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options-frames">5.17</a>
     <li>argument for KeyframeEffect/KeyframeEffect(frames, options), <a href="#dom-keyframeeffect-keyframeeffectframes-options-frames">5.17</a>
     <li>argument for KeyframeEffect/setFrames, <a href="#dom-keyframeeffect-setframes-frames">5.17</a>
    </ul>
   <li>getAnimationPlayers()
    <ul>
     <li>method for AnimationTimeline, <a href="#dom-animationtimeline-getanimationplayers">5.2</a>
     <li>method for Animatable, <a href="#dom-animatable-getanimationplayers">5.13</a>
    </ul>
   <li>getFrames(), <a href="#dom-keyframeeffectreadonly-getframes">5.17</a>
   <li>global clock, <a href="#global-clock">3.3</a>
   <li>hold time, <a href="#hold-time">3.5</a>
   <li>idle play state, <a href="#idle-play-state">3.5.18</a>
   <li>inactive timeline, <a href="#inactive-timeline">3.4</a>
   <li>inclusive ancestor, <a href="#inclusive-ancestor">3.13</a>
   <li>inclusive descendant, <a href="#inclusive-descendant">3.13</a>
   <li>index, <a href="#dom-animationnodelist-item-index">5.10</a>
   <li>in effect, <a href="#in-effect">3.6.5</a>
   <li>inherited time, <a href="#inherited-time">3.6.4</a>
   <li>in play, <a href="#in-play">3.6.5</a>
   <li>insert children, <a href="#insert-children">5.9.2</a>
   <li>intermediate animation value, <a href="#intermediate-animation-value">4.1.4</a>
   <li>intrinsic iteration duration, <a href="#intrinsic-iteration-duration">3.8.1</a>
   <li>item(), <a href="#dom-animationnodelist-item">5.10</a>
   <li>item(index), <a href="#dom-animationnodelist-itemindex">5.10</a>
   <li>iterationComposite
    <ul>
     <li>attribute for AnimationEffectReadonly, <a href="#dom-animationeffectreadonly-iterationcomposite">5.14</a>
     <li>attribute for KeyframeEffect, <a href="#dom-keyframeeffect-iterationcomposite">5.17</a>
     <li>dict-member for KeyframeEffectOptions, <a href="#dom-keyframeeffectoptions-iterationcomposite">5.17.2</a>
    </ul>
   <li>IterationCompositeOperation
    <ul>
     <li>definition of, <a href="#iterationcompositeoperation">5.15</a>
     <li>(enum), <a href="#enumdef-iterationcompositeoperation">5.15</a>
    </ul>
   <li>iteration composite operation, <a href="#iteration-composite-operation">4.2.5</a>
   <li>iteration composite operation accumulate, <a href="#iteration-composite-operation-accumulate">4.2.5</a>
   <li>iteration composite operation replace, <a href="#iteration-composite-operation-replace">4.2.5</a>
   <li>iteration count, <a href="#iteration-count">3.8.2</a>
   <li>iteration
duration, <a href="#iteration-duration">3.8.1</a>
   <li>iteration interval, <a href="#iteration-interval">3.8.1</a>
   <li>iterations
    <ul>
     <li>attribute for AnimationTimingReadonly, <a href="#dom-animationtimingreadonly-iterations">5.5</a>
     <li>attribute for AnimationTiming, <a href="#dom-animationtiming-iterations">5.6</a>
     <li>dict-member for AnimationTimingProperties, <a href="#dom-animationtimingproperties-iterations">5.7</a>
    </ul>
   <li>iterationStart
    <ul>
     <li>attribute for AnimationTimingReadonly, <a href="#dom-animationtimingreadonly-iterationstart">5.5</a>
     <li>attribute for AnimationTiming, <a href="#dom-animationtiming-iterationstart">5.6</a>
     <li>dict-member for AnimationTimingProperties, <a href="#dom-animationtimingproperties-iterationstart">5.7</a>
    </ul>
   <li>iteration start, <a href="#iteration-start">3.8.2</a>
   <li>iteration time, <a href="#iteration-time">3.10.3.3</a>
   <li>keyframe, <a href="#keyframe">4.3</a>
   <li>Keyframe, <a href="#dictdef-keyframe">5.18</a>
   <li>keyframe animation effect, <a href="#keyframe-animation-effect">4.3</a>
   <li>KeyframeEffect, <a href="#keyframeeffect">5.17</a>
   <li>KeyframeEffect(frames, options), <a href="#dom-keyframeeffect-keyframeeffectframes-options">5.17</a>
   <li>KeyframeEffectOptions, <a href="#dictdef-keyframeeffectoptions">5.17.2</a>
   <li>KeyframeEffectReadonly, <a href="#keyframeeffectreadonly">5.17</a>
   <li>KeyframeEffectReadonly(frames, options), <a href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options">5.17</a>
   <li>keyframe offset, <a href="#keyframe-offset">4.3</a>
   <li>keyframe spacing mode, <a href="#keyframe-spacing-mode">4.3.1</a>
   <li>lacuna value, <a href="#lacuna-value">4.2.4.2</a>
   <li>lastChild, <a href="#dom-animationgroupreadonly-lastchild">5.9</a>
   <li>last child, <a href="#last-child">3.13</a>
   <li>length, <a href="#dom-animationnodelist-length">5.10</a>
   <li>linear timing
function, <a href="#linear-timing-function">3.12.2</a>
   <li>localTime, <a href="#dom-computedtimingproperties-localtime">5.8</a>
   <li>local time, <a href="#local-time">3.6.4</a>
   <li>loosely sorted by offset, <a href="#loosely-sorted-by-offset">4.3</a>
   <li>name
    <ul>
     <li>attribute for AnimationEffectReadonly, <a href="#dom-animationeffectreadonly-name">5.14</a>
     <li>attribute for KeyframeEffect, <a href="#dom-keyframeeffect-name">5.17</a>
     <li>dict-member for KeyframeEffectOptions, <a href="#dom-keyframeeffectoptions-name">5.17.2</a>
    </ul>
   <li>neutral value for composition, <a href="#neutral-value-for-composition">4.3.2</a>
   <li>next sibling, <a href="#next-sibling">3.13</a>
   <li>nextSibling, <a href="#dom-animationnodereadonly-nextsibling">5.4</a>
   <li>next sibling not included, <a href="#next-sibling-not-included">5.9.2</a>
   <li>nodes
    <ul>
     <li>argument for AnimationNodeMutable/before, <a href="#dom-animationnodemutable-before-nodes">5.4</a>
     <li>argument for AnimationNodeMutable/after, <a href="#dom-animationnodemutable-after-nodes">5.4</a>
     <li>argument for AnimationNodeMutable/replace, <a href="#dom-animationnodemutable-replace-nodes">5.4</a>
     <li>argument for AnimationGroupMutable/prepend, <a href="#dom-animationgroupmutable-prepend-nodes">5.9</a>
     <li>argument for AnimationGroupMutable/append, <a href="#dom-animationgroupmutable-append-nodes">5.9</a>
    </ul>
   <li>not additive, <a href="#not-additive">4.1.3</a>
   <li>not animatable, <a href="#concept-not-animatable">4.1.3.1</a>
   <li>not
paceable, <a href="#not-paceable">4.1.3</a>
   <li>offset, <a href="#dom-keyframe-offset">5.18</a>
   <li>offsetk, <a href="#offsetk">4.3.1.1</a>
   <li>options
    <ul>
     <li>argument for KeyframeEffectReadonly/KeyframeEffectReadonly(frames, options), <a href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options-options">5.17</a>
     <li>argument for KeyframeEffect/KeyframeEffect(frames, options), <a href="#dom-keyframeeffect-keyframeeffectframes-options-options">5.17</a>
    </ul>
   <li>paceable, <a href="#paceable">4.3.1.1</a>
   <li>paced keyframe spacing mode, <a href="#paced-keyframe-spacing-mode">4.3.1</a>
   <li>paced property, <a href="#paced-property">4.3.1</a>
   <li>parent, <a href="#dom-animationnodereadonly-parent">5.4</a>
   <li>parent
animation group, <a href="#parent-animation-group">3.13</a>
   <li>pause(), <a href="#dom-animationplayer-pause">5.3</a>
   <li>pause a player, <a href="#pause-a-player">3.5.10</a>
   <li>paused play state, <a href="#paused-play-state">3.5.18</a>
   <li>pending pause task, <a href="#pending-pause-task">3.5.10</a>
   <li>pending play state, <a href="#pending-play-state">3.5.18</a>
   <li>pending play task, <a href="#pending-play-task">3.5.9</a>
   <li>play()
    <ul>
     <li>method for AnimationTimeline, <a href="#dom-animationtimeline-play">5.2</a>
     <li>method for AnimationPlayer, <a href="#dom-animationplayer-play">5.3</a>
    </ul>
   <li>play a player, <a href="#play-a-player">3.5.9</a>
   <li>PlaybackDirection, <a href="#enumdef-playbackdirection">5.8.2</a>
   <li>playback
direction, <a href="#playback-direction">3.11</a>
   <li>playbackRate
    <ul>
     <li>attribute for AnimationPlayer, <a href="#dom-animationplayer-playbackrate">5.3</a>
     <li>attribute for AnimationTimingReadonly, <a href="#dom-animationtimingreadonly-playbackrate">5.5</a>
     <li>attribute for AnimationTiming, <a href="#dom-animationtiming-playbackrate">5.6</a>
     <li>dict-member for AnimationTimingProperties, <a href="#dom-animationtimingproperties-playbackrate">5.7</a>
    </ul>
   <li>player, <a href="#player">3.5</a>
   <li>player playback
rate, <a href="#player-playback-rate">3.5.16</a>
   <li>player sequence number, <a href="#player-sequence-number">3.5</a>
   <li>player start time, <a href="#player-start-time">3.5</a>
   <li>playState, <a href="#dom-animationplayer-playstate">5.3</a>
   <li>play state, <a href="#play-state">3.5.18</a>
   <li>prepend(), <a href="#dom-animationgroupmutable-prepend">5.9</a>
   <li>previous current
time, <a href="#previous-current-time">3.5.13</a>
   <li>previous finished state, <a href="#previous-finished-state">3.5.13</a>
   <li>previous sibling, <a href="#previous-sibling">3.13</a>
   <li>previousSibling, <a href="#dom-animationnodereadonly-previoussibling">5.4</a>
   <li>procedure for converting an ECMAScript value into
an IDL keyframe or sequence of keyframes, <a href="#procedure-for-converting-an-ecmascript-value-into-an-idl-keyframe-or-sequence-of-keyframes">5.17.1</a>
   <li>procedure for converting an ECMAScript value to an IDL
Keyframe object, <a href="#procedure-for-converting-an-ecmascript-value-to-an-idl-keyframe-object">5.18.1</a>
   <li>procedure for converting an effect to an IDL value, <a href="#procedure-for-converting-an-effect-to-an-idl-value">5.12.1</a>
   <li>procedure for processing a timing argument, <a href="#procedure-for-processing-a-timing-argument">5.9.1</a>
   <li>Promise, <a href="#promise">3.5.7</a>
   <li>ready
    <ul>
     <li>definition of, <a href="#ready">3.5.6</a>
     <li>attribute for AnimationPlayer, <a href="#dom-animationplayer-ready">5.3</a>
    </ul>
   <li>reject a Promise, <a href="#reject-a-promise">3.5.7</a>
   <li>remove(), <a href="#dom-animationnodemutable-remove">5.4</a>
   <li>remove an animation node, <a href="#remove-an-animation-node">5.9.2</a>
   <li>repeated duration, <a href="#repeated-duration">3.10.2</a>
   <li>replace(), <a href="#dom-animationnodemutable-replace">5.4</a>
   <li>reset a player’s pending tasks, <a href="#reset-a-players-pending-tasks">3.5.1</a>
   <li>resolve a Promise, <a href="#resolve-a-promise">3.5.7</a>
   <li>reverse(), <a href="#dom-animationplayer-reverse">5.3</a>
   <li>reverse a player, <a href="#reverse-a-player">3.5.17</a>
   <li>root, <a href="#root">3.13</a>
   <li>running play state, <a href="#running-play-state">3.5.18</a>
   <li>sampling, <a href="#sampling">3.2</a>
   <li>scaled active time, <a href="#scaled-active-time">3.10.3.2</a>
   <li>setFrames(frames), <a href="#dom-keyframeeffect-setframesframes">5.17</a>
   <li>set the current time, <a href="#set-the-current-time">3.5.4</a>
   <li>set the source content of a player, <a href="#set-the-source-content-of-a-player">3.5.2</a>
   <li>set the timeline of a player, <a href="#set-the-timeline-of-a-player">3.5.1</a>
   <li>silently set the current time, <a href="#silently-set-the-current-time">3.5.4</a>
   <li>silently update the player playback rate, <a href="#silently-update-the-player-playback-rate">3.5.16.1</a>
   <li>single-sample, <a href="#single_sample">3.2</a>
   <li>source
    <ul>
     <li>argument for AnimationTimeline/play, <a href="#dom-animationtimeline-play-source">5.2</a>
     <li>argument for AnimationPlayer/AnimationPlayer(source, timeline), <a href="#dom-animationplayer-animationplayersource-timeline-source">5.3</a>
     <li>attribute for AnimationPlayer, <a href="#dom-animationplayer-source">5.3</a>
    </ul>
   <li>source content, <a href="#source-content">3.5</a>
   <li>source content end, <a href="#source-content-end">3.5.13</a>
   <li>spacing
    <ul>
     <li>attribute for KeyframeEffectReadonly, <a href="#dom-keyframeeffectreadonly-spacing">5.17</a>
     <li>attribute for KeyframeEffect, <a href="#dom-keyframeeffect-spacing">5.17</a>
     <li>dict-member for KeyframeEffectOptions, <a href="#dom-keyframeeffectoptions-spacing">5.17.2</a>
    </ul>
   <li>start delay, <a href="#start-delay">3.6.3</a>
   <li>start offset, <a href="#start-offset">3.10.3.2</a>
   <li>startTime
    <ul>
     <li>attribute for AnimationPlayer, <a href="#dom-animationplayer-starttime">5.3</a>
     <li>dict-member for ComputedTimingProperties, <a href="#dom-computedtimingproperties-starttime">5.8</a>
    </ul>
   <li>step timing function, <a href="#step-timing-function">3.12.4</a>
   <li>&lt;step-timing-function>, <a href="#typedef-step-timing-function">3.12.4</a>
   <li>target
    <ul>
     <li>argument for AnimationReadonly/AnimationReadonly(target, effect, timing), <a href="#dom-animationreadonly-animationreadonlytarget-effect-timing-target">5.12</a>
     <li>attribute for AnimationReadonly, <a href="#dom-animationreadonly-target">5.12</a>
     <li>argument for Animation/Animation(target, effect, timing), <a href="#dom-animation-animationtarget-effect-timing-target">5.12</a>
     <li>attribute for Animation, <a href="#dom-animation-target">5.12</a>
    </ul>
   <li>target property, <a href="#target-property">4.1.1</a>
   <li>time fraction, <a href="#time-fraction">3.14.1</a>
   <li>timeFraction
    <ul>
     <li>dict-member for ComputedTimingProperties, <a href="#dom-computedtimingproperties-timefraction">5.8</a>
     <li>argument for EffectCallback, <a href="#dom-effectcallback-timefraction">5.20</a>
    </ul>
   <li>timeline
    <ul>
     <li>definition of, <a href="#timeline">3.4</a>
     <li>argument for AnimationPlayer/AnimationPlayer(source, timeline), <a href="#dom-animationplayer-animationplayersource-timeline-timeline">5.3</a>
     <li>attribute for AnimationPlayer, <a href="#dom-animationplayer-timeline">5.3</a>
     <li>attribute for Document, <a href="#dom-document-timeline">5.21</a>
    </ul>
   <li>time value, <a href="#time-value">3.2</a>
   <li>timing
    <ul>
     <li>attribute for AnimationNodeReadonly, <a href="#dom-animationnodereadonly-timing">5.4</a>
     <li>argument for AnimationGroupReadonly/AnimationGroupReadonly(children, timing), <a href="#dom-animationgroupreadonly-animationgroupreadonlychildren-timing-timing">5.9</a>
     <li>argument for AnimationReadonly/AnimationReadonly(target, effect, timing), <a href="#dom-animationreadonly-animationreadonlytarget-effect-timing-timing">5.12</a>
     <li>argument for Animation/Animation(target, effect, timing), <a href="#dom-animation-animationtarget-effect-timing-timing">5.12</a>
     <li>argument for Animatable/animate, <a href="#dom-animatable-animate-timing">5.13</a>
    </ul>
   <li>timing function, <a href="#timing-function">3.12.2</a>
   <li>transformed time, <a href="#transformed-time">3.12.5</a>
   <li>tree order, <a href="#tree-order">3.13</a>
   <li>underlying value, <a href="#underlying-value">4.2.2</a>
   <li>unresolved, <a href="#unresolved">3.2</a>
   <li>update a player’s finished state, <a href="#update-a-players-finished-state">3.5.13</a>
   <li>update the player playback rate, <a href="#update-the-player-playback-rate">3.5.16.1</a>
   <li>update the player start time, <a href="#update-the-player-start-time">3.5.5</a>
   <li>zero time, <a href="#zero-time">3.4</a></ul>
  <h2 class="no-num heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
  <pre class="idl">interface <a data-global-name="" href="#animationtimeline">AnimationTimeline</a> {
    readonly attribute double? <a class="idl-code" data-global-name="AnimationTimeline<interface>/currentTime<attribute>" data-link-type="attribute" data-readonly="" data-type="double? " href="#dom-animationtimeline-currenttime">currentTime</a>;
    <a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>           <a class="idl-code" data-global-name="AnimationTimeline<interface>/play(source)<method>/play()<method>" data-link-type="method" href="#dom-animationtimeline-play">play</a> (optional <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>? <a data-global-name="AnimationTimeline/play/source<argument>" href="#dom-animationtimeline-play-source">source</a> = null);
    sequence&lt;<a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>> <a class="idl-code" data-global-name="AnimationTimeline<interface>/getAnimationPlayers()<method>" data-link-type="method" href="#dom-animationtimeline-getanimationplayers">getAnimationPlayers</a> ();
};

[<a class="idl-code" data-global-name="AnimationPlayer<interface>/AnimationPlayer(source, timeline)<constructor>" data-link-type="constructor" href="#dom-animationplayer-animationplayersource-timeline">Constructor</a> (optional <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>? <a data-global-name="AnimationPlayer<interface>/AnimationPlayer(source, timeline)<method>/source<argument>" href="#dom-animationplayer-animationplayersource-timeline-source">source</a> = null,
              optional <a data-link-type="idl-name" href="#animationtimeline">AnimationTimeline</a>? <a data-global-name="AnimationPlayer<interface>/AnimationPlayer(source, timeline)<method>/timeline<argument>" href="#dom-animationplayer-animationplayersource-timeline-timeline">timeline</a> = null)]
interface <a data-global-name="" href="#animationplayer">AnimationPlayer</a> {
             attribute <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>?   <a class="idl-code" data-global-name="AnimationPlayer<interface>/source<attribute>" data-link-type="attribute" data-type="AnimationNodeReadonly?   " href="#dom-animationplayer-source">source</a>;
             attribute <a data-link-type="idl-name" href="#animationtimeline">AnimationTimeline</a>?       <a class="idl-code" data-global-name="AnimationPlayer<interface>/timeline<attribute>" data-link-type="attribute" data-type="AnimationTimeline?       " href="#dom-animationplayer-timeline">timeline</a>;
             attribute double?                  <a class="idl-code" data-global-name="AnimationPlayer<interface>/startTime<attribute>" data-link-type="attribute" data-type="double?                  " href="#dom-animationplayer-starttime">startTime</a>;
             attribute double?                  <a class="idl-code" data-global-name="AnimationPlayer<interface>/currentTime<attribute>" data-link-type="attribute" data-type="double?                  " href="#dom-animationplayer-currenttime">currentTime</a>;
             attribute double                   <a class="idl-code" data-global-name="AnimationPlayer<interface>/playbackRate<attribute>" data-link-type="attribute" data-type="double                   " href="#dom-animationplayer-playbackrate">playbackRate</a>;
    readonly attribute <a data-link-type="idl-name" href="#enumdef-animationplaystate">AnimationPlayState</a>       <a class="idl-code" data-global-name="AnimationPlayer<interface>/playState<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationPlayState       " href="#dom-animationplayer-playstate">playState</a>;
    readonly attribute Promise&lt;<a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>> <a class="idl-code" data-global-name="AnimationPlayer<interface>/ready<attribute>" data-link-type="attribute" data-readonly="" data-type="Promise<AnimationPlayer> " href="#dom-animationplayer-ready">ready</a>;
    readonly attribute Promise&lt;<a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>> <a class="idl-code" data-global-name="AnimationPlayer<interface>/finished<attribute>" data-link-type="attribute" data-readonly="" data-type="Promise<AnimationPlayer> " href="#dom-animationplayer-finished">finished</a>;
    void <a class="idl-code" data-global-name="AnimationPlayer<interface>/cancel()<method>" data-link-type="method" href="#dom-animationplayer-cancel">cancel</a> ();
    void <a class="idl-code" data-global-name="AnimationPlayer<interface>/finish()<method>" data-link-type="method" href="#dom-animationplayer-finish">finish</a> ();
    void <a class="idl-code" data-global-name="AnimationPlayer<interface>/play()<method>" data-link-type="method" href="#dom-animationplayer-play">play</a> ();
    void <a class="idl-code" data-global-name="AnimationPlayer<interface>/pause()<method>" data-link-type="method" href="#dom-animationplayer-pause">pause</a> ();
    void <a class="idl-code" data-global-name="AnimationPlayer<interface>/reverse()<method>" data-link-type="method" href="#dom-animationplayer-reverse">reverse</a> ();
};

enum <a data-global-name="" href="#enumdef-animationplaystate">AnimationPlayState</a> { "idle", "pending", "running", "paused", "finished" };

interface <a data-global-name="" href="#animationnodereadonly">AnimationNodeReadonly</a> {
    // Timing
    readonly attribute <a data-link-type="idl-name" href="#animationtimingreadonly">AnimationTimingReadonly</a>  <a class="idl-code" data-global-name="AnimationNodeReadonly<interface>/timing<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationTimingReadonly  " href="#dom-animationnodereadonly-timing">timing</a>;
    readonly attribute <a data-link-type="idl-name" href="#dictdef-computedtimingproperties">ComputedTimingProperties</a> <a class="idl-code" data-global-name="AnimationNodeReadonly<interface>/computedTiming<attribute>" data-link-type="attribute" data-readonly="" data-type="ComputedTimingProperties " href="#dom-animationnodereadonly-computedtiming">computedTiming</a>;
    // Timing hierarchy
    readonly attribute <a data-link-type="idl-name" href="#animationgroupreadonly">AnimationGroupReadonly</a>?  <a class="idl-code" data-global-name="AnimationNodeReadonly<interface>/parent<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationGroupReadonly?  " href="#dom-animationnodereadonly-parent">parent</a>;
    readonly attribute <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>?   <a class="idl-code" data-global-name="AnimationNodeReadonly<interface>/previousSibling<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationNodeReadonly?   " href="#dom-animationnodereadonly-previoussibling">previousSibling</a>;
    readonly attribute <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>?   <a class="idl-code" data-global-name="AnimationNodeReadonly<interface>/nextSibling<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationNodeReadonly?   " href="#dom-animationnodereadonly-nextsibling">nextSibling</a>;
};

[NoInterfaceObject]
interface <a data-global-name="" href="#animationnodemutable">AnimationNodeMutable</a> {
    void <a class="idl-code" data-global-name="AnimationNodeMutable<interface>/before(nodes...)<method>/before()<method>" data-link-type="method" href="#dom-animationnodemutable-before">before</a> (<a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>... <a data-global-name="AnimationNodeMutable/before/nodes<argument>" href="#dom-animationnodemutable-before-nodes">nodes</a>);
    void <a class="idl-code" data-global-name="AnimationNodeMutable<interface>/after(nodes...)<method>/after()<method>" data-link-type="method" href="#dom-animationnodemutable-after">after</a> (<a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>... <a data-global-name="AnimationNodeMutable/after/nodes<argument>" href="#dom-animationnodemutable-after-nodes">nodes</a>);
    void <a class="idl-code" data-global-name="AnimationNodeMutable<interface>/replace(nodes...)<method>/replace()<method>" data-link-type="method" href="#dom-animationnodemutable-replace">replace</a> (<a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>... <a data-global-name="AnimationNodeMutable/replace/nodes<argument>" href="#dom-animationnodemutable-replace-nodes">nodes</a>);
    void <a class="idl-code" data-global-name="AnimationNodeMutable<interface>/remove()<method>" data-link-type="method" href="#dom-animationnodemutable-remove">remove</a> ();
};

interface <a data-global-name="" href="#animationtimingreadonly">AnimationTimingReadonly</a> {
    readonly attribute double                             <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/delay<attribute>" data-link-type="attribute" data-readonly="" data-type="double                             " href="#dom-animationtimingreadonly-delay">delay</a>;
    readonly attribute double                             <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/endDelay<attribute>" data-link-type="attribute" data-readonly="" data-type="double                             " href="#dom-animationtimingreadonly-enddelay">endDelay</a>;
    readonly attribute <a data-link-type="idl-name" href="#enumdef-fillmode">FillMode</a>                           <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/fill<attribute>" data-link-type="attribute" data-readonly="" data-type="FillMode                           " href="#dom-animationtimingreadonly-fill">fill</a>;
    readonly attribute double                             <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/iterationStart<attribute>" data-link-type="attribute" data-readonly="" data-type="double                             " href="#dom-animationtimingreadonly-iterationstart">iterationStart</a>;
    readonly attribute unrestricted double                <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/iterations<attribute>" data-link-type="attribute" data-readonly="" data-type="unrestricted double                " href="#dom-animationtimingreadonly-iterations">iterations</a>;
    readonly attribute (unrestricted double or DOMString) <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/duration<attribute>" data-link-type="attribute" data-readonly="" data-type="(unrestricted double or DOMString) " href="#dom-animationtimingreadonly-duration">duration</a>;
    readonly attribute double                             <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/playbackRate<attribute>" data-link-type="attribute" data-readonly="" data-type="double                             " href="#dom-animationtimingreadonly-playbackrate">playbackRate</a>;
    readonly attribute <a data-link-type="idl-name" href="#enumdef-playbackdirection">PlaybackDirection</a>                  <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/direction<attribute>" data-link-type="attribute" data-readonly="" data-type="PlaybackDirection                  " href="#dom-animationtimingreadonly-direction">direction</a>;
    readonly attribute DOMString                          <a class="idl-code" data-global-name="AnimationTimingReadonly<interface>/easing<attribute>" data-link-type="attribute" data-readonly="" data-type="DOMString                          " href="#dom-animationtimingreadonly-easing">easing</a>;
};

interface <a data-global-name="" href="#animationtiming">AnimationTiming</a> : <a data-link-type="idl-name" href="#animationtimingreadonly">AnimationTimingReadonly</a> {
    inherit attribute double                             <a class="idl-code" data-global-name="AnimationTiming<interface>/delay<attribute>" data-link-type="attribute" data-type="double                             " href="#dom-animationtiming-delay">delay</a>;
    inherit attribute double                             <a class="idl-code" data-global-name="AnimationTiming<interface>/endDelay<attribute>" data-link-type="attribute" data-type="double                             " href="#dom-animationtiming-enddelay">endDelay</a>;
    inherit attribute <a data-link-type="idl-name" href="#enumdef-fillmode">FillMode</a>                           <a class="idl-code" data-global-name="AnimationTiming<interface>/fill<attribute>" data-link-type="attribute" data-type="FillMode                           " href="#dom-animationtiming-fill">fill</a>;
    inherit attribute double                             <a class="idl-code" data-global-name="AnimationTiming<interface>/iterationStart<attribute>" data-link-type="attribute" data-type="double                             " href="#dom-animationtiming-iterationstart">iterationStart</a>;
    inherit attribute unrestricted double                <a class="idl-code" data-global-name="AnimationTiming<interface>/iterations<attribute>" data-link-type="attribute" data-type="unrestricted double                " href="#dom-animationtiming-iterations">iterations</a>;
    inherit attribute (unrestricted double or DOMString) <a class="idl-code" data-global-name="AnimationTiming<interface>/duration<attribute>" data-link-type="attribute" data-type="(unrestricted double or DOMString) " href="#dom-animationtiming-duration">duration</a>;
    inherit attribute double                             <a class="idl-code" data-global-name="AnimationTiming<interface>/playbackRate<attribute>" data-link-type="attribute" data-type="double                             " href="#dom-animationtiming-playbackrate">playbackRate</a>;
    inherit attribute <a data-link-type="idl-name" href="#enumdef-playbackdirection">PlaybackDirection</a>                  <a class="idl-code" data-global-name="AnimationTiming<interface>/direction<attribute>" data-link-type="attribute" data-type="PlaybackDirection                  " href="#dom-animationtiming-direction">direction</a>;
    inherit attribute DOMString                          <a class="idl-code" data-global-name="AnimationTiming<interface>/easing<attribute>" data-link-type="attribute" data-type="DOMString                          " href="#dom-animationtiming-easing">easing</a>;
};

dictionary <a data-global-name="" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a> {
    double                             <a class="idl-code" data-default="0" data-global-name="AnimationTimingProperties<dictionary>/delay<dict-member>" data-link-type="dict-member" data-type="double                             " href="#dom-animationtimingproperties-delay">delay</a> = 0;
    double                             <a class="idl-code" data-default="0" data-global-name="AnimationTimingProperties<dictionary>/endDelay<dict-member>" data-link-type="dict-member" data-type="double                             " href="#dom-animationtimingproperties-enddelay">endDelay</a> = 0;
    <a data-link-type="idl-name" href="#enumdef-fillmode">FillMode</a>                           <a class="idl-code" data-default="&quot;auto&quot;" data-global-name="AnimationTimingProperties<dictionary>/fill<dict-member>" data-link-type="dict-member" data-type="FillMode                           " href="#dom-animationtimingproperties-fill">fill</a> = "auto";
    double                             <a class="idl-code" data-default="0.0" data-global-name="AnimationTimingProperties<dictionary>/iterationStart<dict-member>" data-link-type="dict-member" data-type="double                             " href="#dom-animationtimingproperties-iterationstart">iterationStart</a> = 0.0;
    unrestricted double                <a class="idl-code" data-default="1.0" data-global-name="AnimationTimingProperties<dictionary>/iterations<dict-member>" data-link-type="dict-member" data-type="unrestricted double                " href="#dom-animationtimingproperties-iterations">iterations</a> = 1.0;
    (unrestricted double or DOMString) <a class="idl-code" data-default="&quot;auto&quot;" data-global-name="AnimationTimingProperties<dictionary>/duration<dict-member>" data-link-type="dict-member" data-type="(unrestricted double or DOMString) " href="#dom-animationtimingproperties-duration">duration</a> = "auto";
    double                             <a class="idl-code" data-default="1.0" data-global-name="AnimationTimingProperties<dictionary>/playbackRate<dict-member>" data-link-type="dict-member" data-type="double                             " href="#dom-animationtimingproperties-playbackrate">playbackRate</a> = 1.0;
    <a data-link-type="idl-name" href="#enumdef-playbackdirection">PlaybackDirection</a>                  <a class="idl-code" data-default="&quot;normal&quot;" data-global-name="AnimationTimingProperties<dictionary>/direction<dict-member>" data-link-type="dict-member" data-type="PlaybackDirection                  " href="#dom-animationtimingproperties-direction">direction</a> = "normal";
    DOMString                          <a class="idl-code" data-default="&quot;linear&quot;" data-global-name="AnimationTimingProperties<dictionary>/easing<dict-member>" data-link-type="dict-member" data-type="DOMString                          " href="#dom-animationtimingproperties-easing">easing</a> = "linear";
};

dictionary <a data-global-name="" href="#dictdef-computedtimingproperties">ComputedTimingProperties</a> : <a data-link-type="idl-name" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a> {
    double              <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/startTime<dict-member>" data-link-type="dict-member" data-type="double              " href="#dom-computedtimingproperties-starttime">startTime</a>;
    unrestricted double <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/endTime<dict-member>" data-link-type="dict-member" data-type="unrestricted double " href="#dom-computedtimingproperties-endtime">endTime</a>;
    unrestricted double <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/activeDuration<dict-member>" data-link-type="dict-member" data-type="unrestricted double " href="#dom-computedtimingproperties-activeduration">activeDuration</a>;
    double?             <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/localTime<dict-member>" data-link-type="dict-member" data-type="double?             " href="#dom-computedtimingproperties-localtime">localTime</a>;
    unrestricted double <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/timeFraction<dict-member>" data-link-type="dict-member" data-type="unrestricted double " href="#dom-computedtimingproperties-timefraction">timeFraction</a>;
    unsigned long?      <a class="idl-code" data-global-name="ComputedTimingProperties<dictionary>/currentIteration<dict-member>" data-link-type="dict-member" data-type="unsigned long?      " href="#dom-computedtimingproperties-currentiteration">currentIteration</a>;
};

enum <a data-global-name="" href="#enumdef-fillmode">FillMode</a> { "none", "forwards", "backwards", "both", "auto" };

enum <a data-global-name="" href="#enumdef-playbackdirection">PlaybackDirection</a> { "normal", "reverse", "alternate", "alternate-reverse" };

[Constructor (sequence? children,
              optional (unrestricted double or AnimationTimingProperties) timing)]
interface <a data-global-name="" href="#animationgroupreadonly">AnimationGroupReadonly</a> : <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a> {
    readonly attribute <a data-link-type="idl-name" href="#animationnodelist">AnimationNodeList</a>      <a class="idl-code" data-global-name="AnimationGroupReadonly<interface>/children<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationNodeList      " href="#dom-animationgroupreadonly-children">children</a>;
    readonly attribute <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>? <a class="idl-code" data-global-name="AnimationGroupReadonly<interface>/firstChild<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationNodeReadonly? " href="#dom-animationgroupreadonly-firstchild">firstChild</a>;
    readonly attribute <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>? <a class="idl-code" data-global-name="AnimationGroupReadonly<interface>/lastChild<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationNodeReadonly? " href="#dom-animationgroupreadonly-lastchild">lastChild</a>;
    <a data-link-type="idl-name" href="#animationgroup">AnimationGroup</a> <a class="idl-code" data-global-name="AnimationGroupReadonly<interface>/clone()<method>" data-link-type="method" href="#dom-animationgroupreadonly-clone">clone</a> ();
};

[NoInterfaceObject]
interface <a data-global-name="" href="#animationgroupmutable">AnimationGroupMutable</a> {
  void <a class="idl-code" data-global-name="AnimationGroupMutable<interface>/prepend(nodes...)<method>/prepend()<method>" data-link-type="method" href="#dom-animationgroupmutable-prepend">prepend</a> (<a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>... <a data-global-name="AnimationGroupMutable/prepend/nodes<argument>" href="#dom-animationgroupmutable-prepend-nodes">nodes</a>);
  void <a class="idl-code" data-global-name="AnimationGroupMutable<interface>/append(nodes...)<method>/append()<method>" data-link-type="method" href="#dom-animationgroupmutable-append">append</a> (<a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>... <a data-global-name="AnimationGroupMutable/append/nodes<argument>" href="#dom-animationgroupmutable-append-nodes">nodes</a>);
};

[Constructor (sequence? children,
              optional (unrestricted double or AnimationTimingProperties) timing)]
interface <a data-global-name="" href="#animationgroup">AnimationGroup</a> : <a data-link-type="idl-name" href="#animationgroupreadonly">AnimationGroupReadonly</a> {
};
<a data-link-type="idl-name" href="#animationgroup">AnimationGroup</a> implements <a data-link-type="idl-name" href="#animationnodemutable">AnimationNodeMutable</a>;
<a data-link-type="idl-name" href="#animationgroup">AnimationGroup</a> implements <a data-link-type="idl-name" href="#animationgroupmutable">AnimationGroupMutable</a>;

interface <a data-global-name="" href="#animationnodelist">AnimationNodeList</a> {
    readonly attribute unsigned long <a class="idl-code" data-global-name="AnimationNodeList<interface>/length<attribute>" data-link-type="attribute" data-readonly="" data-type="unsigned long " href="#dom-animationnodelist-length">length</a>;
    getter <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a>? <a data-global-name="AnimationNodeList<interface>/item(index)<method>" href="#dom-animationnodelist-itemindex">item</a> (unsigned long <a data-global-name="AnimationNodeList/item/index<argument>" href="#dom-animationnodelist-item-index">index</a>);
};

[Constructor (sequence? children,
              optional (unrestricted double or AnimationTimingProperties) timing)]
interface <a data-global-name="" href="#animationsequencereadonly">AnimationSequenceReadonly</a> : <a data-link-type="idl-name" href="#animationgroupreadonly">AnimationGroupReadonly</a> {
    <a data-link-type="idl-name" href="#animationsequence">AnimationSequence</a> <a class="idl-code" data-global-name="AnimationSequenceReadonly<interface>/clone()<method>" data-link-type="method" href="#dom-animationsequencereadonly-clone">clone</a> ();
};

[Constructor (sequence? children,
              optional (unrestricted double or AnimationTimingProperties) timing)]
interface <a data-global-name="" href="#animationsequence">AnimationSequence</a> : <a data-link-type="idl-name" href="#animationsequencereadonly">AnimationSequenceReadonly</a> {
};
<a data-link-type="idl-name" href="#animationsequence">AnimationSequence</a> implements <a data-link-type="idl-name" href="#animationnodemutable">AnimationNodeMutable</a>;
<a data-link-type="idl-name" href="#animationsequence">AnimationSequence</a> implements <a data-link-type="idl-name" href="#animationgroupmutable">AnimationGroupMutable</a>;

[<a class="idl-code" data-global-name="AnimationReadonly<interface>/AnimationReadonly(target, effect, timing)<constructor>" data-link-type="constructor" href="#dom-animationreadonly-animationreadonlytarget-effect-timing">Constructor</a> (<a data-link-type="idl-name" href="#animatable">Animatable</a>? <a data-global-name="AnimationReadonly<interface>/AnimationReadonly(target, effect, timing)<method>/target<argument>" href="#dom-animationreadonly-animationreadonlytarget-effect-timing-target">target</a>, object? <a data-global-name="AnimationReadonly<interface>/AnimationReadonly(target, effect, timing)<method>/effect<argument>" href="#dom-animationreadonly-animationreadonlytarget-effect-timing-effect">effect</a>,
              optional (unrestricted double or <a data-link-type="idl-name" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a>) <a data-global-name="AnimationReadonly<interface>/AnimationReadonly(target, effect, timing)<method>/timing<argument>" href="#dom-animationreadonly-animationreadonlytarget-effect-timing-timing">timing</a>)]
interface <a data-global-name="" href="#animationreadonly">AnimationReadonly</a> : <a data-link-type="idl-name" href="#animationnodereadonly">AnimationNodeReadonly</a> {
    readonly attribute (<a data-link-type="idl-name" href="#animationeffectreadonly">AnimationEffectReadonly</a> or <a data-link-type="idl-name" href="#callbackdef-effectcallback">EffectCallback</a>)? <a data-global-name="AnimationReadonly<interface>/effect<attribute>" data-readonly="" data-type="(AnimationEffectReadonly or EffectCallback)? " href="#dom-animationreadonly-effect">effect</a>;
    readonly attribute <a data-link-type="idl-name" href="#animatable">Animatable</a>? <a data-global-name="AnimationReadonly<interface>/target<attribute>" data-readonly="" data-type="Animatable? " href="#dom-animationreadonly-target">target</a>;
    <a data-link-type="idl-name" href="#animation">Animation</a> <a class="idl-code" data-global-name="AnimationReadonly<interface>/clone()<method>" data-link-type="method" href="#dom-animationreadonly-clone">clone</a> ();
};

[<a class="idl-code" data-global-name="Animation<interface>/Animation(target, effect, timing)<constructor>" data-link-type="constructor" href="#dom-animation-animationtarget-effect-timing">Constructor</a> (<a data-link-type="idl-name" href="#animatable">Animatable</a>? <a data-global-name="Animation<interface>/Animation(target, effect, timing)<method>/target<argument>" href="#dom-animation-animationtarget-effect-timing-target">target</a>, object? <a data-global-name="Animation<interface>/Animation(target, effect, timing)<method>/effect<argument>" href="#dom-animation-animationtarget-effect-timing-effect">effect</a>,
              optional (unrestricted double or <a data-link-type="idl-name" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a>) <a data-global-name="Animation<interface>/Animation(target, effect, timing)<method>/timing<argument>" href="#dom-animation-animationtarget-effect-timing-timing">timing</a>)]
interface <a data-global-name="" href="#animation">Animation</a> : <a data-link-type="idl-name" href="#animationreadonly">AnimationReadonly</a> {
    inherit attribute (<a data-link-type="idl-name" href="#animationeffectreadonly">AnimationEffectReadonly</a> or <a data-link-type="idl-name" href="#callbackdef-effectcallback">EffectCallback</a>)? <a class="idl-code" data-global-name="Animation<interface>/effect<attribute>" data-link-type="attribute" data-type="(AnimationEffectReadonly or EffectCallback)? " href="#dom-animation-effect">effect</a>;
    inherit attribute <a data-link-type="idl-name" href="#animatable">Animatable</a>? <a class="idl-code" data-global-name="Animation<interface>/target<attribute>" data-link-type="attribute" data-type="Animatable? " href="#dom-animation-target">target</a>;
};
<a data-link-type="idl-name" href="#animation">Animation</a> implements <a data-link-type="idl-name" href="#animationnodemutable">AnimationNodeMutable</a>;

[NoInterfaceObject]
interface <a data-global-name="" href="#animatable">Animatable</a> {
    <a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>                <a data-global-name="Animatable<interface>/animate(effect, timing)<method>/animate(effect)<method>" href="#dom-animatable-animateeffect-timing">animate</a> (object? <a data-global-name="Animatable/animate/effect<argument>" href="#dom-animatable-animate-effect">effect</a>,
                                            optional (double or <a data-link-type="idl-name" href="#dictdef-animationtimingproperties">AnimationTimingProperties</a>) <a data-global-name="Animatable/animate/timing<argument>" href="#dom-animatable-animate-timing">timing</a>);
    sequence&lt;<a data-link-type="idl-name" href="#animationplayer">AnimationPlayer</a>> <a class="idl-code" data-global-name="Animatable<interface>/getAnimationPlayers()<method>" data-link-type="method" href="#dom-animatable-getanimationplayers">getAnimationPlayers</a> ();
};

interface <a data-global-name="" href="#animationeffectreadonly">AnimationEffectReadonly</a> {
    readonly attribute DOMString                   <a class="idl-code" data-global-name="AnimationEffectReadonly<interface>/name<attribute>" data-link-type="attribute" data-readonly="" data-type="DOMString                   " href="#dom-animationeffectreadonly-name">name</a>;
    readonly attribute <a data-link-type="idl-name" href="#enumdef-iterationcompositeoperation">IterationCompositeOperation</a> <a class="idl-code" data-global-name="AnimationEffectReadonly<interface>/iterationComposite<attribute>" data-link-type="attribute" data-readonly="" data-type="IterationCompositeOperation " href="#dom-animationeffectreadonly-iterationcomposite">iterationComposite</a>;
    readonly attribute <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>          <a class="idl-code" data-global-name="AnimationEffectReadonly<interface>/composite<attribute>" data-link-type="attribute" data-readonly="" data-type="CompositeOperation          " href="#dom-animationeffectreadonly-composite">composite</a>;
};

enum <a data-global-name="" href="#enumdef-iterationcompositeoperation">IterationCompositeOperation</a> {"replace", "accumulate"};

enum <a data-global-name="" href="#enumdef-compositeoperation">CompositeOperation</a> {"replace", "add", "accumulate"};

[<a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/KeyframeEffectReadonly(frames, options)<constructor>" data-link-type="constructor" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options">Constructor</a> (object <a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/KeyframeEffectReadonly(frames, options)<method>/frames<argument>" data-link-type="argument" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options-frames">frames</a>, optional <a data-link-type="idl-name" href="#dictdef-keyframeeffectoptions">KeyframeEffectOptions</a> <a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/KeyframeEffectReadonly(frames, options)<method>/options<argument>" data-link-type="argument" href="#dom-keyframeeffectreadonly-keyframeeffectreadonlyframes-options-options">options</a>)]
interface <a data-global-name="" href="#keyframeeffectreadonly">KeyframeEffectReadonly</a> : <a data-link-type="idl-name" href="#animationeffectreadonly">AnimationEffectReadonly</a> {
    readonly attribute DOMString <a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/spacing<attribute>" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-keyframeeffectreadonly-spacing">spacing</a>;
    <a data-link-type="idl-name" href="#keyframeeffect">KeyframeEffect</a>               <a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/clone()<method>" data-link-type="method" href="#dom-keyframeeffectreadonly-clone">clone</a>();
    sequence&lt;<a data-link-type="idl-name" href="#dictdef-computedkeyframe">ComputedKeyframe</a>>   <a class="idl-code" data-global-name="KeyframeEffectReadonly<interface>/getFrames()<method>" data-link-type="method" href="#dom-keyframeeffectreadonly-getframes">getFrames</a> ();
};

[<a class="idl-code" data-global-name="KeyframeEffect<interface>/KeyframeEffect(frames, options)<constructor>" data-link-type="constructor" href="#dom-keyframeeffect-keyframeeffectframes-options">Constructor</a> (object <a class="idl-code" data-global-name="KeyframeEffect<interface>/KeyframeEffect(frames, options)<method>/frames<argument>" data-link-type="argument" href="#dom-keyframeeffect-keyframeeffectframes-options-frames">frames</a>, optional <a data-link-type="idl-name" href="#dictdef-keyframeeffectoptions">KeyframeEffectOptions</a> <a class="idl-code" data-global-name="KeyframeEffect<interface>/KeyframeEffect(frames, options)<method>/options<argument>" data-link-type="argument" href="#dom-keyframeeffect-keyframeeffectframes-options-options">options</a>)]
interface <a data-global-name="" href="#keyframeeffect">KeyframeEffect</a> : <a data-link-type="idl-name" href="#keyframeeffectreadonly">KeyframeEffectReadonly</a> {
    // Mutable overrides of AnimationEffectReadonly members
    inherit attribute DOMString                   <a class="idl-code" data-global-name="KeyframeEffect<interface>/name<attribute>" data-link-type="attribute" data-type="DOMString                   " href="#dom-keyframeeffect-name">name</a>;
    inherit attribute <a data-link-type="idl-name" href="#enumdef-iterationcompositeoperation">IterationCompositeOperation</a> <a class="idl-code" data-global-name="KeyframeEffect<interface>/iterationComposite<attribute>" data-link-type="attribute" data-type="IterationCompositeOperation " href="#dom-keyframeeffect-iterationcomposite">iterationComposite</a>;
    inherit attribute <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>          <a class="idl-code" data-global-name="KeyframeEffect<interface>/composite<attribute>" data-link-type="attribute" data-type="CompositeOperation          " href="#dom-keyframeeffect-composite">composite</a>;

    // Mutable additions to KeyframeEffectReadonly interface
    inherit attribute DOMString <a class="idl-code" data-global-name="KeyframeEffect<interface>/spacing<attribute>" data-link-type="attribute" data-type="DOMString " href="#dom-keyframeeffect-spacing">spacing</a>;
    void                        <a class="idl-code" data-global-name="KeyframeEffect<interface>/setFrames(frames)<method>" data-link-type="method" href="#dom-keyframeeffect-setframesframes">setFrames</a> (object <a class="idl-code" data-global-name="KeyframeEffect/setFrames/frames<argument>" data-link-type="argument" href="#dom-keyframeeffect-setframes-frames">frames</a>);
};

dictionary <a data-global-name="" href="#dictdef-keyframeeffectoptions">KeyframeEffectOptions</a> {
    DOMString                   <a class="idl-code" data-default="&quot;&quot;" data-global-name="KeyframeEffectOptions<dictionary>/name<dict-member>" data-link-type="dict-member" data-type="DOMString                   " href="#dom-keyframeeffectoptions-name">name</a> = "";
    <a data-link-type="idl-name" href="#enumdef-iterationcompositeoperation">IterationCompositeOperation</a> <a class="idl-code" data-default="&quot;replace&quot;" data-global-name="KeyframeEffectOptions<dictionary>/iterationComposite<dict-member>" data-link-type="dict-member" data-type="IterationCompositeOperation " href="#dom-keyframeeffectoptions-iterationcomposite">iterationComposite</a> = "replace";
    <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>          <a class="idl-code" data-default="&quot;replace&quot;" data-global-name="KeyframeEffectOptions<dictionary>/composite<dict-member>" data-link-type="dict-member" data-type="CompositeOperation          " href="#dom-keyframeeffectoptions-composite">composite</a> = "replace";
    DOMString                   <a class="idl-code" data-default="&quot;distribute&quot;" data-global-name="KeyframeEffectOptions<dictionary>/spacing<dict-member>" data-link-type="dict-member" data-type="DOMString                   " href="#dom-keyframeeffectoptions-spacing">spacing</a> = "distribute";
};

dictionary <a data-global-name="" href="#dictdef-keyframe">Keyframe</a> {
    // ... property-value pairs ...
    double?             <a class="idl-code" data-default="null" data-global-name="Keyframe<dictionary>/offset<dict-member>" data-link-type="dict-member" data-type="double?             " href="#dom-keyframe-offset">offset</a> = null;
    DOMString           <a class="idl-code" data-default="&quot;linear&quot;" data-global-name="Keyframe<dictionary>/easing<dict-member>" data-link-type="dict-member" data-type="DOMString           " href="#dom-keyframe-easing">easing</a> = "linear";
    <a data-link-type="idl-name" href="#enumdef-compositeoperation">CompositeOperation</a>? <a class="idl-code" data-default="null" data-global-name="Keyframe<dictionary>/composite<dict-member>" data-link-type="dict-member" data-type="CompositeOperation? " href="#dom-keyframe-composite">composite</a> = null;
};

dictionary <a data-global-name="" href="#dictdef-computedkeyframe">ComputedKeyframe</a> : <a data-link-type="idl-name" href="#dictdef-keyframe">Keyframe</a> {
    double <a class="idl-code" data-global-name="ComputedKeyframe<dictionary>/computedOffset<dict-member>" data-link-type="dict-member" data-type="double " href="#dom-computedkeyframe-computedoffset">computedOffset</a>;
};

callback <a data-global-name="" href="#callbackdef-effectcallback">EffectCallback</a> = void (double? <a data-global-name="EffectCallback/timeFraction<argument>" href="#dom-effectcallback-timefraction">timeFraction</a>, <a data-link-type="idl-name" href="#animatable">Animatable</a> <a data-global-name="EffectCallback/currentTarget<argument>" href="#dom-effectcallback-currenttarget">currentTarget</a>,
                                <a data-link-type="idl-name" href="#animation">Animation</a> <a data-global-name="EffectCallback/animationObject<argument>" href="#dom-effectcallback-animationobject">animationObject</a>);

partial interface <a class="idl-code" data-global-name="" data-link-type="interface" href="http://dom.spec.whatwg.org/#document">Document</a> {
    readonly attribute <a data-link-type="idl-name" href="#animationtimeline">AnimationTimeline</a> <a class="idl-code" data-global-name="Document<interface>/timeline<attribute>" data-link-type="attribute" data-readonly="" data-type="AnimationTimeline " href="#dom-document-timeline">timeline</a>;
};

<a data-link-type="idl-name" href="http://dom.spec.whatwg.org/#element">Element</a> implements <a data-link-type="idl-name" href="#animatable">Animatable</a>;

<a data-link-type="idl-name" href="http://dev.w3.org/csswg/cssom-1/#pseudoelement">PseudoElement</a> implements <a data-link-type="idl-name" href="#animatable">Animatable</a>;

</pre>
  <h2 class="no-num heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue">Should this actually be based on when the player is attached to
    a timeline? Or when it leaves the idle state?<a href="#issue-f3507204"> ↵ </a></div>
   <div class="issue">
  This is not quite right. If <var>old content</var> is attached to another
  player in the same task then we should probably not do an extra
  callback with <a data-link-type="dfn" href="#unresolved">unresolved</a>.


    <p>The definition of when <a data-link-type="dfn" href="#custom-effect">custom effects</a> gets called needs to be
  audited and probably rewritten.</p>
    
<a href="#issue-0bdffc92"> ↵ </a>
   </div>
   <div class="issue">
  The procedures for calling custom effects needs to be reworked.
  Currently they probably involve calling too often for changes that could
  be coalesced.
<a href="#issue-8b479841"> ↵ </a></div>
   <div class="issue">
Currently <a data-link-type="dfn" href="#timing-function">timing functions</a> that generate results outside the
range [0, 1] will behave unexpectedly when applied to animation
groups, as children will increase iterations or enter into fill mode
rather than continuing to extrapolate along their defined behavior
(which is what they would do if the timing function applied to them
directly).


    <p>To fix this it is possible we will wish to introduce <a class="property" data-link-type="propdesc" href="http://dev.w3.org/csswg/css-overflow-3/#propdef-overflow">overflow</a> fill
modes that respond to time values larger than or smaller than the
active time range by extrapolating rather than filling.</p>
    


    <p>See <a href="http://lists.w3.org/Archives/Public/public-fx/2013AprJun/0184.html">section
15 (Overflowing fill) of minuted discussion from Tokyo 2013 F2F</a>.</p>
    
<a href="#issue-8c26106d"> ↵ </a>
   </div>
   <div class="issue">There used to be a step here which seemed to be adding
  special handling for filling when the node ends on
  a repeat boundary but it seems like that is taken care
  of by the calcuation of <a data-link-type="dfn" href="#iteration-time">iteration time</a> and
  <a data-link-type="dfn" href="#current-iteration">current iteration</a>.
  Is anything actually needed here?<a href="#issue-eb1151df"> ↵ </a></div>
   <div class="issue">
Currently, the set of <a data-link-type="dfn" href="#timing-function">timing functions</a> allowed on
an <a data-link-type="dfn" href="#animation-group">animation group</a> is not restricted.
This has raised concern about complexity of implementation and also
complexity of behavior with regards to fill modes.
As a result, allowing the full set of timing functions on animation
groups is considered <strong>at risk</strong>.
Alternatives are to either restrict timing functions on animation
groups to the <a data-link-type="dfn" href="#linear-timing-function">linear timing function</a> or to a set of
“simple” timing functions that have properties that
alleviate some of the concerns with the more complex timing
functions.


    <p>See <a href="http://lists.w3.org/Archives/Public/public-fx/2013JulSep/0076.html">section
2 of the discussion from August 2013</a>.</p>
    
<a href="#issue-a889e2ba"> ↵ </a>
   </div>
   <div class="issue">
It has been proposed to extend <code>cubic-bezier</code> to allow
multiple segments, using syntax such as the following:


    <pre><code>cubic-bezier( [ &lt;number>{6} ; ]* &lt;number>{4} )</code>
</pre>
    


    <p>(i.e. the curve starts at (0, 0); each segment is defined by six
numbers where the start point is the end of the previous segment and
the numbers define the two control points and the end point. The
last segment is defined by four numbers since the end point is fixed
at (1, 1).)</p>
    


    <p>This would provide a simple and compact syntax for tools trying to
map arbitrary curves (e.g. bounce functions) to timing functions.</p>
    
<a href="#issue-9e5dcac9"> ↵ </a>
   </div>
   <div class="issue">The default <a data-link-type="dfn" href="#animation-behavior">animation behavior</a> for CSS properties is "as
       string".  Should this be defined here or in CSS Animations Level 4?<a href="#issue-48287af4"> ↵ </a></div>
   <div class="issue">
  We should probably expand 2d functions to their 3d
  equivalents before matching?
<a href="#issue-3540bd4c"> ↵ </a></div>
   <div class="issue">
  This needs to be more specific, e.g. when combining
  <code>translate(20px)</code> and <code>translate(30px
  10px)</code> we have to expand the first function to
  <code>translate(20px 0px)</code> first.
  Probably need to define unit conversion too.
<a href="#issue-7c98bbea"> ↵ </a></div>
   <div class="issue">


    <p>For <a data-link-type="dfn" href="#distance-computation">distance computation</a> we previously defined it as follows:</p>
    


    <ol>
     <li data-md="">
      <p>Look only at the first component of the two lists</p>
      

     <li data-md="">
      <p>If both are translate → euclidean distance</p>
      

     <li data-md="">
      <p>If both are scale → absolute difference</p>
      

     <li data-md="">
      <p>If both are rotate → absolute difference</p>
      

     <li data-md="">
      <p>If both match but are something else → use linear</p>
      

     <li data-md="">
      <p>If they don’t match → use matrix decomposition and
euclidean distance between translate components</p>
      
</ol>
    

    <p>This seems really arbitrary, especially part 5.</p>
    


    <p>Also, looking at only the first component seems odd.
    Going through each component, working out the distance and then
    getting the square of the distance also seems much more consistent
    with what we do elsewhere.</p>
    

<a href="#issue-b82dbcbe"> ↵ </a>
   </div>
   <div class="issue">


    <p>There are a bunch of CSS properties for which distance (and in
    some cases addition) is not defined or which need special
    handling.</p>
    


    <p>For example,</p>
    


    <ul>
     <li data-md="">
      <p>font-stretch (an enum but handled like an integer)</p>
      

     <li data-md="">
      <p>visibility (0 or 1 depending on if endpoints match or not)</p>
      

     <li data-md="">
      <p>flex-grow and flex-shrink which allow animation only if one of
the endpoints is 0)</p>
      

     <li data-md="">
      <p>value pairs, triples (use square distance)</p>
      

     <li data-md="">
      <p>rects (use square distance)</p>
      

     <li data-md="">
      <p>dash arrays (square distance but a bit weird due to
percentages)</p>
      

     <li data-md="">
      <p>shadows (square distance of components)</p>
      

     <li data-md="">
      <p>filters (undefined)</p>
      

     <li data-md="">
      <p>background-position (special list handling needed)</p>
      

     <li data-md="">
      <p>pair lists</p>
      
</ul>
    

    <p>Should we define these here or in the CSS Animation 4 spec?</p>
    

<a href="#issue-2b25d150"> ↵ </a>
   </div>
   <div class="issue">The above algorithm is quite complex.
    It attempts to cover all possible combinations of input where
    keyframe offsets and or paced property values may be missing.
    Furthermore, it attempts to do this in a way that degenerates
    consistently and also allows the author to combine fixed offsets
    with either pacing or distribute spacing.
    We await implementation experience to determine if the complexity
    is justified.<a href="#issue-867fbc9b"> ↵ </a></div>
   <div class="issue">It seems like this could be done as a separate step at the end
    and applied to all types of animation effects consistently.<a href="#issue-8b7cca9f"> ↵ </a></div>
   <div class="issue">
    In the presence of certain timing functions, the input time
    fraction to an animation effect is not limited to the range [0, 1].
    Currently, however, keyframe offsets <em>are</em> limited to the
    range [0, 1] and property values are simply extrapolated for input
    time fractions outside this range.


    <p>We have considered removing this restriction since some cases exist
    where it is useful to be able to specify non-linear
    changes in property values at time fractions outside the range
    [0, 1].
    One example is an animation that interpolates from green to yellow
    but has an overshoot timing function that makes it temporarily
    interpolate ‘beyond’ yellow to red before settling back
    to yellow.</p>
    


    <p>While this effect could be achieved by modification of the keyframes
    and timing function, this approach seems to break the model’s
    separation of timing concerns from animation effects.</p>
    


    <p>It is not clear how this effect should be achieved but we note that
    allowing keyframe offsets outside [0, 1] may make the currently
    specified behavior where keyframes at offset 0 and 1 are synthesized
    as necessary, inconsistent.</p>
    


    <p>See <a href="http://lists.w3.org/Archives/Public/public-fx/2013AprJun/0184.html">section
    4 (Keyframe offsets outside [0, 1]) of minuted discussion from Tokyo
      2013 F2F</a>.</p>
    
<a href="#issue-73bc0c24"> ↵ </a>
   </div>
   <div class="issue">
There may be use cases where an action needs to be triggered at
a specific point in an animation tree.
In many cases this can be achieved by inserting a custom effect with
a step-start easing that spans the period during which the action
should be triggered.
However, this can impose additional layout requirements on the
content which might be cumbersome to accomodate.


    <p>Some alternatives under consideration:</p>
    


    <ul>
     <li data-md="">
      <p>Additional calling conditions could be defined to accommodate
zero-width custom effects. For example, it could be required
that the callback be called if (given infinite precision) there
was a time between the previous and current sample times that
aligned with the custom effect.</p>
      

     <li data-md="">
      <p>Instead of adding special calling conditions to custom effects,
a new type of animation node, Trigger, could be introduced. The
trigger would only ever act as a zero-width custom effect as
described above, its constructor would take a callback function,
but not require a target or timing. It could also specify other
calling conventions, for example whether it should only trigger
in a specific playback direction.</p>
      
</ul>
    
<a href="#issue-466de4cb"> ↵ </a>
   </div>
   <div class="issue">Need to define this more precisely.
    Are styles flushed?
    Presumably they are.
    Can we suspend reflow for the duration of executing the script-based
    animation effects and just do it once afterwards?<a href="#issue-8b46f38c"> ↵ </a></div>
   <div class="issue">Need to define the start behavior when <var>source</var> is null.<a href="#issue-c794ed35"> ↵ </a></div>
   <div class="issue">Both this method and <code class="idl"><a data-link-type="idl" href="#dom-animatable-getanimationplayers">getAnimationPlayers()</a></code> on the
       <code class="idl"><a data-link-type="idl" href="#animatable">Animatable</a></code> interface require retaining forwards-filling
       <a data-link-type="dfn" href="#concept-animation">animations</a> and their <a data-link-type="dfn" href="#player">players</a>
       such that a document that
       repeatedly produces forwards-filling animations will consume memory
       in an unbounded fashion.
       We may need to revise this definition (previously these methods
       only returned players whose <a data-link-type="dfn" href="#source-content">source content</a> was <a data-link-type="dfn" href="#current">current</a>)
       or provide a loophole for implementations to discard old players in
       such conditions.<a href="#issue-fb580d44"> ↵ </a></div>
   <div class="issue">This behavior is intended to prevent authors for relying
on the <code>currentTime</code> while a player is waiting to pause
but is also somewhat confusing.<a href="#issue-df52ec70"> ↵ </a></div>
   <div class="issue">Should this be <code>parentGroup</code>?<a href="#issue-894adfa6"> ↵ </a></div>
   <div class="issue">On setting, if the previous value was an <code class="idl"><a data-link-type="idl" href="#callbackdef-effectcallback">EffectCallback</a></code>, we
    should call the old callback with a null time fraction so it can
    clear its result.<a href="#issue-67055717"> ↵ </a></div>
   <div class="issue">We should define the name as an internal member in the model and
reference that here.<a href="#issue-d42a6a0c"> ↵ </a></div>
   <div class="issue">Should this be defined in terms of <code>IsIterable</code> instead?<a href="#issue-0a95c3b0"> ↵ </a></div>
   <div class="issue">Need to define what invalid means here.<a href="#issue-53ccb020"> ↵ </a></div>
   <div class="issue">


    <p>The above algorithm gives special meaning to the property names
"offset", "computedOffset", "easing", and "composite".
If a CSS property called "offset" or "composite" is ever
introduced it will clash with the meaning here.</p>
    


    <p>We have a few options:</p>
    


    <ul>
     <li data-md="">
      <p>Add special handling at that time to allow addressing the
property of the same name, e.g. <code>cssOffset</code>.</p>
      

     <li data-md="">
      <p>Rename these keywords now to reduce risk of a later clash,
e.g. "keyframeOffset".</p>
      
</ul>
    
<a href="#issue-7e1dd385"> ↵ </a>
   </div>
   <div class="issue">
  This is only named <code class="idl"><a data-link-type="idl" href="#dom-effectcallback-animationobject">animationObject</a></code> because otherwise we end
  up getting a bikeshed error:
  <code>"Multiple possible 'idl' local refs for 'animation'.
    Arbitrarily chose the one with type 'interface' and for ''."</code>
<a href="#issue-6dab2e19"> ↵ </a></div>
   <div class="issue">This interface is marked at-risk in the <a class="externalDFN" href="http://www.w3.org/TR/2013/WD-cssom-20131205/">5 December 2013 WD
    of CSSOM</a>.
    If it is removed, we will need to provide an equivalent definition
    here.<a href="#issue-05667543"> ↵ </a></div>
   <div class="issue">Is this at odds with those <a data-link-type="dfn" href="#time-value">time values</a> being relative to
    <code>navigationStart</code> and with <code>requestAnimationFrame</code>
    using the same time as <code>document.timeline.currentTime</code>?<a href="#issue-d06e8e73"> ↵ </a></div></div></body>
</html>